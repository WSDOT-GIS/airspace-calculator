import{e as a,y as c,a as I,t as gt,l as y,h as O,b as re,c as Ni,v as D,j as W,d as Mr,m as Ir,r as si,f as rs,s as V,g as F,L as sn,i as al,x as ll,k as cl,n as M,u as dl,o as hl,p as ul,S as pl,q as Xe,w as Lt,z as k,A as Yn,B as ml,C as xe,_ as w,D as ms,E as gl,F as Cr,G as fl,H as Rt,I as _l,J as Es,K as yl,U as vl,M as nn,N as wl,O as Tr,P as xt,Q as bl,R as Ml,T as xr,V as Il,W as Cl,X as Tl,Y as Er,Z as Ti,$ as Xn,a0 as Le,a1 as Tn,a2 as kr,a3 as xn,a4 as Qe,a5 as _i,a6 as Ri,a7 as xl,a8 as El,a9 as kl,aa as Jn,ab as Se,ac as eo,ad as $l,ae as Pl,af as Al,ag as Fl,ah as $r,ai as be,aj as to,ak as ki,al as se,am as En,an as ni,ao as Ye,ap as Rl,aq as Pr,ar as Ll,as as yt,at as Ar,au as gs,av as ks,aw as ti,ax as pe,ay as Sl,az as Dl,aA as Fr,aB as Rr,aC as kn,aD as Ol,aE as $i,aF as fs,aG as Li,aH as _s,aI as on,aJ as Lr,aK as Vl,aL as Nl,aM as Sr,aN as io,aO as ys,aP as oi,aQ as $n,aR as zl,aS as Bl,aT as ql,aU as Dr,aV as Ul,aW as Hl,aX as jl,aY as Or,aZ as Gl,a_ as Wl,a$ as Pn,b0 as Vr,b1 as Zl,b2 as Kl,b3 as Nr,b4 as Ql,b5 as vs,b6 as $s,b7 as Pi,b8 as Yl,b9 as Xl,ba as Jl,bb as ec,bc as tc,bd as so,be as no}from"./index-c754ff65.js";import{u as Oe}from"./Viewpoint-eb6ec031.js";import{l as zr}from"./CollectionFlattener-459cb615.js";import{p as ic,j as sc}from"./TileInfo-2589d4ff.js";import{i as oo,e as ae,W as le,n as m,v as as,h as ro,f as De,a as Br,t as nc,w as oc,b as qr,r as ao,c as Ur,o as lo}from"./widget-7352089c.js";import{s as co}from"./byteSizeEstimations-90c5a50d.js";import"./Cyclical-5c5da130.js";import{a as rc}from"./AttachmentInfo-2f7fbe5e.js";import{n as An}from"./Heading-adb0ad8a.js";import{b as ac,r as rn,R as lc,n as cc}from"./symbolUtils-5e5f8d3d.js";import{s as Ps}from"./executeQueryJSON-ca6c73e1.js";import"./featureConversionUtils-c00360ef.js";import"./normalizeUtils-703059af.js";import"./pbf-f46def03.js";import{t as dc,R as hc,D as uc}from"./Scheduler-68df8c73.js";import{t as ho}from"./layerViewUtils-5da1782e.js";import{t as Hr}from"./GoTo-9b5cecfc.js";import{t as Me}from"./accessibleHandler-b82b4bb4.js";import{e as pc}from"./vmEvent-d773b6c5.js";import mc from"./Map-e64f8eb2.js";import{l as gc,i as jr,a as uo}from"./GraphicsCollection-b80722b0.js";import{l as po}from"./ViewingMode-915d19cb.js";import{t as an,r as fc}from"./unitBezier-881ac1eb.js";import{h as _c,c as Gr,f as Wr,e as Fn,i as ls,M as yc,r as Zr,n as vc}from"./mat2d-e11be45e.js";import{o as ln,v as mo,y as wc,j as bc,q as go,C as Kr,l as ws,r as ne,z as We,g as Mc,a as cs,s as Ic,m as Cc}from"./vec2-bbd3449a.js";import{r as Tc,n as J}from"./vec2f64-22afc56f.js";import{s as xc,r as Ec,M as fo,h as kc,i as $c}from"./mat3-21bcfd83.js";import{t as _o}from"./TileStrategy-1967197e.js";import{d as Pc,h as Ac}from"./TileInfoView-ccee1155.js";import"./TileKey-b1f5cdb9.js";import{l as Fc,r as Rc}from"./capabilities-57d1a30a.js";const Gi={widthBreakpoint:{getValue(i){const e=i.viewSize[0],t=i.breakpoints,s=this.values;return e<=t.xsmall?s.xsmall:e<=t.small?s.small:e<=t.medium?s.medium:e<=t.large?s.large:s.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(i){const e=i.viewSize[1],t=i.breakpoints,s=this.values;return e<=t.xsmall?s.xsmall:e<=t.small?s.small:e<=t.medium?s.medium:e<=t.large?s.large:s.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(i){const e=i.viewSize,t=e[0],s=e[1],n=this.values;return s>=t?n.portrait:n.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},As={xsmall:544,small:768,medium:992,large:1200};function Lc(i){const e=i;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function Fs(i,e){return e?Gi[i].valueToClassName[e].split(" "):[]}const Sc=i=>{let e=class extends i{constructor(...t){super(...t),this._breakpointsHandles=new gt,this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=As}initialize(){this._breakpointsHandles.add(y(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),O))}destroy(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles=re(this._breakpointsHandles))}set breakpoints(t){if(t===this._get("breakpoints"))return;const s=Lc(t);if(!s){const n=JSON.stringify(As,null,2);console.warn("provided breakpoints are not valid, using defaults:"+n)}t=s?t:As,this._set("breakpoints",{...t})}_updateClassNames(){if(!this.container)return;const t=Ni.acquire(),s=Ni.acquire();let n,o=!1;for(n in Gi){const r=this[n],l=Gi[n].getValue({viewSize:this.size,breakpoints:this.breakpoints});r!==l&&(o=!0,this[n]=l,Fs(n,r).forEach(d=>s.push(d)),Fs(n,l).forEach(d=>t.push(d)))}o&&(this._applyClassNameChanges(t,s),Ni.release(t),Ni.release(s))}_applyClassNameChanges(t,s){const n=this.container;n&&(s.forEach(o=>n.classList.remove(o)),t.forEach(o=>n.classList.add(o)))}_removeActiveClassNames(){const t=this.container;if(!t)return;let s;for(s in Gi)Fs(s,this[s]).forEach(n=>t.classList.remove(n))}};return a([c()],e.prototype,"breakpoints",null),a([c()],e.prototype,"orientation",void 0),a([c()],e.prototype,"widthBreakpoint",void 0),a([c()],e.prototype,"heightBreakpoint",void 0),e=a([I("esri.views.BreakpointsOwner")],e),e};let nt=class extends D{constructor(){super(...arguments),this.items=new W,this._watchUpdatingTracking=new Mr,this._callbacks=new Map,this._projector=oo(),this._hiddenProjector=oo()}get needsRender(){return this.items.length>0}get updating(){var e;return((e=this._watchUpdatingTracking)==null?void 0:e.updating)??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,t=>{for(const s of t.added){const n=()=>s.render();this._callbacks.set(s,n),this._projector.append(this.surface,n)}for(const s of t.removed){const n=this._projector.detach(this._callbacks.get(s));this.surface.removeChild(n.domNode),this._callbacks.delete(s)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const t=this._hiddenSurface,s=this._hiddenProjector;let n;const o=()=>(n=e.render(),n);s.append(t,o),s.renderNow();const r={left:0,top:0,right:0,bottom:0};if(n&&n.domNode){const l=n.domNode.getBoundingClientRect();r.left=l.left,r.top=l.top,r.right=l.right,r.bottom=l.bottom}for(s.detach(o);t.firstChild;)t.removeChild(t.firstChild);return r}overlaps(e,t){const s=this.computeBoundingRect(e),n=this.computeBoundingRect(t);return Math.max(s.left,n.left)<=Math.min(s.right,n.right)&&Math.max(s.top,n.top)<=Math.min(s.bottom,n.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e){if(!this.items.some(s=>s.visible))return;const t=e.getContext("2d");t.save(),t.font=this._fontString(),this.items.forEach(s=>{t.save(),s.renderCanvas(t),t.restore()}),t.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};a([c({readOnly:!0})],nt.prototype,"surface",void 0),a([c({readOnly:!0})],nt.prototype,"items",void 0),a([c({readOnly:!0})],nt.prototype,"needsRender",null),a([c({readOnly:!0})],nt.prototype,"_watchUpdatingTracking",void 0),a([c({readOnly:!0})],nt.prototype,"updating",null),nt=a([I("esri.views.overlay.ViewOverlay")],nt);const yo=nt;function ii(i,e,t,s){let n=null,o=1e3;typeof e=="number"?(o=e,s=t):(n=e??null,o=t);let r,l=0;const d=()=>{l=0,i.apply(s,r)},h=(...u)=>{n&&n.apply(s,u),r=u,o?l||(l=setTimeout(d,o)):d()};return h.remove=()=>{l&&(clearTimeout(l),l=0)},h.forceUpdate=()=>{l&&(clearTimeout(l),d())},h.hasPendingUpdates=()=>!!l,h}const vo=["B","kB","MB","GB","TB"];function Dc(i,e){let t=e===0?0:Math.floor(Math.log(e)/Math.log(co.KILOBYTES));t=rs(t,0,vo.length-1);const s=Ir(e/co.KILOBYTES**t,{maximumFractionDigits:2});return si(i.units.bytes[vo[t]],{fileSize:s})}const Oc="esri.widgets.Feature.support.featureUtils",wo=V.getLogger(Oc),Vc=/href=(""|'')/gi,Nc=/(\{([^\{\r\n]+)\})/g,zc=/\'/g,Qr=/^\s*expression\//i,Bc=/(\n)/gi,qc=/[\u00A0-\u9999<>\&]/gim,Uc=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,Hc=/^(?:mailto:|tel:)/,Yr="relationships/",cn=pl("short-date-short-time");function Xr(i){if(!F(i))return i.get("sourceLayer")||i.get("layer")}async function ds(i,e){return typeof i=="function"?i.call(null,e):i}function Jr(i=""){if(i)return!Hc.test(i.trim().toLowerCase())}function Rn(i){return!!i&&Qr.test(i)}function jc(i,e){if(!Rn(e)||!i)return null;const t=e.replace(Qr,"").toLowerCase();let s=null;return i.some(n=>n.name.toLowerCase()===t&&(s=n,!0)),s}function ea(i,e){const t=jc(e,i==null?void 0:i.fieldName);return t?t.title||null:i?i.label||i.fieldName:null}function Gc(i,e){const t=e.get(i.toLowerCase());return`{${t&&t.fieldName||i}}`}function Wc(i){return i.replace(Vc,"")}function Ai(i,e){const t=Ln(e,i);return t?t.name:i}function Zc(i,e){return i&&i.map(t=>Ai(t,e))}function Ln(i,e){return i&&typeof i.getField=="function"&&e?i.getField(e)??null:null}function ta(i){return`${i}`.trim()}function $t({attributes:i,globalAttributes:e,layer:t,text:s,expressionAttributes:n,fieldInfoMap:o}){return s?dn({formattedAttributes:e,template:Xc(s,{...e,...n,...i},t),fieldInfoMap:o}):""}function dn({formattedAttributes:i,template:e,fieldInfoMap:t}){return ta(Wc(si(si(e,s=>Gc(s,t)),i)))}function Kc(i,e,t=!1){const s=e[i];if(typeof s=="string"){const n="%27",o=(t?encodeURIComponent(s):s).replace(zc,n);e[i]=o}}function Qc(i,e=!1){const t={...i};return Object.keys(t).forEach(s=>Kc(s,t,e)),t}function Yc(i,e,t){const s=(e=ta(e))&&e[0]!=="{";return si(i,Qc(t,s||!1))}function hn(i,e){return i.replace(Nc,(t,s,n)=>{const o=Ln(e,n);return o?`{${o.name}}`:s})}function Xc(i,e,t){const s=hn(i,t);return s&&s.replace(Uc,(n,o,r)=>Yc(n,o||r,e))}function Jc(i,e){if(typeof i=="string"&&e&&e.dateFormat==null&&(e.places!=null||e.digitSeparator!=null)){const t=Number(i);if(!isNaN(t))return t}return i}function ed(i){return(i==null?void 0:i.type)==="feature"}function bo(i){return!!(i!=null&&i.layer)}function td(i){return(i==null?void 0:i.type)==="map-image"}function id(i,e){var h;const t=e.fieldInfos,s=e.fieldName,n=(h=ia(t,s))==null?void 0:h.clone(),o=e.preventPlacesFormatting,r=e.layer,l=Ln(r,s);if(n&&(l==null?void 0:l.type)==="date"){const u=n.format||new dl;u.dateFormat=u.dateFormat||"short-date-short-time",u.dateTimeFormatOptions=!bo(r)&&ed(r)&&r.datesInUnknownTimezone||bo(r)&&td(r.layer)&&r.layer.datesInUnknownTimezone?{timeZone:"UTC"}:null,n.format=u}const d=n&&n.format;return typeof i=="string"&&hl(s)&&d?d.formatRasterPixelValue(i):typeof(i=Jc(i,d))=="string"||i==null||d==null?Si(i):o?Ir(i,{...ul(d),minimumFractionDigits:0,maximumFractionDigits:20}):d.format(i)}function ia(i,e){if(!i||!i.length||!e)return;const t=e.toLowerCase();let s;return i.some(n=>!(!n.fieldName||n.fieldName.toLowerCase()!==t)&&(s=n,!0)),s}function sd({fieldName:i,graphic:e,layer:t}){if(Ke(i)||!t||typeof t.getFeatureType!="function")return null;const{typeIdField:s}=t;if(!s||i!==s)return null;const n=t.getFeatureType(e);return n?n.name:null}function nd({fieldName:i,value:e,graphic:t,layer:s}){if(Ke(i)||!s||typeof s.getFieldDomain!="function")return null;const n=t&&s.getFieldDomain(i,{feature:t});return n&&n.type==="coded-value"?n.getName(e):null}function od(i,e){const{creatorField:t,creationDateField:s,editorField:n,editDateField:o}=i;if(!e)return;const r=e[o];if(typeof r=="number"){const d=e[n];return{type:"edit",date:sn(r,cn),user:d}}const l=e[s];if(typeof l=="number"){const d=e[t];return{type:"create",date:sn(l,cn),user:d}}return null}function rd(i,e){const t=new Map;return i&&i.forEach(s=>{const n=Ai(s.fieldName,e);s.fieldName=n,t.set(n.toLowerCase(),s)}),t}function Mo(i){const e=[];if(!i)return e;const{fieldInfos:t,content:s}=i;return t&&e.push(...t),s&&Array.isArray(s)&&s.forEach(n=>{if(n.type==="fields"){const o=n&&n.fieldInfos;o&&e.push(...o)}}),e}function Sn(i){return i.replace(qc,e=>`&#${e.charCodeAt(0)};`)}function Si(i){return typeof i=="string"?i.replace(Bc,'<br class="esri-text-new-line" />'):i}function sa(i){const{value:e,fieldName:t,fieldInfos:s,fieldInfoMap:n,layer:o,graphic:r}=i;if(e==null)return"";const l=nd({fieldName:t,value:e,graphic:r,layer:o});if(l)return l;const d=sd({fieldName:t,graphic:r,layer:o});if(d)return d;if(n.get(t.toLowerCase()))return id(e,{fieldInfos:s||Array.from(n.values()),fieldName:t,layer:o});const h=o&&o.fieldsIndex;return h&&h.isDateField(t)?sn(e,cn):Si(e)}function Rs({fieldInfos:i,attributes:e,layer:t,graphic:s,fieldInfoMap:n,relatedInfos:o}){const r={};return o==null||o.forEach(l=>dd({attributes:r,relatedInfo:l,fieldInfoMap:n,fieldInfos:i,layer:t})),e&&Object.keys(e).forEach(l=>{const d=e[l];r[l]=sa({fieldName:l,fieldInfos:i,fieldInfoMap:n,layer:t,value:d,graphic:s})}),r}async function na(i,e){var u,p;const{layer:t,graphic:s,outFields:n,objectIds:o,returnGeometry:r,spatialReference:l}=i,d=o[0];if(typeof d!="number"&&typeof d!="string"){const g="Could not query required fields for the specified feature. The feature's ID is invalid.",f={layer:t,graphic:s,objectId:d,requiredFields:n};return wo.warn(g,f),null}if(!((p=(u=al(t))==null?void 0:u.operations)!=null&&p.supportsQuery)){const g="The specified layer cannot be queried. The following fields will not be available.",f={layer:t,graphic:s,requiredFields:n,returnGeometry:r};return wo.warn(g,f),null}const h=t.createQuery();return h.objectIds=o,h.outFields=n!=null&&n.length?n:[t.objectIdField],h.returnGeometry=!!r,h.returnZ=!!r,h.returnM=!!r,h.outSpatialReference=l,(await t.queryFeatures(h,e)).features[0]}async function ad(i){var s;if(!((s=i.expressionInfos)!=null&&s.length))return!1;const e=await cl(),{arcadeUtils:{hasGeometryFunctions:t}}=e;return t(i)}async function ld({graphic:i,popupTemplate:e,layer:t,spatialReference:s},n){if(!t||!e||(typeof t.load=="function"&&await t.load(n),!i.attributes))return;const o=i.attributes[t.objectIdField];if(o==null)return;const r=[o],l=await e.getRequiredFields(t.fieldsIndex),d=ll(l,i),h=d?[]:l,u=e.returnGeometry||await ad(e);if(d&&!u)return;const p=await na({layer:t,graphic:i,outFields:h,objectIds:r,returnGeometry:u,spatialReference:s},n);p&&(p.geometry&&(i.geometry=p.geometry),p.attributes&&(i.attributes={...i.attributes,...p.attributes}))}function Ke(i=""){return!!i&&i.includes(Yr)}function cd(i){return i?`${Yr}${i.layerId}/${i.fieldName}`:""}function Io({attributes:i,graphic:e,relatedInfo:t,fieldInfos:s,fieldInfoMap:n,layer:o}){i&&e&&t&&Object.keys(e.attributes).forEach(r=>{const l=cd({layerId:t.relation.id.toString(),fieldName:r}),d=e.attributes[r];i[l]=sa({fieldName:l,fieldInfos:s,fieldInfoMap:n,layer:o,value:d,graphic:e})})}function dd({attributes:i,relatedInfo:e,fieldInfoMap:t,fieldInfos:s,layer:n}){i&&e&&(e.relatedFeatures&&e.relatedFeatures&&e.relatedFeatures.forEach(o=>Io({attributes:i,graphic:o,relatedInfo:e,fieldInfoMap:t,fieldInfos:s,layer:n})),e.relatedStatsFeatures&&e.relatedStatsFeatures&&e.relatedStatsFeatures.forEach(o=>Io({attributes:i,graphic:o,relatedInfo:e,fieldInfoMap:t,fieldInfos:s,layer:n})))}const Co=i=>{if(!i)return!1;const e=i.toUpperCase();return e.includes("CURRENT_TIMESTAMP")||e.includes("CURRENT_DATE")||e.includes("CURRENT_TIME")},oa=({layer:i,method:e,query:t,definitionExpression:s})=>{var r,l;if(!((l=(r=i.capabilities)==null?void 0:r.query)!=null&&l.supportsCacheHint)||e==="attachments")return;const n=M(t.where)?t.where:null,o=M(t.geometry)?t.geometry:null;Co(s)||Co(n)||(o==null?void 0:o.type)==="extent"||t.resultType==="tile"||(t.cacheHint=!0)},hd=({query:i,layer:e,method:t})=>{oa({layer:e,method:t,query:i,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})},ud=({queryPayload:i,layer:e,method:t})=>{oa({layer:e,method:t,query:i,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})};function pd(i,e,t){return i&&e&&t?To(i.allLayers,e,t)||To(i.allTables,e,t):null}function To(i,e,t){return i.find(s=>s!==e&&s.type==="feature"&&s.url===e.url&&s.layerId===t.relatedTableId)}const xo={editing:!1,operations:{add:!0,update:!0,delete:!0}},ra=W.ofType(rc);let me=class extends D{constructor(e){super(e),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.abilities={...xo},this.activeAttachmentInfo=null,this.activeFileInfo=null,this.attachmentInfos=new ra,this.fileInfos=new W,this.graphic=null,this.mode="view",this.filesEnabled=!1,this.addHandles(y(()=>this.graphic,()=>this._graphicChanged(),O))}destroy(){this._attachmentLayer=null,this.graphic=null}castAbilities(e){return{...xo,...e}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){const{graphic:e}=this;if(!e)return!1;const t=e.layer||e.sourceLayer;return(t==null?void 0:t.loaded)&&"capabilities"in t&&t.capabilities&&"operations"in t.capabilities&&"supportsResizeAttachments"in t.capabilities.operations&&t.capabilities.operations.supportsResizeAttachments||!1}async getAttachments(){const{_attachmentLayer:e,attachmentInfos:t}=this;if(!e||typeof e.queryAttachments!="function")throw new k("invalid-layer","getAttachments(): A valid layer is required.");const s=this._getObjectId(),n=new Yn({objectIds:[s],returnMetadata:!0}),o=[],r=e.queryAttachments(n).then(d=>d[s]||o).catch(()=>o);this._getAttachmentsPromise=r,this.notifyChange("state");const l=await r;return t.removeAll(),l.length&&t.addMany(l),this._getAttachmentsPromise=null,this.notifyChange("state"),l}async addAttachment(e,t=this.graphic){var d;const{_attachmentLayer:s,attachmentInfos:n,abilities:o}=this;if(!t)throw new k("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:t});if(!e)throw new k("invalid-attachment","addAttachment(): An attachment is required.",{attachment:e});if(!((d=o.operations)!=null&&d.add))throw new k("invalid-abilities","addAttachment(): add abilities are required.");if(!s||typeof s.addAttachment!="function")throw new k("invalid-layer","addAttachment(): A valid layer is required.");const r=s.addAttachment(t,e).then(h=>this._queryAttachment(h.objectId,t)),l=await r;return n.add(l),l}async deleteAttachment(e){var d;const{_attachmentLayer:t,attachmentInfos:s,graphic:n,abilities:o}=this;if(!e)throw new k("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!((d=o.operations)!=null&&d.delete))throw new k("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!t||typeof t.deleteAttachments!="function")throw new k("invalid-layer","deleteAttachment(): A valid layer is required.");if(!n)throw new k("invalid-graphic","deleteAttachment(): A graphic is required.");const r=t.deleteAttachments(n,[e.id]).then(()=>e),l=await r;return s.remove(l),l}async updateAttachment(e,t=this.activeAttachmentInfo){var u;const{_attachmentLayer:s,attachmentInfos:n,graphic:o,abilities:r}=this;if(!e)throw new k("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:e});if(!t)throw new k("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:t});if(!((u=r.operations)!=null&&u.update))throw new k("invalid-abilities","updateAttachment(): Update abilities are required.");const l=n.findIndex(p=>p===t);if(!s||typeof s.updateAttachment!="function")throw new k("invalid-layer","updateAttachment(): A valid layer is required.");if(!o)throw new k("invalid-graphic","updateAttachment(): A graphic is required.");const d=s.updateAttachment(o,t.id,e).then(p=>this._queryAttachment(p.objectId)),h=await d;return n.splice(l,1,h),h}async commitFiles(){return await Promise.all(this.fileInfos.items.map(e=>this.addAttachment(e.form))),this.fileInfos.removeAll(),this.getAttachments()}addFile(e,t){if(!e||!t)return null;const s={file:e,form:t};return this.fileInfos.add(s),s}updateFile(e,t,s=this.activeFileInfo){if(!e||!t||!s)return null;const n=this.fileInfos.findIndex(o=>s===o);return n>-1&&this.fileInfos.splice(n,1,{file:e,form:t}),this.fileInfos.items[n]}deleteFile(e){const t=this.fileInfos.find(s=>s.file===e);return t?(this.fileInfos.remove(t),t):null}async _queryAttachment(e,t){const{_attachmentLayer:s}=this;if(!e||!(s!=null&&s.queryAttachments))throw new k("invalid-attachment-id","Could not query attachment.");const n=this._getObjectId(t),o=new Yn({objectIds:[n],attachmentsWhere:`AttachmentId=${e}`,returnMetadata:!0});return s.queryAttachments(o).then(r=>r[n][0])}_getObjectId(e=this.graphic){return(e==null?void 0:e.getObjectId())??null}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))}_setAttachmentLayer(){const{graphic:e}=this,t=Xr(e);this._attachmentLayer=t?t.type==="scene"&&M(t.associatedLayer)?t.associatedLayer:t:null}};a([c()],me.prototype,"abilities",void 0),a([Xe("abilities")],me.prototype,"castAbilities",null),a([c()],me.prototype,"activeAttachmentInfo",void 0),a([c()],me.prototype,"activeFileInfo",void 0),a([c({readOnly:!0,type:ra})],me.prototype,"attachmentInfos",void 0),a([c()],me.prototype,"fileInfos",void 0),a([c({type:Lt})],me.prototype,"graphic",void 0),a([c()],me.prototype,"mode",void 0),a([c({readOnly:!0})],me.prototype,"state",null),a([c()],me.prototype,"filesEnabled",void 0),a([c({readOnly:!0})],me.prototype,"supportsResizeAttachments",null),me=a([I("esri.widgets.Attachments.AttachmentsViewModel")],me);const Dn=me;function Eo(i){const e=i.toLowerCase();return e==="image/bmp"||e==="image/emf"||e==="image/exif"||e==="image/gif"||e==="image/x-icon"||e==="image/jpeg"||e==="image/png"||e==="image/tiff"||e==="image/x-wmf"}function md(i){const e=ml("esri/themes/base/images/files/");return i?i==="text/plain"?`${e}text-32.svg`:i==="application/pdf"?`${e}pdf-32.svg`:i==="text/csv"?`${e}csv-32.svg`:i==="application/gpx+xml"?`${e}gpx-32.svg`:i==="application/x-dwf"?`${e}cad-32.svg`:i==="application/postscript"||i==="application/json"||i==="text/xml"||i==="model/vrml"?`${e}code-32.svg`:i==="application/x-zip-compressed"||i==="application/x-7z-compressed"||i==="application/x-gzip"||i==="application/x-tar"||i==="application/x-gtar"||i==="application/x-bzip2"||i==="application/gzip"||i==="application/x-compress"||i==="application/x-apple-diskimage"||i==="application/x-rar-compressed"||i==="application/zip"?`${e}zip-32.svg`:i.includes("image/")?`${e}image-32.svg`:i.includes("audio/")?`${e}sound-32.svg`:i.includes("video/")?`${e}video-32.svg`:i.includes("msexcel")||i.includes("ms-excel")||i.includes("spreadsheetml")?`${e}excel-32.svg`:i.includes("msword")||i.includes("ms-word")||i.includes("wordprocessingml")?`${e}word-32.svg`:i.includes("powerpoint")||i.includes("presentationml")?`${e}report-32.svg`:`${e}generic-32.svg`:`${e}generic-32.svg`}const ko={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},S="esri-attachments",ft="esri-button",v={base:S,loaderContainer:`${S}__loader-container`,loader:`${S}__loader`,fadeIn:`${S}--fade-in`,container:`${S}__container`,containerList:`${S}__container--list`,containerPreview:`${S}__container--preview`,actions:`${S}__actions`,deleteButton:`${S}__delete-button`,addAttachmentButton:`${S}__add-attachment-button`,errorMessage:`${S}__error-message`,items:`${S}__items`,item:`${S}__item`,itemButton:`${S}__item-button`,itemMask:`${S}__item-mask`,itemMaskIcon:`${S}__item-mask--icon`,itemImage:`${S}__image`,itemImageResizable:`${S}__image--resizable`,itemLabel:`${S}__label`,itemFilename:`${S}__filename`,itemChevronIcon:`${S}__item-chevron-icon`,itemLink:`${S}__item-link`,itemLinkOverlay:`${S}__item-link-overlay`,itemLinkOverlayIcon:`${S}__item-link-overlay-icon`,itemEditIcon:`${S}__item-edit-icon`,itemAddIcon:`${S}__item-add-icon`,itemAddButton:`${S}__item-add-button`,formNode:`${S}__form-node`,fileFieldset:`${S}__file-fieldset`,fileLabel:`${S}__file-label`,fileName:`${S}__file-name`,fileInput:`${S}__file-input`,metadata:`${S}__metadata`,metadataFieldset:`${S}__metadata-fieldset`,progressBar:`${S}__progress-bar`,esriWidget:"esri-widget",esriButton:ft,buttonDisabled:`${ft}--disabled`,esriButtonSecondary:`${ft}--secondary`,esriButtonTertiary:`${ft}--tertiary`,esriButtonThird:`${ft}--third`,esriButtonSmall:`${ft}--small`,esriButtonHalf:`${ft}--half`,empty:"esri-widget__content--empty",iconExternalLink:"esri-icon-link-external",iconEdit:"esri-icon-edit",iconRight:"esri-icon-right",iconLeft:"esri-icon-left",iconPlus:"esri-icon-plus"},Ls=window.CSS;let oe=class extends le{constructor(e,t){super(e,t),this.displayType="auto",this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=null,this.visibleElements={...ko},this._supportsImageOrientation=Ls&&Ls.supports&&Ls.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null}initialize(){this.viewModel||(this.viewModel=new Dn),this.addHandles([xe(()=>{var e;return(e=this.viewModel)==null?void 0:e.attachmentInfos},"change",()=>this.scheduleRender()),xe(()=>{var e;return(e=this.viewModel)==null?void 0:e.fileInfos},"change",()=>this.scheduleRender()),y(()=>{var e;return(e=this.viewModel)==null?void 0:e.mode},()=>this._modeChanged(),O)])}loadDependencies(){return Promise.all([w(()=>import("./calcite-icon-51eb6857.js"),["assets/calcite-icon-51eb6857.js","assets/icon-5450785a.js","assets/widget-7352089c.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/uuid-73213768.js","assets/observers-4f67f1fb.js"])])}get abilities(){return this.viewModel.abilities}set abilities(e){this.viewModel.abilities=e}get effectiveDisplayType(){const{displayType:e}=this;return e&&e!=="auto"?e:this.viewModel.supportsResizeAttachments?"preview":"list"}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}castVisibleElements(e){return{...ko,...e}}addAttachment(){const{_addAttachmentForm:e,viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.addAttachment(e).then(s=>(this._set("submitting",!1),this._set("error",null),t.mode="view",s)).catch(s=>{throw this._set("submitting",!1),this._set("error",new k("attachments:add-attachment",this.messages.addErrorMessage,s)),s})}deleteAttachment(e){const{viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.deleteAttachment(e).then(s=>(this._set("submitting",!1),this._set("error",null),t.mode="view",s)).catch(s=>{throw this._set("submitting",!1),this._set("error",new k("attachments:delete-attachment",this.messages.deleteErrorMessage,s)),s})}updateAttachment(){const{viewModel:e}=this,{_updateAttachmentForm:t}=this;return this._set("submitting",!0),this._set("error",null),e.updateAttachment(t).then(s=>(this._set("submitting",!1),this._set("error",null),e.mode="view",s)).catch(s=>{throw this._set("submitting",!1),this._set("error",new k("attachments:update-attachment",this.messages.updateErrorMessage,s)),s})}addFile(){const e=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);return this.viewModel.mode="view",e}updateFile(){const{viewModel:e}=this,t=e.updateFile(this.selectedFile,this._updateAttachmentForm,e.activeFileInfo);return e.mode="view",t}deleteFile(e){var s;const t=this.viewModel.deleteFile(e||((s=this.viewModel.activeFileInfo)==null?void 0:s.file));return this.viewModel.mode="view",t}render(){const{submitting:e,viewModel:t}=this,{state:s}=t;return m("div",{class:this.classes(v.base,v.esriWidget)},e?this.renderProgressBar():null,s==="loading"?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}renderErrorMessage(){const{error:e,visibleElements:t}=this;return e&&t.errorMessage?m("div",{key:"error-message",class:v.errorMessage},e.message):null}renderAttachments(){const{activeFileInfo:e,mode:t,activeAttachmentInfo:s}=this.viewModel;return t==="add"?this.renderAddForm():t==="edit"?this.renderDetailsForm(s||e):this.renderAttachmentContainer()}renderLoading(){return m("div",{class:v.loaderContainer,key:"loader"},m("div",{class:v.loader}))}renderProgressBar(){return this.visibleElements.progressBar?m("div",{class:v.progressBar,key:"progress-bar"}):null}renderAddForm(){const{submitting:e,selectedFile:t}=this,s=e||!t,n=this.visibleElements.cancelAddButton?m("button",{type:"button",bind:this,disabled:e,onclick:this._cancelForm,class:this.classes(v.esriButton,v.esriButtonTertiary,v.esriButtonSmall,v.esriButtonHalf,e&&v.buttonDisabled)},this.messages.cancel):null,o=this.visibleElements.addSubmitButton?m("button",{type:"submit",disabled:s,class:this.classes(v.esriButton,v.esriButtonSecondary,v.esriButtonSmall,v.esriButtonHalf,{[v.buttonDisabled]:s})},this.messages.add):null,r=t?m("span",{key:"file-name",class:v.fileName},t.name):null,l=m("form",{bind:this,afterCreate:as,afterRemoved:ro,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},m("fieldset",{class:v.fileFieldset},r,m("label",{class:this.classes(v.fileLabel,v.esriButton,v.esriButtonSecondary)},t?this.messages.changeFile:this.messages.selectFile,m("input",{class:v.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),o,n);return m("div",{key:"add-form-container",class:v.formNode},l)}renderDetailsForm(e){var H,Y,te;const{visibleElements:t,viewModel:s,selectedFile:n,submitting:o}=this,{abilities:r}=s,l=o||!n;let d,h,u,p;n?(d=n.type,h=n.name,u=n.size):e&&"file"in e?(d=e.file.type,h=e.file.name,u=e.file.size):e&&"contentType"in e&&(d=e.contentType,h=e.name,u=e.size,p=e.url);const g=r.editing&&((H=r.operations)!=null&&H.delete)&&t.deleteButton?m("button",{key:"delete-button",type:"button",disabled:o,bind:this,onclick:q=>this._submitDeleteAttachment(q,e),class:this.classes(v.esriButton,v.esriButtonSmall,v.esriButtonTertiary,v.deleteButton,{[v.buttonDisabled]:o})},this.messages.delete):void 0,f=r.editing&&((Y=r.operations)!=null&&Y.update)&&t.updateButton?m("button",{disabled:l,key:"update-button",type:"submit",class:this.classes(v.esriButton,v.esriButtonSmall,v.esriButtonThird,{[v.buttonDisabled]:l})},this.messages.update):void 0,b=this.visibleElements.cancelUpdateButton?m("button",{disabled:o,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(v.esriButton,v.esriButtonSmall,v.esriButtonTertiary,v.esriButtonThird,{[v.buttonDisabled]:o})},this.messages.cancel):void 0,C=r.editing&&((te=r.operations)!=null&&te.update)?m("fieldset",{key:"file",class:v.fileFieldset},m("span",{key:"file-name",class:v.fileName},h),m("label",{class:this.classes(v.fileLabel,v.esriButton,v.esriButtonSecondary)},this.messages.changeFile,m("input",{class:v.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):void 0,P=m("fieldset",{key:"size",class:v.metadataFieldset},m("label",null,Dc(this.messagesUnits,u??0))),A=m("fieldset",{key:"content-type",class:v.metadataFieldset},m("label",null,d)),N=M(p)?m("a",{class:v.itemLink,href:p,rel:"noreferrer",target:"_blank"},this.renderImageMask(e,400),m("div",{class:v.itemLinkOverlay},m("span",{class:v.itemLinkOverlayIcon},m("calcite-icon",{icon:"launch"})))):this.renderImageMask(e,400),L=m("form",{bind:this,afterCreate:as,afterRemoved:ro,"data-node-ref":"_updateAttachmentForm",onsubmit:q=>this._submitUpdateAttachment(q,e)},m("div",{class:v.metadata},P,A),C,m("div",{class:v.actions},g,b,f));return m("div",{key:"edit-form-container",class:v.formNode},N,L)}renderImageMask(e,t){return e?"file"in e?this.renderGenericImageMask(e.file.name,e.file.type):this.renderImageMaskForAttachment(e,t):null}renderGenericImageMask(e,t){const{supportsResizeAttachments:s}=this.viewModel,n=md(t),o={[v.itemImageResizable]:s};return m("div",{class:this.classes(v.itemMaskIcon,v.itemMask)},m("img",{title:e,alt:e,src:n,class:this.classes(o,v.itemImage)}))}renderImageMaskForAttachment(e,t){const{supportsResizeAttachments:s}=this.viewModel;if(!e)return null;const{contentType:n,name:o,url:r}=e;if(!s||!Eo(n))return this.renderGenericImageMask(o,n);const l=this._getCSSTransform(e),d=l?{transform:l,"image-orientation":"none"}:{},h=`${r}${r!=null&&r.includes("?")?"&":"?"}w=${t}`,u={[v.itemImageResizable]:s};return m("div",{class:this.classes(v.itemMask)},m("img",{styles:d,alt:o,title:o,src:h,class:this.classes(u,v.itemImage)}))}renderFile(e){const{file:t}=e;return m("li",{class:v.item,key:t},m("button",{key:"details-button",bind:this,class:v.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,onclick:()=>this._startEditFile(e),type:"button"},this.renderImageMask(e),m("label",{class:v.itemLabel},m("span",{class:v.itemFilename},t.name||this.messages.noTitle),m("span",{"aria-hidden":"true",class:this.classes(v.itemChevronIcon,De(this.container)?v.iconLeft:v.iconRight)}))))}renderAttachmentInfo({attachmentInfo:e,displayType:t}){const{viewModel:s,effectiveDisplayType:n}=this,{abilities:o,supportsResizeAttachments:r}=s,{contentType:l,name:d,url:h}=e,u=this.renderImageMask(e,t==="list"?48:400),p=o.editing?m("span",{"aria-hidden":"true",class:this.classes(v.itemChevronIcon,De(this.container)?v.iconLeft:v.iconRight)}):null,g=[u,n==="preview"&&r&&Eo(l)?null:m("label",{class:v.itemLabel},m("span",{class:v.itemFilename},d||this.messages.noTitle),p)],f=o.editing?m("button",{key:"details-button",bind:this,class:v.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":e.id,onclick:()=>this._startEditAttachment(e),type:"button"},g):m("a",{key:"details-link",class:v.itemButton,href:h??void 0,target:"_blank"},g);return m("li",{class:v.item,key:e},f)}renderAttachmentContainer(){var b;const{effectiveDisplayType:e,viewModel:t,visibleElements:s}=this,{attachmentInfos:n,abilities:o,fileInfos:r}=t,l=!!(n!=null&&n.length),d=!!(r!=null&&r.length),h={[v.containerList]:e!=="preview",[v.containerPreview]:e==="preview"},u=o.editing&&((b=o.operations)!=null&&b.add)&&s.addButton?m("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes(v.esriButton,v.esriButtonTertiary,v.addAttachmentButton),type:"button"},m("span",{"aria-hidden":"true",class:this.classes(v.itemAddIcon,v.iconPlus)}),this.messages.add):void 0,p=l?m("ul",{key:"attachments-list",class:v.items},n.toArray().map(C=>this.renderAttachmentInfo({attachmentInfo:C,displayType:e}))):void 0,g=d?m("ul",{key:"file-list",class:v.items},r.toArray().map(C=>this.renderFile(C))):void 0,f=d||l?void 0:m("div",{class:v.empty},this.messages.noAttachments);return m("div",{key:"attachments-container",class:this.classes(v.container,h)},p,g,f,u)}_modeChanged(){this._set("error",null),this._set("selectedFile",null)}_handleFileInputChange(e){const t=e.target,s=t&&t.files&&t.files.item(0);this._set("selectedFile",s)}_submitDeleteAttachment(e,t){e.preventDefault(),t&&("file"in t?this.deleteFile(t.file):t&&this.deleteAttachment(t))}_submitAddAttachment(e){e.preventDefault(),this.viewModel.filesEnabled?this.addFile():this.addAttachment()}_submitUpdateAttachment(e,t){e.preventDefault(),t&&"file"in t?this.updateFile():this.updateAttachment()}_startEditAttachment(e){const{viewModel:t}=this;t.activeFileInfo=null,t.activeAttachmentInfo=e,t.mode="edit"}_startEditFile(e){const{viewModel:t}=this;t.activeAttachmentInfo=null,t.activeFileInfo=e,t.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(e){e.preventDefault(),this.viewModel.mode="view"}_getCSSTransform(e){const{orientationInfo:t}=e;return!this._supportsImageOrientation&&t?[t.rotation?`rotate(${t.rotation}deg)`:"",t.mirrored?"scaleX(-1)":""].join(" "):""}};a([c()],oe.prototype,"abilities",null),a([c()],oe.prototype,"displayType",void 0),a([c({readOnly:!0})],oe.prototype,"effectiveDisplayType",null),a([c()],oe.prototype,"graphic",null),a([c()],oe.prototype,"label",null),a([c(),ae("esri/widgets/Attachments/t9n/Attachments")],oe.prototype,"messages",void 0),a([c(),ae("esri/core/t9n/Units")],oe.prototype,"messagesUnits",void 0),a([c({readOnly:!0})],oe.prototype,"selectedFile",void 0),a([c({readOnly:!0})],oe.prototype,"submitting",void 0),a([c({readOnly:!0})],oe.prototype,"error",void 0),a([c({type:Dn})],oe.prototype,"viewModel",void 0),a([c()],oe.prototype,"visibleElements",void 0),a([Xe("visibleElements")],oe.prototype,"castVisibleElements",null),oe=a([I("esri.widgets.Attachments")],oe);const gd=oe;let yi=class extends Dn{constructor(e){super(e),this.description=null,this.title=null}};a([c()],yi.prototype,"description",void 0),a([c()],yi.prototype,"title",void 0),yi=a([I("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],yi);const On=yi,Ss="esri-feature-element-info",Ds={base:Ss,title:`${Ss}__title`,description:`${Ss}__description`};let Ht=class extends le{constructor(e,t){super(e,t),this.description=null,this.headingLevel=2,this.title=null}render(){return m("div",{class:Ds.base},this.renderTitle(),this.renderDescription())}renderTitle(){const{title:e}=this;return e?m(An,{level:this.headingLevel,class:Ds.title},e):null}renderDescription(){const{description:e}=this;return e?m("div",{key:"description",class:Ds.description},e):null}};a([c()],Ht.prototype,"description",void 0),a([c()],Ht.prototype,"headingLevel",void 0),a([c()],Ht.prototype,"title",void 0),Ht=a([I("esri.widgets.Feature.support.FeatureElementInfo")],Ht);const bs=Ht,fd={base:"esri-feature-attachments"};let ke=class extends le{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attachmentsWidget=new gd,this.headingLevel=2,this.viewModel=new On}initialize(){this._featureElementInfo=new bs,this.addHandles([y(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title,this.headingLevel]},()=>this._setupFeatureElementInfo(),O),y(()=>this.viewModel,e=>this.attachmentsWidget.viewModel=e,O)])}destroy(){var e;this.attachmentsWidget.destroy(),(e=this._featureElementInfo)==null||e.destroy()}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get displayType(){return this.attachmentsWidget.displayType}set displayType(e){this.attachmentsWidget.displayType=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var t;const{attachmentsWidget:e}=this;return m("div",{class:fd.base},(t=this._featureElementInfo)==null?void 0:t.render(),e==null?void 0:e.render())}_setupFeatureElementInfo(){var n;const{description:e,title:t,headingLevel:s}=this;(n=this._featureElementInfo)==null||n.set({description:e,title:t,headingLevel:s})}};a([c({readOnly:!0})],ke.prototype,"attachmentsWidget",void 0),a([c()],ke.prototype,"description",null),a([c()],ke.prototype,"displayType",null),a([c()],ke.prototype,"graphic",null),a([c()],ke.prototype,"headingLevel",void 0),a([c()],ke.prototype,"title",null),a([c({type:On})],ke.prototype,"viewModel",void 0),ke=a([I("esri.widgets.Feature.FeatureAttachments")],ke);const _d=ke;let ot=class extends ms(D){constructor(e){super(e),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.handles.add(y(()=>this.creator,t=>{this._destroyContent(),this._createContent(t)},O))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:e,graphic:t,destroyer:s}=this;e&&t&&(ds(s,{graphic:t}).catch(()=>null),this._set("created",null))}async _createContent(e){const t=this.graphic;if(!t||!e)return;const s=ds(e,{graphic:t}).catch(()=>null);this._loadingPromise=s,this.notifyChange("state");const n=await s;s===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",n))}};a([c({readOnly:!0})],ot.prototype,"created",void 0),a([c()],ot.prototype,"creator",void 0),a([c()],ot.prototype,"destroyer",void 0),a([c({type:Lt})],ot.prototype,"graphic",void 0),a([c({readOnly:!0})],ot.prototype,"state",null),ot=a([I("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],ot);const hs=ot,Os="esri-feature-content",Vs={base:Os,loaderContainer:`${Os}__loader-container`,loader:`${Os}__loader`};let jt=class extends le{constructor(e,t){super(e,t),this.viewModel=null,this._addTargetToAnchors=s=>{Array.from(s.querySelectorAll("a")).forEach(n=>{Jr(n.href)&&!n.hasAttribute("target")&&n.setAttribute("target","_blank")})}}get creator(){var e;return(e=this.viewModel)==null?void 0:e.creator}set creator(e){this.viewModel&&(this.viewModel.creator=e)}get graphic(){var e;return(e=this.viewModel)==null?void 0:e.graphic}set graphic(e){this.viewModel&&(this.viewModel.graphic=e)}renderLoading(){return m("div",{class:Vs.loaderContainer,key:"loader"},m("div",{class:Vs.loader}))}renderCreated(){var t;const e=(t=this.viewModel)==null?void 0:t.created;return e?e instanceof HTMLElement?m("div",{key:e,bind:e,afterCreate:this._attachToNode}):Br(e)?m("div",{key:e},!e.destroyed&&e.render()):m("div",{key:e,innerHTML:e,afterCreate:this._addTargetToAnchors}):null}render(){var t;const e=(t=this.viewModel)==null?void 0:t.state;return m("div",{class:Vs.base},e==="loading"?this.renderLoading():this.renderCreated())}_attachToNode(e){const t=this;e.appendChild(t)}};a([c()],jt.prototype,"creator",null),a([c()],jt.prototype,"graphic",null),a([c({type:hs})],jt.prototype,"viewModel",void 0),jt=a([I("esri.widgets.Feature.FeatureContent")],jt);const Wi=jt;let Ue=class extends D{constructor(e){super(e),this.attributes=null,this.expressionInfos=null,this.description=null,this.fieldInfos=null,this.title=null}get formattedFieldInfos(){const{expressionInfos:e,fieldInfos:t}=this,s=[];return t==null||t.forEach(n=>{if(!(!n.hasOwnProperty("visible")||n.visible))return;const o=n.clone();o.label=ea(o,e),s.push(o)}),s}};a([c()],Ue.prototype,"attributes",void 0),a([c({type:[gl]})],Ue.prototype,"expressionInfos",void 0),a([c()],Ue.prototype,"description",void 0),a([c({type:[Cr]})],Ue.prototype,"fieldInfos",void 0),a([c({readOnly:!0})],Ue.prototype,"formattedFieldInfos",null),a([c()],Ue.prototype,"title",void 0),Ue=a([I("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],Ue);const Ms=Ue,yd=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function vd(i){let e=null;return yd.some(t=>(t.pattern.test(i)&&(e=t),!!e)),e}function wd(i,e){if(typeof e!="string"||!e)return e;const t=vd(e);if(!t)return e;const s=e.match(t.pattern),n=s&&s[2],o=si(si(t.label,{messages:i,hierPart:n}),{appName:t.appName}),r=t.target?` target="${t.target}"`:"",l=t.target==="_blank"?' rel="noreferrer"':"";return e.replace(t.pattern,`<a${r} href="$1"${l}>${o}</a>`)}const zi="esri-feature-fields",li={base:zi,fieldHeader:`${zi}__field-header`,fieldData:`${zi}__field-data`,fieldDataDate:`${zi}__field-data--date`,esriTable:"esri-widget__table"};let Te=class extends le{constructor(e,t){super(e,t),this._featureElementInfo=null,this.viewModel=new Ms,this.messages=null,this.messagesURIUtils=null}initialize(){this._featureElementInfo=new bs,this.addHandles(y(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title]},()=>this._setupFeatureElementInfo(),O))}destroy(){var e;(e=this._featureElementInfo)==null||e.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get expressionInfos(){return this.viewModel.expressionInfos}set expressionInfos(e){this.viewModel.expressionInfos=e}get fieldInfos(){return this.viewModel.fieldInfos}set fieldInfos(e){this.viewModel.fieldInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}renderFieldInfo(e,t){const{attributes:s}=this.viewModel,n=e.fieldName,o=e.label||n,r=s?s[n]==null?"":s[n]:"",l=!(!e.format||!e.format.dateFormat),d=typeof r=="number"&&!l?this._forceLTR(r):wd(this.messagesURIUtils,r),h={[li.fieldDataDate]:l};return m("tr",{key:`fields-element-info-row-${n}-${t}`},m("th",{key:`fields-element-info-row-header-${n}-${t}`,class:li.fieldHeader,innerHTML:o}),m("td",{key:`fields-element-info-row-data-${n}-${t}`,class:this.classes(li.fieldData,h),innerHTML:d}))}renderFields(){const{formattedFieldInfos:e}=this.viewModel;return e!=null&&e.length?m("table",{class:li.esriTable,summary:this.messages.fieldsSummary},m("tbody",null,e.map((t,s)=>this.renderFieldInfo(t,s)))):null}render(){var e;return m("div",{class:li.base},(e=this._featureElementInfo)==null?void 0:e.render(),this.renderFields())}_setupFeatureElementInfo(){var s;const{description:e,title:t}=this;(s=this._featureElementInfo)==null||s.set({description:e,title:t})}_forceLTR(e){return`&lrm;${e}`}};a([c()],Te.prototype,"attributes",null),a([c()],Te.prototype,"description",null),a([c()],Te.prototype,"expressionInfos",null),a([c()],Te.prototype,"fieldInfos",null),a([c()],Te.prototype,"title",null),a([c({type:Ms,nonNullable:!0})],Te.prototype,"viewModel",void 0),a([c(),ae("esri/widgets/Feature/t9n/Feature")],Te.prototype,"messages",void 0),a([c(),ae("esri/widgets/support/t9n/uriUtils")],Te.prototype,"messagesURIUtils",void 0),Te=a([I("esri.widgets.Feature.FeatureFields")],Te);const aa=Te,bd="esri.widgets.Feature.support.relatedFeatureUtils",$o=V.getLogger(bd),Po=new Map;function Zi(i){if(!Ke(i))return null;const[e,t]=i.split("/").slice(1);return{layerId:e,fieldName:t}}function Md(i,e){if(!e.relationships)return null;let t=null;const{relationships:s}=e;return s.some(n=>n.id===parseInt(i,10)&&(t=n,!0)),t}function Id({originRelationship:i,relationships:e,layerId:t}){let s=null;return e&&e.some(n=>(`${n.relatedTableId}`===t&&n.id===(i==null?void 0:i.id)&&(s=n),!!s)),s}function Cd(i,e){const t=e.toLowerCase();for(const s in i)if(s.toLowerCase()===t)return i[s];return null}function Td(i,e){const t=Md(i,e);if(t)return{url:`${e.url}/${t.relatedTableId}`,sourceSpatialReference:e.spatialReference,relation:t,relatedFields:[],outStatistics:[]}}function xd(i,e){if(!e||!i)return;const{features:t,statsFeatures:s}=i,n=t&&t.value;e.relatedFeatures=n?n.features:[];const o=s&&s.value;e.relatedStatsFeatures=o?o.features:[]}function Ed(i,e,t,s){var o;const n=new nn;return n.outFields=["*"],n.relationshipId=typeof e.id=="number"?e.id:parseInt(e.id,10),n.objectIds=[i.attributes[t.objectIdField]],((o=t.queryRelatedFeatures)==null?void 0:o.call(t,n,s))??Promise.resolve({})}function kd(i,e,t){let s=0;const n=[];for(;s<e.length;)n.push(`${i} IN (${e.slice(s,t+s)})`),s+=t;return n.join(" OR ")}async function $d(i,e,t,s){const n=t.layerId.toString(),{layerInfo:o,relation:r,relatedFields:l,outStatistics:d,url:h,sourceSpatialReference:u}=e;if(!o||!r)return null;const p=Id({originRelationship:r,relationships:o.relationships,layerId:n});if(p!=null&&p.relationshipTableId&&p.keyFieldInRelationshipTable){const f=(await Ed(i,p,t,s))[i.attributes[t.objectIdField]];if(!f)return null;const b=f.features.map(C=>C.attributes[o.objectIdField]);if(d!=null&&d.length&&o.supportsStatistics){const C=new Es;C.where=kd(o.objectIdField,b,1e3),C.outFields=l,C.outStatistics=d,C.sourceSpatialReference=u;const P={features:Promise.resolve(f),statsFeatures:Ps(h,C)};return Rt(P)}}const g=p==null?void 0:p.keyField;if(g){const f=yl(Ld(o.fields,g)),b=Cd(i.attributes,r.keyField),C=f?`${g}=${b}`:`${g}='${b}'`,P=Ps(h,new Es({where:C,outFields:e.relatedFields,sourceSpatialReference:u}),s),A=e.outStatistics&&e.outStatistics.length>0&&o.supportsStatistics?Ps(h,new Es({where:C,outFields:e.relatedFields,outStatistics:e.outStatistics,sourceSpatialReference:u}),s):null,N={features:P};return A&&(N.statsFeatures=A),Rt(N)}return null}function Pd(i,e){return vl(i,{query:{f:"json"},signal:e&&e.signal})}function Ad({relatedInfos:i,layer:e},t){const s={};return i.forEach((n,o)=>{const{relation:r}=n;if(!r){const p=new k("relation-required","A relation is required on a layer to retrieve related records.");throw $o.error(p),p}const{relatedTableId:l}=r;if(typeof l!="number"){const p=new k("A related table ID is required on a layer to retrieve related records.");throw $o.error(p),p}const d=`${e.url}/${l}`,h=Po.get(d),u=h||Pd(d);h||Po.set(d,u),s[o]=u}),fl(Rt(s),t)}function Fd({graphic:i,relatedInfos:e,layer:t},s){const n={};return e.forEach((o,r)=>{o.layerInfo&&(n[r]=$d(i,o,t,s))}),Rt(n)}function Rd({relatedInfo:i,fieldName:e,fieldInfo:t}){var s,n;if((s=i.relatedFields)==null||s.push(e),t.statisticType){const o=new _l({statisticType:t.statisticType,onStatisticField:e,outStatisticFieldName:e});(n=i.outStatistics)==null||n.push(o)}}function Ld(i,e){if(i!=null){e=e.toLowerCase();for(const t of i)if(t&&t.name.toLowerCase()===e)return t}return null}const Ao={chartAnimation:!0};let Q=class extends D{constructor(e){super(e),this.abilities={...Ao},this.activeMediaInfoIndex=0,this.attributes=null,this.description=null,this.fieldInfoMap=null,this.formattedAttributes=null,this.expressionAttributes=null,this.isAggregate=!1,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null}castAbilities(e){return{...Ao,...e}}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(e){this._setContentElementMedia(e)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(e){const{formattedMediaInfoCount:t}=this,s=(e+t)%t;this.activeMediaInfoIndex=s}_pageContentElementMedia(e){const{activeMediaInfoIndex:t}=this,s=t+e;this._setContentElementMedia(s)}_formatMediaInfos(){const{mediaInfos:e,layer:t}=this,s=this.attributes??{},n=this.formattedAttributes??{},o=this.expressionAttributes??{},r=this.fieldInfoMap??new Map;return(e==null?void 0:e.map(l=>{const d=l==null?void 0:l.clone();if(!d)return null;if(d.title=$t({attributes:s,fieldInfoMap:r,globalAttributes:n,expressionAttributes:o,layer:t,text:d.title}),d.caption=$t({attributes:s,fieldInfoMap:r,globalAttributes:n,expressionAttributes:o,layer:t,text:d.caption}),d.altText=$t({attributes:s,fieldInfoMap:r,globalAttributes:n,expressionAttributes:o,layer:t,text:d.altText}),d.type==="image"){const{value:h}=d;return this._setImageValue({value:h,formattedAttributes:n,layer:t}),d.value.sourceURL?d:void 0}if(d.type==="pie-chart"||d.type==="line-chart"||d.type==="column-chart"||d.type==="bar-chart"){const{value:h}=d;return this._setChartValue({value:h,chartType:d.type,attributes:s,formattedAttributes:n,layer:t,expressionAttributes:o}),d}return null}).filter(M))??[]}_setImageValue(e){const t=this.fieldInfoMap??new Map,{value:s,formattedAttributes:n,layer:o}=e,{linkURL:r,sourceURL:l}=s;if(l){const d=hn(l,o);s.sourceURL=dn({formattedAttributes:n,template:d,fieldInfoMap:t})}if(r){const d=hn(r,o);s.linkURL=dn({formattedAttributes:n,template:d,fieldInfoMap:t})}}_setChartValue(e){const{value:t,attributes:s,formattedAttributes:n,chartType:o,layer:r,expressionAttributes:l}=e,{popupTemplate:d,relatedInfos:h}=this,{fields:u,normalizeField:p}=t,g=r;if(t.fields=Zc(u,g),p&&(t.normalizeField=Ai(p,g)),!u.some(b=>!!(n[b]!=null||Ke(b)&&(h!=null&&h.size))))return;const f=(d==null?void 0:d.fieldInfos)??[];u.forEach(b=>{if(Ke(b))return void(t.series=[...t.series,...this._getRelatedChartInfos({fieldInfos:f,fieldName:b,formattedAttributes:n,chartType:o,value:t})]);const C=this._getChartOption({value:t,attributes:s,chartType:o,formattedAttributes:n,expressionAttributes:l,fieldName:b,fieldInfos:f});t.series.push(C)})}_getRelatedChartInfos(e){var f;const{fieldInfos:t,fieldName:s,formattedAttributes:n,chartType:o,value:r}=e,l=[],d=Zi(s),h=d&&((f=this.relatedInfos)==null?void 0:f.get(d.layerId.toString()));if(!h)return l;const{relatedFeatures:u,relation:p}=h;if(!p||!u)return l;const{cardinality:g}=p;return u.forEach(b=>{const{attributes:C}=b;C&&Object.keys(C).forEach(P=>{P===d.fieldName&&l.push(this._getChartOption({value:r,attributes:C,formattedAttributes:n,fieldName:s,chartType:o,relatedFieldName:P,hasMultipleRelatedFeatures:(u==null?void 0:u.length)>1,fieldInfos:t}))})}),g==="one-to-many"||g==="many-to-many"?l:[l[0]]}_getTooltip({label:e,value:t,chartType:s}){return s==="pie-chart"?`${e}`:`${e}: ${t}`}_getChartOption(e){var te;const{value:t,attributes:s,formattedAttributes:n,expressionAttributes:o,fieldName:r,relatedFieldName:l,fieldInfos:d,chartType:h,hasMultipleRelatedFeatures:u}=e,p=this.layer,g=this.fieldInfoMap??new Map,{normalizeField:f,tooltipField:b}=t,C=f?Ke(f)?s[Zi(f).fieldName]:s[f]:null,P=Rn(r)&&o&&o[r]!==void 0?o[r]:l&&s[l]!==void 0?s[l]:s[r]!==void 0?s[r]:n[r],A=new wl({fieldName:r,value:P===void 0?null:P&&C?P/C:P});if(Ke(r)){const q=g.get(r.toLowerCase()),St=b&&g.get(b.toLowerCase()),Di=(q==null?void 0:q.fieldName)??r,ai=u&&b?Zi(b).fieldName:(St==null?void 0:St.fieldName)??b,Dt=u&&ai?s[ai]:n[ai]??(q==null?void 0:q.label)??(q==null?void 0:q.fieldName)??l,Oi=u&&l?s[l]:n[Di];return A.tooltip=this._getTooltip({label:Dt,value:Oi,chartType:h}),A}const N=ia(d,r),L=Ai(r,p),H=b&&n[b]!==void 0?n[b]:ea(N||new Cr({fieldName:L}),(te=this.popupTemplate)==null?void 0:te.expressionInfos),Y=n[L];return A.tooltip=this._getTooltip({label:H,value:Y,chartType:h}),A}};a([c()],Q.prototype,"abilities",void 0),a([Xe("abilities")],Q.prototype,"castAbilities",null),a([c()],Q.prototype,"activeMediaInfoIndex",void 0),a([c({readOnly:!0})],Q.prototype,"activeMediaInfo",null),a([c()],Q.prototype,"attributes",void 0),a([c()],Q.prototype,"description",void 0),a([c()],Q.prototype,"fieldInfoMap",void 0),a([c()],Q.prototype,"formattedAttributes",void 0),a([c()],Q.prototype,"expressionAttributes",void 0),a([c({readOnly:!0})],Q.prototype,"formattedMediaInfos",null),a([c()],Q.prototype,"isAggregate",void 0),a([c()],Q.prototype,"layer",void 0),a([c({readOnly:!0})],Q.prototype,"formattedMediaInfoCount",null),a([c()],Q.prototype,"mediaInfos",void 0),a([c()],Q.prototype,"popupTemplate",void 0),a([c()],Q.prototype,"relatedInfos",void 0),a([c()],Q.prototype,"title",void 0),Q=a([I("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],Q);const Pt=Q;var Fo=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],Sd=[].concat(Fo.slice(30,39),Fo.slice(28,30).reverse()),Dd=[{name:"default",colors:Sd},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}];const Ro="en-us",Vn=new Map([["ar",()=>w(()=>import("./ar-bb1fe5ab.js"),["assets/ar-bb1fe5ab.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.a)],["bg-bg",()=>w(()=>import("./bg_BG-184a2bfa.js"),["assets/bg_BG-184a2bfa.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.b)],["bs-ba",()=>w(()=>import("./bs_BA-f32cc344.js"),["assets/bs_BA-f32cc344.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.b)],["ca-es",()=>w(()=>import("./ca_ES-d17ee95b.js"),["assets/ca_ES-d17ee95b.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.c)],["cs-cz",()=>w(()=>import("./cs_CZ-bcd1e782.js"),["assets/cs_CZ-bcd1e782.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.c)],["da-dk",()=>w(()=>import("./da_DK-27b1b06e.js"),["assets/da_DK-27b1b06e.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.d)],["de-de",()=>w(()=>import("./de_DE-c0a1d8dd.js"),["assets/de_DE-c0a1d8dd.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.d)],["de-ch",()=>w(()=>import("./de_CH-be7b4255.js"),["assets/de_CH-be7b4255.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.d)],["el-gr",()=>w(()=>import("./el_GR-05fb9ec0.js"),["assets/el_GR-05fb9ec0.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.e)],["en-us",()=>w(()=>import("./en_US-170979d8.js"),["assets/en_US-170979d8.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.e)],["en-ca",()=>w(()=>import("./en_CA-170979d8.js"),["assets/en_CA-170979d8.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.e)],["es-es",()=>w(()=>import("./es_ES-d0b66640.js"),["assets/es_ES-d0b66640.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.e)],["et-ee",()=>w(()=>import("./et_EE-56dd74d3.js"),["assets/et_EE-56dd74d3.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.e)],["fi-fi",()=>w(()=>import("./fi_FI-91d58cb9.js"),["assets/fi_FI-91d58cb9.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.f)],["fr-fr",()=>w(()=>import("./fr_FR-a11503e0.js"),["assets/fr_FR-a11503e0.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.f)],["he-il",()=>w(()=>import("./he_IL-90db98c4.js"),["assets/he_IL-90db98c4.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.h)],["hr-hr",()=>w(()=>import("./hr_HR-fac8bb29.js"),["assets/hr_HR-fac8bb29.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.h)],["hu-hu",()=>w(()=>import("./hu_HU-e8803856.js"),["assets/hu_HU-e8803856.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.h)],["id-id",()=>w(()=>import("./id_ID-86e57d06.js"),["assets/id_ID-86e57d06.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.i)],["it-it",()=>w(()=>import("./it_IT-2d4485ba.js"),["assets/it_IT-2d4485ba.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.i)],["ja-jp",()=>w(()=>import("./ja_JP-77c6c16d.js"),["assets/ja_JP-77c6c16d.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.j)],["ko-kr",()=>w(()=>import("./ko_KR-e155b9ab.js"),["assets/ko_KR-e155b9ab.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.k)],["lt-lt",()=>w(()=>import("./lt_LT-fde47ae9.js"),["assets/lt_LT-fde47ae9.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.l)],["lv-lv",()=>w(()=>import("./lv_LV-359be050.js"),["assets/lv_LV-359be050.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.l)],["nb-no",()=>w(()=>import("./nb_NO-30d57c1a.js"),["assets/nb_NO-30d57c1a.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.n)],["nl-nl",()=>w(()=>import("./nl_NL-cb904b48.js"),["assets/nl_NL-cb904b48.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.n)],["pl-pl",()=>w(()=>import("./pl_PL-58c54c9f.js"),["assets/pl_PL-58c54c9f.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.p)],["pt-br",()=>w(()=>import("./pt_BR-d2e10248.js"),["assets/pt_BR-d2e10248.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.p)],["pt-pt",()=>w(()=>import("./pt_PT-65a41842.js"),["assets/pt_PT-65a41842.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.p)],["ro-ro",()=>w(()=>import("./ro_RO-15e90e9f.js"),["assets/ro_RO-15e90e9f.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.r)],["ru-ru",()=>w(()=>import("./ru_RU-a74d21e5.js"),["assets/ru_RU-a74d21e5.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.r)],["sk-sk",()=>w(()=>import("./sk_SK-a928dbd1.js"),["assets/sk_SK-a928dbd1.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.s)],["sl-sl",()=>w(()=>import("./sl_SL-1a3c3078.js"),["assets/sl_SL-1a3c3078.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.s)],["sr-rs",()=>w(()=>import("./sr_RS-0b18b911.js"),["assets/sr_RS-0b18b911.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.s)],["sv-se",()=>w(()=>import("./sv_SE-ce7e3f84.js"),["assets/sv_SE-ce7e3f84.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.s)],["th-th",()=>w(()=>import("./th_TH-1448f333.js"),["assets/th_TH-1448f333.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.t)],["tr-tr",()=>w(()=>import("./tr_TR-dd92f630.js"),["assets/tr_TR-dd92f630.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.t)],["uk-ua",()=>w(()=>import("./uk_UA-fe4434ed.js"),["assets/uk_UA-fe4434ed.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.u)],["vi-vn",()=>w(()=>import("./vi_VN-41938633.js"),["assets/vi_VN-41938633.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.v)],["zh-cn",()=>w(()=>import("./zh_Hans-524a1291.js"),["assets/zh_Hans-524a1291.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.z)],["zh-hk",()=>w(()=>import("./zh_Hant-0e1f08e5.js"),["assets/zh_Hant-0e1f08e5.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.z)],["zh-tw",()=>w(()=>import("./zh_Hant-0e1f08e5.js"),["assets/zh_Hant-0e1f08e5.js","assets/_commonjsHelpers-2f3e7994.js","assets/_commonjs-dynamic-modules-42bbacb3.js"]).then(i=>i.z)]]);function Od(i){const e=i.split("-")[0].toLowerCase();let t=null;for(const s of Vn.keys())if(s.startsWith(e)){t=s;break}return t}function Vd(i){return i?Vn.has(i.toLowerCase())?i.toLowerCase():Od(i)||Ro:Ro}let Nt=null,ci=null;async function Nd(i=Tr()){if(i=Vd(i),Nt&&i===ci)return Nt;Nt=w(()=>import("./index-a1a574a3.js"),["assets/index-a1a574a3.js","assets/_commonjsHelpers-2f3e7994.js"]).then(e=>e.i),ci=i;try{const[e,t]=await Promise.all([Nt,Vn.get(ci)()]);ci===i&&(e.am4core.options.defaultLocale=t.default),e.am4core.options.suppressWarnings=!0,e.am4core.options.autoDispose=!0}catch{return Nt=null,ci=null,null}return Nt}function zd(i,e="default"){const t=Dd.find(s=>s.name===e);return t?t.colors.map(s=>i.color(s)):null}const ce="esri-feature-media",G={base:ce,mediaContainer:`${ce}__container`,mediaItemContainer:`${ce}__item-container`,mediaItem:`${ce}__item`,mediaItemTitle:`${ce}__item-title`,mediaItemCaption:`${ce}__item-caption`,mediaPrevious:`${ce}__previous`,mediaPreviousIconLTR:`${ce}__previous-icon`,mediaPreviousIconRTL:`${ce}__previous-icon--rtl`,mediaNext:`${ce}__next`,mediaNextIconLTR:`${ce}__next-icon`,mediaNextIconRTL:`${ce}__next-icon--rtl`,mediaChart:`${ce}__chart`,mediaButton:`${ce}__button`,mediaIcon:`${ce}__icon`,iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow"},Ns=.05,zs=.95,Bs=15,Ve="color",et="tooltip",di="value",Lo="default-line-value";let ge=class extends le{constructor(i,e){super(i,e),this._refreshTimer=null,this._refreshIntervalInfo=null,this._featureElementInfo=null,this.viewModel=new Pt,this.messages=null,this._getChartDependencies=async t=>{const s=await Nd(),{destroyed:n,viewModel:o}=this;if(n||!o||!t)return;const{activeMediaInfo:r}=o,l=await this._getRendererColors(s);this._renderChart({chartDiv:t,mediaInfo:r,chartsModule:s,colorMap:l})}}initialize(){this._featureElementInfo=new bs,this.addHandles([y(()=>{var i,e;return[(i=this.viewModel)==null?void 0:i.activeMediaInfo,(e=this.viewModel)==null?void 0:e.activeMediaInfoIndex]},()=>this._setupMediaRefreshTimer(),O),y(()=>{var i,e;return[(i=this.viewModel)==null?void 0:i.description,(e=this.viewModel)==null?void 0:e.title]},()=>this._setupFeatureElementInfo(),O)])}destroy(){var i;this._clearMediaRefreshTimer(),(i=this._featureElementInfo)==null||i.destroy()}get attributes(){return this.viewModel.attributes}set attributes(i){this.viewModel.attributes=i}get activeMediaInfoIndex(){return this.viewModel.activeMediaInfoIndex}set activeMediaInfoIndex(i){this.viewModel.activeMediaInfoIndex=i}get description(){return this.viewModel.description}set description(i){this.viewModel.description=i}get fieldInfoMap(){return this.viewModel.fieldInfoMap}set fieldInfoMap(i){this.viewModel.fieldInfoMap=i}get layer(){return this.viewModel.layer}set layer(i){this.viewModel.layer=i}get mediaInfos(){return this.viewModel.mediaInfos}set mediaInfos(i){this.viewModel.mediaInfos=i}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(i){this.viewModel.popupTemplate=i}get relatedInfos(){return this.viewModel.relatedInfos}set relatedInfos(i){this.viewModel.relatedInfos=i}get title(){return this.viewModel.title}set title(i){this.viewModel.title=i}render(){var i;return m("div",{bind:this,class:G.base,onkeyup:this._handleMediaKeyup},(i=this._featureElementInfo)==null?void 0:i.render(),this.renderMedia())}renderMedia(){const{formattedMediaInfoCount:i}=this.viewModel;return i?m("div",{key:"media-element-container",class:G.mediaContainer},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}renderImageMediaInfo(i){const{_refreshIntervalInfo:e}=this,{activeMediaInfoIndex:t,formattedMediaInfoCount:s}=this.viewModel,{value:n,refreshInterval:o,altText:r,title:l,type:d}=i,{sourceURL:h,linkURL:u}=n,p=Jr(u??void 0)?"_blank":"_self",g=p==="_blank"?"noreferrer":"",f=o?e:null,b=f?f.timestamp:0,C=f?f.sourceURL:h,P=m("img",{alt:r||l,key:`media-${d}-${t}-${s}-${b}`,src:C??void 0});return(u?m("a",{title:l,href:u,rel:g,target:p},P):null)||P}renderChartMediaInfo(i){const{activeMediaInfoIndex:e,formattedMediaInfoCount:t}=this.viewModel;return m("div",{key:`media-${i.type}-${e}-${t}`,bind:this,class:G.mediaChart,afterCreate:this._getChartDependencies})}renderMediaInfoType(){const{activeMediaInfo:i}=this.viewModel;return i?i.type==="image"?this.renderImageMediaInfo(i):i.type.includes("chart")?this.renderChartMediaInfo(i):null:null}renderMediaInfo(){const{activeMediaInfo:i}=this.viewModel;if(!i)return null;const e=i.title?m("div",{key:"media-title",class:G.mediaItemTitle,innerHTML:i.title}):null,t=i.caption?m("div",{key:"media-caption",class:G.mediaItemCaption,innerHTML:i.caption}):null;return m("div",{key:"media-container",class:G.mediaItemContainer},m("div",{key:"media-item-container",class:G.mediaItem},this.renderMediaInfoType()),e,t)}renderMediaPageButton(i){if(this.viewModel.formattedMediaInfoCount<2)return null;const e=i==="previous",t=e?this.messages.previous:this.messages.next,s=e?this.classes(G.mediaButton,G.mediaPrevious):this.classes(G.mediaButton,G.mediaNext),n=e?this.classes(G.mediaIcon,G.mediaPreviousIconLTR,G.iconLeftTriangleArrow):this.classes(G.mediaIcon,G.mediaNextIconLTR,G.iconRightTriangleArrow),o=e?this.classes(G.mediaIcon,G.mediaPreviousIconRTL,G.iconRightTriangleArrow):this.classes(G.mediaIcon,G.mediaNextIconRTL,G.iconLeftTriangleArrow),r=e?"media-previous":"media-next",l=e?this._previous:this._next;return m("button",{type:"button",key:r,title:t,"aria-label":t,tabIndex:0,class:s,bind:this,onclick:l},m("span",{"aria-hidden":"true",class:n}),m("span",{"aria-hidden":"true",class:o}))}_setupFeatureElementInfo(){var t;const{description:i,title:e}=this;(t=this._featureElementInfo)==null||t.set({description:i,title:e})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}_getRenderer(){const{isAggregate:i,layer:e}=this.viewModel;return i&&(e!=null&&e.featureReduction)&&"renderer"in e.featureReduction?e.featureReduction.renderer:e==null?void 0:e.renderer}async _getRendererColors(i){const{am4core:e}=i,t=new Map,s=this._getRenderer(),n="default";if(!s)return t;const o=await ac(s);return o.delete(n),Array.from(o.values()).every(r=>(r==null?void 0:r.length)===1)&&(t.set(Lo,e.color({r:50,g:50,b:50,a:1})),Array.from(o.keys()).forEach(r=>{var l;r&&t.set(r,e.color((l=o.get(r))==null?void 0:l[0].toCss(!0)))})),t}_handleMediaKeyup(i){const e=xt(i);e==="ArrowLeft"&&(i.stopPropagation(),this.viewModel.previous()),e==="ArrowRight"&&(i.stopPropagation(),this.viewModel.next())}_renderChart(i){const{abilities:e}=this.viewModel,{chartsModule:t,chartDiv:s,mediaInfo:n,colorMap:o}=i,{value:r,type:l}=n,{am4core:d}=t,h=zd(d);function u(f){f instanceof d.ColorSet&&h&&(f.list=h)}rn()&&d.useTheme(t.am4themes_dark);const p=window.matchMedia("(prefers-reduced-motion: reduce)");e.chartAnimation&&!p.matches?d.useTheme(t.am4themes_animated):d.unuseTheme(t.am4themes_animated),d.useTheme(u);const g=l==="pie-chart"?this._createPieChart(i):this._createXYChart(i);s.setAttribute("aria-label",n.altText||n.title),g.data=r.series.map(f=>({[et]:f.tooltip,[di]:f.value,[Ve]:o.get(f.fieldName)})).filter(f=>l!=="pie-chart"||f.value!=null&&f.value>0)}_customizeChartTooltip(i,e){i&&(i.label.wrap=!0,i.label.maxWidth=200,i.autoTextColor=!1,i.getFillFromObject=!1,i.label.fill=e.color("#ffffff"),i.background.fill=e.color({r:0,g:0,b:0,a:.7}))}_createPieChart(i){const{chartDiv:e,chartsModule:t}=i,{am4core:s,am4charts:n}=t,o=s.create(e,n.PieChart);o.rtl=De(this.container);const r=o.series.push(new n.PieSeries);return r.labels.template.disabled=!0,r.ticks.template.disabled=!0,r.dataFields.value=di,r.dataFields.category=et,this._customizeChartTooltip(r.tooltip,s),r.slices.template.propertyFields.fill=Ve,r.slices.template.propertyFields.stroke=Ve,o}_getMinSeriesValue(i){let e=0;return i.forEach(t=>e=Math.min(t.value,e)),e}_createColumnChart(i,e){const{chartsModule:t,mediaInfo:s}=e,{value:n}=s,{am4core:o,am4charts:r}=t,l=i.xAxes.push(new r.CategoryAxis);l.dataFields.category=et,l.renderer.labels.template.disabled=!0;const d=l.tooltip;this._customizeChartTooltip(d,o),d.events.on("sizechanged",()=>{d.dy=-d.contentHeight});const h=i.yAxes.push(new r.ValueAxis),u=h.renderer.labels.template;h.renderer.minLabelPosition=Ns,h.renderer.maxLabelPosition=zs,h.min=this._getMinSeriesValue(n.series),this._customizeChartTooltip(h.tooltip,o),u.wrap=!0;const p=i.series.push(new r.ColumnSeries);p.dataFields.valueY=di,p.dataFields.categoryX=et,p.columns.template.propertyFields.fill=Ve,p.columns.template.propertyFields.stroke=Ve,i.cursor=new r.XYCursor,n.series.length>Bs&&(i.scrollbarX=new o.Scrollbar)}_createBarChart(i,e){const{chartsModule:t,mediaInfo:s}=e,{value:n}=s,{am4core:o,am4charts:r}=t,l=i.yAxes.push(new r.CategoryAxis);l.dataFields.category=et,l.renderer.inversed=!0,l.renderer.labels.template.disabled=!0;const d=l.tooltip;this._customizeChartTooltip(d,o),d.events.on("sizechanged",()=>{d.dx=d.contentWidth});const h=i.xAxes.push(new r.ValueAxis),u=h.renderer.labels.template;h.renderer.minLabelPosition=Ns,h.renderer.maxLabelPosition=zs,h.min=this._getMinSeriesValue(n.series),this._customizeChartTooltip(h.tooltip,o),u.wrap=!0;const p=i.series.push(new r.ColumnSeries);p.dataFields.valueX=di,p.dataFields.categoryY=et,p.columns.template.propertyFields.fill=Ve,p.columns.template.propertyFields.stroke=Ve,i.cursor=new r.XYCursor,n.series.length>Bs&&(i.scrollbarY=new o.Scrollbar)}_createLineChart(i,e){const{chartsModule:t,mediaInfo:s,colorMap:n}=e,{value:o}=s,{am4core:r,am4charts:l}=t,d=i.xAxes.push(new l.CategoryAxis);d.dataFields.category=et,d.renderer.labels.template.disabled=!0;const h=d.tooltip;this._customizeChartTooltip(h,r),h.events.on("sizechanged",()=>{h.dy=-h.contentHeight});const u=i.yAxes.push(new l.ValueAxis),p=u.renderer.labels.template;u.renderer.minLabelPosition=Ns,u.renderer.maxLabelPosition=zs,u.min=this._getMinSeriesValue(o.series),this._customizeChartTooltip(u.tooltip,r),p.wrap=!0;const g=i.series.push(new l.LineSeries);g.dataFields.categoryX=et,g.dataFields.valueY=di,g.strokeWidth=1;const f=n.get(Lo);f&&(g.stroke=f);const b=g.bullets.push(new l.CircleBullet);b.propertyFields.fill=Ve,b.propertyFields.stroke=Ve,i.cursor=new l.XYCursor,o.series.length>Bs&&(i.scrollbarX=new r.Scrollbar)}_createXYChart(i){const{chartDiv:e,chartsModule:t,mediaInfo:s}=i,{type:n}=s,{am4core:o,am4charts:r}=t,l=o.create(e,r.XYChart);return l.rtl=De(this.container),n==="column-chart"&&this._createColumnChart(l,i),n==="bar-chart"&&this._createBarChart(l,i),n==="line-chart"&&this._createLineChart(l,i),l}_clearMediaRefreshTimer(){const{_refreshTimer:i}=this;i&&(clearTimeout(i),this._refreshTimer=null)}_updateMediaInfoTimestamp(i){const e=Date.now();this._refreshIntervalInfo={timestamp:e,sourceURL:i&&this._getImageSource(i,e)},this.scheduleRender()}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:i}=this.viewModel;i&&i.type==="image"&&i.refreshInterval&&this._setRefreshTimeout(i)}_setRefreshTimeout(i){const{refreshInterval:e,value:t}=i;if(!e)return;const s=6e4*e;this._updateMediaInfoTimestamp(t.sourceURL);const n=setInterval(()=>{this._updateMediaInfoTimestamp(t.sourceURL)},s);this._refreshTimer=n}_getImageSource(i,e){const t=i.includes("?")?"&":"?",[s,n=""]=i.split("#");return`${s}${t}timestamp=${e}${n?"#":""}${n}`}};a([c()],ge.prototype,"attributes",null),a([c()],ge.prototype,"activeMediaInfoIndex",null),a([c()],ge.prototype,"description",null),a([c()],ge.prototype,"fieldInfoMap",null),a([c()],ge.prototype,"layer",null),a([c()],ge.prototype,"mediaInfos",null),a([c()],ge.prototype,"popupTemplate",null),a([c()],ge.prototype,"relatedInfos",null),a([c()],ge.prototype,"title",null),a([c({type:Pt})],ge.prototype,"viewModel",void 0),a([c(),ae("esri/widgets/Feature/t9n/Feature")],ge.prototype,"messages",void 0),ge=a([I("esri.widgets.Feature.FeatureMedia")],ge);const la=ge,Bd=["$datastore","$map","$layer","$aggregatedfeatures"],qd="esri.widgets.Feature.support.arcadeFeatureUtils",Ud=V.getLogger(qd);function Hd(i){return typeof i=="string"?Si(Sn(i)):Array.isArray(i)?jd(i):(i==null?void 0:i.declaredClass)==="esri.arcade.Dictionary"?Gd(i):i}function jd(i){return`<ul class="esri-widget__list">${i.map(e=>`<li>${typeof e=="string"?Si(Sn(e)):e}</li>`).join("")}</ul>`}function Gd(i){return`<table class="esri-widget__table">${i.keys().map(e=>{const t=i.field(e);return`<tr><th>${e}</th><td>${typeof t=="string"?Si(Sn(t)):t}</td></tr>`}).join("")}</table>`}function Wd({aggregatedFeatures:i,arcadeUtils:e,featureSetVars:t,context:s,viewInfo:n,map:o,graphic:r,interceptor:l}){t.forEach(d=>{const h=d.toLowerCase(),u=n.sr,p={map:o,spatialReference:u,interceptor:l};if(h==="$map"&&(s.vars[h]=e.convertMapToFeatureSetCollection(p)),h==="$layer"&&(s.vars[h]=e.convertFeatureLayerToFeatureSet({layer:r.sourceLayer,spatialReference:u,interceptor:l})),h==="$datastore"&&(s.vars[h]=e.convertServiceUrlToWorkspace({url:r.sourceLayer.url,spatialReference:u,interceptor:l})),h==="$aggregatedfeatures"){const g=r.layer,{fields:f,objectIdField:b,geometryType:C,spatialReference:P,displayField:A}=g,N=new bl({fields:f,objectIdField:b,geometryType:C,spatialReference:P,displayField:A,...g.type==="feature"?{templates:g.templates,typeIdField:g.typeIdField,types:g.types}:null,source:i});s.vars[h]=e.convertFeatureLayerToFeatureSet({layer:N,spatialReference:P,interceptor:l})}})}function ca(){return w(()=>import("./arcadeUtils-51ac43b5.js").then(i=>i.ax),["assets/arcadeUtils-51ac43b5.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/arcadeTimeUtils-ef4a84e4.js","assets/executionError-fb3f283a.js","assets/number-2c7ebde8.js","assets/featureConversionUtils-c00360ef.js","assets/aaBoundingRect-5c57438c.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js"])}function Zd(i){return"createQuery"in i&&"queryFeatures"in i}async function Kd({graphic:i,view:e}){const{isAggregate:t,layer:s}=i;if(!t||!s||(e==null?void 0:e.type)!=="2d")return[];const n=await e.whenLayerView(s);if(!Zd(n))return[];const o=n.createQuery(),r=i.getObjectId();o.aggregateIds=r!=null?[r]:[];const{features:l}=await n.queryFeatures(o);return l}async function da({expressionInfo:i,arcadeUtils:e,interceptor:t,spatialReference:s,map:n,graphic:o,view:r}){if(!i||!i.expression)return null;const l=e.createSyntaxTree(i.expression),d=Bd.filter(f=>e.hasVariable(l,f)),[h]=await Promise.all([Kd({graphic:o,view:r}),e.loadScriptDependencies(l,!0,d)]),u=e.getViewInfo({spatialReference:s}),p=e.createExecContext(o,u);p.interceptor=t,p.useAsync=!0,Wd({aggregatedFeatures:h,arcadeUtils:e,featureSetVars:d,context:p,viewInfo:u,map:n,graphic:o,interceptor:t});const g=e.createFunction(l,p);return e.executeAsyncFunction(g,p).catch(f=>Ud.error("arcade-execution-error",{error:f,graphic:o,expressionInfo:i}))}async function Qd({expressionInfos:i,spatialReference:e,graphic:t,interceptor:s,map:n,view:o}){if(!i||!i.length)return{};const r=await ca(),l={};for(const u of i)l[`expression/${u.name}`]=da({expressionInfo:u,arcadeUtils:r,interceptor:s,spatialReference:e,map:n,graphic:t,view:o});const d=await Rt(l),h={};for(const u in d)h[u]=Hd(d[u].value);return h}const Yd=1;let _e=class extends ms(D){constructor(e){super(e),this._abortController=null,this.expressionInfo=null,this.graphic=null,this.contentElement=null,this.contentElementViewModel=null,this.interceptor=null,this.view=null,this._cancelQuery=()=>{const{_abortController:t}=this;t&&t.abort(),this._abortController=null},this._createVM=()=>{var n,o;const t=(n=this.contentElement)==null?void 0:n.type;(o=this.contentElementViewModel)==null||o.destroy();const s=t==="fields"?new Ms:t==="media"?new Pt:t==="text"?new hs:null;this._set("contentElementViewModel",s)},this._compile=async()=>{this._cancelQuery();const t=new AbortController;this._abortController=t,await this._compileExpression(),this._abortController===t&&(this._abortController=null)},this._compileThrottled=ii(this._compile,Yd,this),this._compileExpression=async()=>{const{expressionInfo:t,graphic:s,interceptor:n,spatialReference:o,map:r,view:l,_abortController:d}=this;if(!(t&&s&&o&&r))return void this._set("contentElement",null);const h=await ca();if(d!==this._abortController)return;const u=await da({arcadeUtils:h,expressionInfo:t,graphic:s,interceptor:n,map:r,spatialReference:o,view:l});if(!u||u.declaredClass!=="esri.arcade.Dictionary")return void this._set("contentElement",null);const p=await u.castAsJsonAsync(d==null?void 0:d.signal),g=p==null?void 0:p.type,f=g==="media"?Ml.fromJSON(p):g==="text"?xr.fromJSON(p):g==="fields"?Il.fromJSON(p):null;this._set("contentElement",f)},this.handles.add([y(()=>[this.expressionInfo,this.graphic,this.map,this.spatialReference,this.view],()=>this._compileThrottled(),O),y(()=>[this.contentElement],()=>this._createVM(),O)])}destroy(){var e;this._cancelQuery(),(e=this.contentElementViewModel)==null||e.destroy(),this._set("contentElementViewModel",null),this._set("contentElement",null)}get spatialReference(){var e;return((e=this.view)==null?void 0:e.spatialReference)??null}set spatialReference(e){this._override("spatialReference",e)}get state(){const{_abortController:e,contentElement:t,contentElementViewModel:s}=this;return e?"loading":t||s?"ready":"disabled"}get map(){var e;return((e=this.view)==null?void 0:e.map)??null}set map(e){this._override("map",e)}};a([c()],_e.prototype,"_abortController",void 0),a([c({type:Cl})],_e.prototype,"expressionInfo",void 0),a([c({type:Lt})],_e.prototype,"graphic",void 0),a([c({readOnly:!0})],_e.prototype,"contentElement",void 0),a([c({readOnly:!0})],_e.prototype,"contentElementViewModel",void 0),a([c()],_e.prototype,"interceptor",void 0),a([c()],_e.prototype,"spatialReference",null),a([c({readOnly:!0})],_e.prototype,"state",null),a([c()],_e.prototype,"map",null),a([c()],_e.prototype,"view",void 0),_e=a([I("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],_e);const Nn=_e,Bi={iconLoading:"esri-icon-loading-indicator esri-rotating",base:"esri-feature-expression",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"};let Ki=class extends le{constructor(e,t){super(e,t),this._contentWidget=null,this.viewModel=new Nn}initialize(){this.addHandles(y(()=>{var e;return(e=this.viewModel)==null?void 0:e.contentElementViewModel},()=>this._setupExpressionWidget(),O))}destroy(){this._destroyContentWidget()}renderLoading(){return m("div",{key:"loading-container",class:Bi.loadingSpinnerContainer},m("span",{class:this.classes(Bi.iconLoading,Bi.spinner)}))}render(){var t;const{state:e}=this.viewModel;return m("div",{class:Bi.base},e==="loading"?this.renderLoading():e==="disabled"?null:(t=this._contentWidget)==null?void 0:t.render())}_destroyContentWidget(){const{_contentWidget:e}=this;e&&(e.viewModel=null,e.destroy()),this._contentWidget=null}_setupExpressionWidget(){const{contentElementViewModel:e,contentElement:t}=this.viewModel,s=t==null?void 0:t.type;this._destroyContentWidget();const n=e?s==="fields"?new aa({viewModel:e}):s==="media"?new la({viewModel:e}):s==="text"?new Wi({viewModel:e}):null:null;this._contentWidget=n,this.scheduleRender()}};a([c({type:Nn})],Ki.prototype,"viewModel",void 0),Ki=a([I("esri.widgets.Feature.FeatureExpression")],Ki);const Xd=Ki,qs=100;let z=class extends Tl(Er(ms(D))){constructor(e){super(e),this._queryAbortController=null,this._queryPageAbortController=null,this._queryFeatureCountAbortController=null,this.featuresPerPage=10,this.description=null,this.graphic=null,this.layer=null,this.map=null,this.orderByFields=null,this.featureCount=0,this.relationshipId=null,this.showAllEnabled=!1,this.title=null,this._cancelQuery=()=>{const{_queryAbortController:t}=this;t&&t.abort(),this._queryAbortController=null},this._cancelQueryFeatureCount=()=>{const{_queryFeatureCountAbortController:t}=this;t&&t.abort(),this._queryFeatureCountAbortController=null},this._cancelQueryPage=()=>{const{_queryPageAbortController:t}=this;t&&t.abort(),this._queryPageAbortController=null},this._queryController=async()=>{this._cancelQuery();const t=new AbortController;this._queryAbortController=t,await Ti(this._query()),this._queryAbortController===t&&(this._queryAbortController=null)},this._queryFeatureCountController=async()=>{this._cancelQueryFeatureCount();const t=new AbortController;this._queryFeatureCountAbortController=t,await Ti(this._queryFeatureCount()),this._queryFeatureCountAbortController===t&&(this._queryFeatureCountAbortController=null)},this._queryPageController=async()=>{const t=new AbortController;this._queryPageAbortController=t,await Ti(this._queryPage()),this._queryPageAbortController===t&&(this._queryPageAbortController=null)},this._queryThrottled=ii(this._queryController,qs,this),this._queryFeatureCountThrottled=ii(this._queryFeatureCountController,qs,this),this._queryPageThrottled=ii(this._queryPageController,qs,this),this._query=async()=>{const{_queryAbortController:t,relatedFeatures:s}=this;this._destroyRelatedFeatureViewModels(),this.featurePage=1,s.removeAll(),s.addMany(this._sliceFeatures(await this._queryRelatedFeatures({signal:t==null?void 0:t.signal})))},this.handles.add([y(()=>[this.displayCount,this.graphic,this.layer,this.map,this.orderByFieldsFixedCasing,this.relationshipId,this.featuresPerPage,this.showAllEnabled,this.canQuery,this.featureCount],()=>this._queryThrottled(),O),y(()=>[this.featurePage,this.showAllEnabled],()=>this._queryPageThrottled()),y(()=>[this.layer,this.relationshipId,this.objectId,this.canQuery],()=>this._queryFeatureCountThrottled())])}destroy(){this._destroyRelatedFeatureViewModels(),this.relatedFeatures.removeAll(),this._cancelQuery(),this._cancelQueryFeatureCount(),this._cancelQueryPage()}set featurePage(e){const{featuresPerPage:t,featureCount:s}=this,n=1,o=Math.ceil(s/t)||1;this._set("featurePage",Math.min(Math.max(e,n),o))}get featurePage(){return this._get("featurePage")}get orderByFieldsFixedCasing(){const{orderByFields:e,relatedLayer:t}=this;return e&&(t!=null&&t.loaded)?e.map(s=>{const n=s.clone(),o=Ai(s.field,t);return n.field=o,n}):e??[]}get supportsCacheHint(){var e,t,s;return!!((s=(t=(e=this.layer)==null?void 0:e.capabilities)==null?void 0:t.queryRelated)!=null&&s.supportsCacheHint)}get canQuery(){var t,s;const e=(s=(t=this.layer)==null?void 0:t.capabilities)==null?void 0:s.queryRelated;return!!(this.relatedLayer&&this.relationship&&typeof this.relationshipId=="number"&&typeof this.objectId=="number"&&(e!=null&&e.supportsCount)&&(e!=null&&e.supportsPagination))}get itemDescriptionFieldName(){var e,t;return((t=(e=this.orderByFieldsFixedCasing)==null?void 0:e[0])==null?void 0:t.field)||null}set displayCount(e){this._set("displayCount",Math.min(Math.max(e,0),10))}get displayCount(){return this._get("displayCount")}get objectId(){var e,t;return(this.objectIdField&&((t=(e=this.graphic)==null?void 0:e.attributes)==null?void 0:t[this.objectIdField]))??null}get objectIdField(){var e;return((e=this.layer)==null?void 0:e.objectIdField)||null}get relatedFeatures(){return this._get("relatedFeatures")||new W}get relatedLayer(){const{layer:e,map:t,relationship:s}=this;return e!=null&&e.loaded&&t&&s?pd(t,e,s)??null:null}get relationship(){var s;const{relationshipId:e,layer:t}=this;return typeof e=="number"?((s=t==null?void 0:t.relationships)==null?void 0:s.find(({id:n})=>n===e))??null:null}get relatedFeatureViewModels(){return this._get("relatedFeatureViewModels")||new W}get state(){const{_queryAbortController:e,_queryFeatureCountAbortController:t,_queryPageAbortController:s,canQuery:n}=this;return t?"loading":e||s?"querying":n?"ready":"disabled"}_destroyRelatedFeatureViewModels(){var e;(e=this.relatedFeatureViewModels)==null||e.forEach(t=>!t.destroyed&&t.destroy()),this.relatedFeatureViewModels.removeAll()}async _queryFeatureCount(){const{layer:e,relatedLayer:t,relationshipId:s,objectId:n,_queryFeatureCountAbortController:o,canQuery:r,supportsCacheHint:l}=this;if(await(e==null?void 0:e.load()),await(t==null?void 0:t.load()),!r||!e||!t)return void this._set("featureCount",0);const d=t.createQuery(),h=new nn({cacheHint:l,relationshipId:s,returnGeometry:!1,objectIds:[n],where:Xn(d.where,void 0)}),u=await e.queryRelatedFeaturesCount(h,{signal:o==null?void 0:o.signal});this._set("featureCount",u[n]||0)}_sliceFeatures(e){const{showAllEnabled:t,displayCount:s}=this;return t?e:s?e.slice(0,s):[]}async _queryPage(){const{relatedFeatures:e,featurePage:t,showAllEnabled:s,_queryPageAbortController:n}=this;!s||t<2||e.addMany(await this._queryRelatedFeatures({signal:n==null?void 0:n.signal}))}async _queryRelatedFeatures(e){var te;const{orderByFieldsFixedCasing:t,showAllEnabled:s,featuresPerPage:n,displayCount:o,layer:r,relationshipId:l,featurePage:d,featureCount:h,relatedLayer:u,supportsCacheHint:p}=this,{canQuery:g,objectId:f}=this;if(!g||!r||!u)return[];const b=s?((d-1)*n+h)%h:0,C=s?n:o,P=u.objectIdField,A=[...t==null?void 0:t.map(q=>q.field),P].filter(M),N=t==null?void 0:t.map(q=>`${q.field} ${q.order}`),L=u.createQuery(),H=new nn({orderByFields:N,start:b,num:C,outFields:A,cacheHint:p,relationshipId:l,returnGeometry:!1,objectIds:[f],where:Xn(L.where,void 0)}),Y=((te=(await r.queryRelatedFeatures(H,{signal:e==null?void 0:e.signal}))[f])==null?void 0:te.features)||[];return Y.forEach(q=>{q.sourceLayer=u,q.layer=u}),Y}};a([c()],z.prototype,"_queryAbortController",void 0),a([c()],z.prototype,"_queryPageAbortController",void 0),a([c()],z.prototype,"_queryFeatureCountAbortController",void 0),a([c({value:1})],z.prototype,"featurePage",null),a([c()],z.prototype,"featuresPerPage",void 0),a([c({readOnly:!0})],z.prototype,"orderByFieldsFixedCasing",null),a([c({readOnly:!0})],z.prototype,"supportsCacheHint",null),a([c({readOnly:!0})],z.prototype,"canQuery",null),a([c()],z.prototype,"description",void 0),a([c({readOnly:!0})],z.prototype,"itemDescriptionFieldName",null),a([c({value:3})],z.prototype,"displayCount",null),a([c({type:Lt})],z.prototype,"graphic",void 0),a([c()],z.prototype,"layer",void 0),a([c()],z.prototype,"map",void 0),a([c({readOnly:!0})],z.prototype,"objectId",null),a([c({readOnly:!0})],z.prototype,"objectIdField",null),a([c()],z.prototype,"orderByFields",void 0),a([c({readOnly:!0})],z.prototype,"relatedFeatures",null),a([c({readOnly:!0})],z.prototype,"relatedLayer",null),a([c({readOnly:!0})],z.prototype,"relationship",null),a([c()],z.prototype,"featureCount",void 0),a([c({readOnly:!0})],z.prototype,"relatedFeatureViewModels",null),a([c()],z.prototype,"relationshipId",void 0),a([c()],z.prototype,"showAllEnabled",void 0),a([c()],z.prototype,"state",null),a([c()],z.prototype,"title",void 0),z=a([I("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],z);const zn=z,vi="esri-feature",Us=`${vi}-relationship`,Ne={base:Us,esriWidget:"esri-widget",listContainer:`${Us}__list`,listContainerQuerying:`${Us}__list--querying`,featureObserver:`${vi}__feature-observer`,stickySpinnerContainer:`${vi}__sticky-loading-container`,loadingSpinnerContainer:`${vi}__loading-container`,spinner:`${vi}__loading-spinner`,iconLoading:"esri-icon-loading-indicator esri-rotating"},So={title:!0,description:!0};let he=class extends le{constructor(e,t){super(e,t),this._featureElementInfo=null,this._relatedFeatureIntersectionObserverNode=null,this._relatedFeatureIntersectionObserver=new IntersectionObserver(([s])=>{s!=null&&s.isIntersecting&&this._increaseFeaturePage()},{root:window.document}),this.headingLevel=2,this.viewModel=new zn,this.messages=null,this.messagesCommon=null,this.visibleElements={...So},this._increaseFeaturePage=()=>{const{state:s,showAllEnabled:n,relatedFeatures:o,featuresPerPage:r,featurePage:l}=this.viewModel;s==="ready"&&n&&o.length>=r*l&&this.viewModel.featurePage++}}initialize(){this._featureElementInfo=new bs,this.addHandles([y(()=>[this.viewModel.description,this.viewModel.title,this.headingLevel],()=>this._setupFeatureElementInfo(),O),y(()=>[this.viewModel.state,this.viewModel.showAllEnabled,this._relatedFeatureIntersectionObserverNode],()=>this._handleRelatedFeatureObserverChange()),xe(()=>this.viewModel.relatedFeatureViewModels,"change",()=>this._setupRelatedFeatureViewModels())])}loadDependencies(){return Promise.all([w(()=>import("./calcite-list-b83d6f5e.js"),["assets/calcite-list-b83d6f5e.js","assets/widget-7352089c.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/uuid-73213768.js","assets/interactive-573cbe88.js","assets/observers-4f67f1fb.js","assets/utils3-1ce076c1.js","assets/loadable-25ad9e4e.js","assets/debounce-31e0cfcc.js","assets/t9n-5ae2ba76.js","assets/icon-5450785a.js","assets/loader-5ac824ac.js","assets/guid-9426053f.js","assets/scrim-f0f62705.js"]),w(()=>import("./calcite-list-item-77d775c2.js"),["assets/calcite-list-item-77d775c2.js","assets/widget-7352089c.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/uuid-73213768.js","assets/interactive-573cbe88.js","assets/utils3-1ce076c1.js","assets/loadable-25ad9e4e.js","assets/icon-5450785a.js","assets/observers-4f67f1fb.js"]),w(()=>import("./calcite-icon-51eb6857.js"),["assets/calcite-icon-51eb6857.js","assets/icon-5450785a.js","assets/widget-7352089c.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/uuid-73213768.js","assets/observers-4f67f1fb.js"]),w(()=>import("./calcite-notice-b65ade1f.js"),["assets/calcite-notice-b65ade1f.js","assets/widget-7352089c.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/uuid-73213768.js","assets/observers-4f67f1fb.js","assets/loadable-25ad9e4e.js","assets/t9n-5ae2ba76.js","assets/icon-5450785a.js"])])}destroy(){this._unobserveRelatedFeatureObserver(),this._featureElementInfo=re(this._featureElementInfo)}get displayShowAllButton(){const{showAllEnabled:e,featureCount:t,displayCount:s}=this.viewModel;return!e&&!!t&&(t>s||s===0)}get displayListItems(){return this.displayShowAllButton||this.viewModel.relatedFeatureViewModels.length>0}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get featureCountDescription(){const{messages:e}=this,{featureCount:t}=this.viewModel;return Le(t===1?e==null?void 0:e.numberRecord:e==null?void 0:e.numberRecords,{number:t})}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}castVisibleElements(e){return{...So,...e}}renderStickyLoading(){return this.viewModel.state==="querying"?m("div",{key:"sticky-loader",class:Ne.stickySpinnerContainer},this.renderLoadingIcon()):null}renderLoadingIcon(){return m("span",{class:this.classes(Ne.iconLoading,Ne.spinner)})}renderLoading(){return m("div",{key:"loading-container",class:Ne.loadingSpinnerContainer},this.renderLoadingIcon())}renderShowAllIconNode(){return m("calcite-icon",{scale:"s",icon:"list",slot:"content-end"})}renderChevronIconNode(){const e=De(this.container)?"chevron-left":"chevron-right";return m("calcite-icon",{scale:"s",icon:e,slot:"content-end"})}renderRelatedFeature(e){var o,r;const{itemDescriptionFieldName:t}=this.viewModel,s=e.title;e.description=t&&((o=e.formattedAttributes)==null?void 0:o.global[t]);const n=e.state==="loading";return m("calcite-list-item",{key:e.uid,label:n?`${(r=this.messagesCommon)==null?void 0:r.loading}…`:s,description:n?"…":e.description??"",onCalciteListItemSelect:()=>this.emit("select-record",{featureViewModel:e})},this.renderChevronIconNode())}renderShowAllListItem(){var e;return this.displayShowAllButton?m("calcite-list-item",{key:"show-all-item",label:(e=this.messages)==null?void 0:e.showAll,description:this.featureCountDescription,onCalciteListItemSelect:()=>this.emit("show-all-records")},this.renderShowAllIconNode()):null}renderNoRelatedFeaturesMessage(){var e;return m("calcite-notice",{key:"no-related-features-message",icon:"information",open:!0,kind:"brand",scale:"s",width:"full"},m("div",{slot:"message"},(e=this.messages)==null?void 0:e.noRelatedFeatures))}renderFeatureObserver(){return m("div",{key:"feature-observer",class:Ne.featureObserver,bind:this,afterCreate:this._relatedFeatureIntersectionObserverCreated})}renderList(){const{relatedFeatureViewModels:e}=this.viewModel;return m("calcite-list",null,e.toArray().map(t=>this.renderRelatedFeature(t)),this.renderShowAllListItem())}renderRelatedFeatures(){const{displayListItems:e}=this,{state:t}=this.viewModel;return m("div",{key:"list-container",class:this.classes(Ne.listContainer,{[Ne.listContainerQuerying]:t==="querying"})},e?this.renderList():t==="ready"?this.renderNoRelatedFeaturesMessage():null,this.renderStickyLoading(),this.renderFeatureObserver())}renderRelationshipNotFound(){var e;return m("calcite-notice",{key:"relationship-not-found",icon:"exclamation-mark-triangle",open:!0,kind:"danger",scale:"s",width:"full"},m("div",{slot:"message"},(e=this.messages)==null?void 0:e.relationshipNotFound))}render(){var t;const{state:e}=this.viewModel;return m("div",{class:this.classes(Ne.base,Ne.esriWidget)},(t=this._featureElementInfo)==null?void 0:t.render(),e==="loading"?this.renderLoading():e==="disabled"?this.renderRelationshipNotFound():this.renderRelatedFeatures())}_setupRelatedFeatureViewModels(){const{relatedFeatureViewModels:e}=this.viewModel,t="related-feature-viewmodels";this.removeHandles(t),e==null||e.forEach(s=>{this.addHandles(y(()=>[s.title,s.state],()=>this.scheduleRender(),O),t)}),this.scheduleRender()}_setupFeatureElementInfo(){var o;const{headingLevel:e,visibleElements:t}=this,s=t.description&&this.description,n=t.title&&this.title;(o=this._featureElementInfo)==null||o.set({description:s,title:n,headingLevel:e})}async _handleRelatedFeatureObserverChange(){this._unobserveRelatedFeatureObserver();const{state:e,showAllEnabled:t}=this.viewModel;await Tn(0),this._relatedFeatureIntersectionObserverNode&&e==="ready"&&t&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode)}_relatedFeatureIntersectionObserverCreated(e){this._relatedFeatureIntersectionObserverNode=e}_unobserveRelatedFeatureObserver(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}};a([c()],he.prototype,"_relatedFeatureIntersectionObserverNode",void 0),a([c({readOnly:!0})],he.prototype,"displayShowAllButton",null),a([c({readOnly:!0})],he.prototype,"displayListItems",null),a([c()],he.prototype,"description",null),a([c({readOnly:!0})],he.prototype,"featureCountDescription",null),a([c()],he.prototype,"headingLevel",void 0),a([c()],he.prototype,"title",null),a([c({type:zn})],he.prototype,"viewModel",void 0),a([c(),ae("esri/widgets/Feature/t9n/Feature")],he.prototype,"messages",void 0),a([c(),ae("esri/t9n/common")],he.prototype,"messagesCommon",void 0),a([c()],he.prototype,"visibleElements",void 0),a([Xe("visibleElements")],he.prototype,"castVisibleElements",null),he=a([I("esri.widgets.Feature.FeatureRelationship")],he);const Do=he;let Jd=class{constructor(e,t){this.preLayerQueryCallback=e,this.preRequestCallback=t,this.preLayerQueryCallback||(this.preLayerQueryCallback=s=>{}),this.preRequestCallback||(this.preLayerQueryCallback=s=>{})}};var wi;const eh=1,Oo="content-view-models",Vo="relationship-view-models",No={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0,relationshipContent:!0};let U=wi=class extends Er(D){constructor(i){super(i),this._handles=new gt,this._error=null,this._featureAbortController=null,this._graphicChangedThrottled=ii(this._graphicChanged,eh,this),this._expressionAttributes=null,this._graphicExpressionAttributes=null,this.abilities={...No},this.content=null,this.contentViewModels=[],this.description=null,this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.relatedInfos=new Map,this.title="",this.view=null,this._isAllowedContentType=e=>{const{abilities:t}=this;return e.type==="attachments"&&!!t.attachmentsContent||e.type==="custom"&&!!t.customContent||e.type==="fields"&&!!t.fieldsContent||e.type==="media"&&!!t.mediaContent||e.type==="text"&&!!t.textContent||e.type==="expression"&&!!t.expressionContent||e.type==="relationship"&&!!t.relationshipContent},this._handles.add(y(()=>[this.graphic,this._effectivePopupTemplate,this.abilities],()=>this._graphicChangedThrottled(),O))}destroy(){this._clear(),this._cancelFeatureQuery(),this._error=null,this._handles.destroy(),this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}get _effectivePopupTemplate(){return M(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return rd(Mo(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return Xr(this.graphic)}castAbilities(i){return{...No,...i}}get isTable(){var i;return((i=this._sourceLayer)==null?void 0:i.isTable)||!1}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}set graphic(i){this._set("graphic",i?i.clone():null)}get spatialReference(){var i;return((i=this.view)==null?void 0:i.spatialReference)??null}set spatialReference(i){this._override("spatialReference",i)}get map(){var i;return((i=this.view)==null?void 0:i.map)||null}set map(i){this._override("map",i)}get waitingForContent(){return!!this._featureAbortController}setActiveMedia(i,e){const t=this.contentViewModels[i];t instanceof Pt&&t.setActiveMedia(e)}nextMedia(i){const e=this.contentViewModels[i];e instanceof Pt&&e.next()}previousMedia(i){const e=this.contentViewModels[i];e instanceof Pt&&e.previous()}async updateGeometry(){var r,l;const{graphic:i,spatialReference:e,_sourceLayer:t}=this;await(t==null?void 0:t.load());const s=t==null?void 0:t.objectIdField;if(!s||!i||!t)return;const n=(r=i==null?void 0:i.attributes)==null?void 0:r[s];if(n==null)return;const o=[n];if(!i.geometry){const d=(l=await na({layer:t,graphic:i,outFields:[],objectIds:o,returnGeometry:!0,spatialReference:e}))==null?void 0:l.geometry;d&&(i.geometry=d)}}_clear(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}async _graphicChanged(){this._cancelFeatureQuery(),this._error=null,this._clear();const{graphic:i}=this;if(!i)return;const e=new AbortController;this._featureAbortController=e;try{await this._queryFeature({signal:e.signal})}catch(t){kr(t)||(this._error=t,V.getLogger(this.declaredClass).error("error","The popupTemplate could not be displayed for this feature.",{error:t,graphic:i,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===e&&(this._featureAbortController=null)}_cancelFeatureQuery(){const{_featureAbortController:i}=this;i&&i.abort(),this._featureAbortController=null}_compileContentElement(i,e){return i.type==="attachments"?this._compileAttachments(i,e):i.type==="custom"?this._compileCustom(i,e):i.type==="fields"?this._compileFields(i,e):i.type==="media"?this._compileMedia(i,e):i.type==="text"?this._compileText(i,e):i.type==="expression"?this._compileExpression(i,e):i.type==="relationship"?this._compileRelationship(i,e):void 0}_compileContent(i){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(i)?i.filter(this._isAllowedContentType).map((e,t)=>this._compileContentElement(e,t)).filter(M):typeof i=="string"?this._compileText(new xr({text:i}),0).text:i}_destroyContentViewModels(){var i,e;(i=this._handles)==null||i.remove(Vo),(e=this._handles)==null||e.remove(Oo),this.contentViewModels.forEach(t=>t&&!t.destroyed&&t.destroy()),this._set("contentViewModels",[])}_matchesFeature(i,e){var n;const t=(n=i==null?void 0:i.graphic)==null?void 0:n.getObjectId(),s=e==null?void 0:e.getObjectId();return M(t)&&M(s)&&t===s}_setRelatedFeaturesViewModels({relatedFeatureViewModels:i,relatedFeatures:e,map:t}){const{view:s,spatialReference:n}=this;e==null||e.filter(Boolean).forEach(o=>{i.find(r=>this._matchesFeature(r,o))||i.add(new wi({abilities:{relationshipContent:!1},map:t,view:s,spatialReference:n,graphic:o}))}),i.forEach(o=>{(e==null?void 0:e.find(l=>this._matchesFeature(o,l)))||i.remove(o)})}_setExpressionContentVM(i,e){const t=this.formattedAttributes,{contentElement:s,contentElementViewModel:n}=i,o=s==null?void 0:s.type;n&&o&&(o==="fields"&&(this._createFieldsFormattedAttributes({contentElement:s,contentElementIndex:e,formattedAttributes:t}),n.set(this._createFieldsVMParams(s,e))),o==="media"&&(this._createMediaFormattedAttributes({contentElement:s,contentElementIndex:e,formattedAttributes:t}),n.set(this._createMediaVMParams(s,e))),o==="text"&&n.set(this._createTextVMParams(s)))}_compileRelationship(i,e){const{displayCount:t,orderByFields:s,relationshipId:n,title:o,description:r}=i,{_sourceLayer:l,graphic:d,map:h}=this,u=new zn({displayCount:t,graphic:d,orderByFields:s,relationshipId:n,layer:l,map:h,...this._compileTitleAndDesc({title:o,description:r})});return this.contentViewModels[e]=u,this._handles.add(xe(()=>u.relatedFeatures,"change",()=>this._setRelatedFeaturesViewModels(u)),Vo),i}_compileExpression(i,e){const{expressionInfo:t}=i,{graphic:s,map:n,spatialReference:o,view:r}=this,l=new Nn({expressionInfo:t,graphic:s,interceptor:wi.interceptor,map:n,spatialReference:o,view:r});return this.contentViewModels[e]=l,this._handles.add(y(()=>l.contentElementViewModel,()=>this._setExpressionContentVM(l,e),O),Oo),i}_compileAttachments(i,e){const{graphic:t}=this,{description:s,title:n}=i;return this.contentViewModels[e]=new On({graphic:t,...this._compileTitleAndDesc({title:n,description:s})}),i}_compileCustom(i,e){const{graphic:t}=this,{creator:s,destroyer:n}=i;return this.contentViewModels[e]=new hs({graphic:t,creator:s,destroyer:n}),i}_compileTitleAndDesc({title:i,description:e}){const{_fieldInfoMap:t,_sourceLayer:s,graphic:n,formattedAttributes:o}=this,r=n==null?void 0:n.attributes,l=this._expressionAttributes,d=o.global;return{title:$t({attributes:r,fieldInfoMap:t,globalAttributes:d,expressionAttributes:l,layer:s,text:i}),description:$t({attributes:r,fieldInfoMap:t,globalAttributes:d,expressionAttributes:l,layer:s,text:e})}}_createFieldsVMParams(i,e){var h;const t=this._effectivePopupTemplate,s=this.formattedAttributes,n={...s==null?void 0:s.global,...s==null?void 0:s.content[e]},o=(h=(i==null?void 0:i.fieldInfos)||(t==null?void 0:t.fieldInfos))==null?void 0:h.filter(({fieldName:u})=>Rn(u)||Ke(u)||n.hasOwnProperty(u)),r=t==null?void 0:t.expressionInfos,{description:l,title:d}=i;return{attributes:n,expressionInfos:r,fieldInfos:o,...this._compileTitleAndDesc({title:d,description:l})}}_compileFields(i,e){const t=i.clone(),s=new Ms(this._createFieldsVMParams(i,e));return this.contentViewModels[e]=s,t.fieldInfos=s.formattedFieldInfos.slice(0),t}_createMediaVMParams(i,e){const{abilities:t,graphic:s,_fieldInfoMap:n,_effectivePopupTemplate:o,relatedInfos:r,_sourceLayer:l,_expressionAttributes:d}=this,h=this.formattedAttributes,u=(s==null?void 0:s.attributes)??{},{description:p,mediaInfos:g,title:f}=i;return{abilities:{chartAnimation:t.chartAnimation},activeMediaInfoIndex:i.activeMediaInfoIndex||0,attributes:u,isAggregate:s==null?void 0:s.isAggregate,layer:l,fieldInfoMap:n,formattedAttributes:{...h==null?void 0:h.global,...h==null?void 0:h.content[e]},expressionAttributes:d,mediaInfos:g,popupTemplate:o,relatedInfos:r,...this._compileTitleAndDesc({title:f,description:p})}}_compileMedia(i,e){const t=i.clone(),s=new Pt(this._createMediaVMParams(i,e));return t.mediaInfos=s.formattedMediaInfos.slice(0),this.contentViewModels[e]=s,t}_createTextVMParams(i){var o;const{graphic:e,_fieldInfoMap:t,_sourceLayer:s,_expressionAttributes:n}=this;if(i&&i.text){const r=(e==null?void 0:e.attributes)??{},l=((o=this.formattedAttributes)==null?void 0:o.global)??{};i.text=$t({attributes:r,fieldInfoMap:t,globalAttributes:l,expressionAttributes:n,layer:s,text:i.text})}return{graphic:e,creator:i.text}}_compileText(i,e){const t=i.clone();return this.contentViewModels[e]=new hs(this._createTextVMParams(t)),t}_compileLastEditInfo(){const{_effectivePopupTemplate:i,_sourceLayer:e,graphic:t}=this;if(!i)return;const{lastEditInfoEnabled:s}=i,n=e==null?void 0:e.editFieldsInfo;return s&&n?od(n,t==null?void 0:t.attributes):void 0}_compileTitle(i){var l;const{_fieldInfoMap:e,_sourceLayer:t,graphic:s,_expressionAttributes:n}=this,o=(s==null?void 0:s.attributes)??{},r=((l=this.formattedAttributes)==null?void 0:l.global)??{};return $t({attributes:o,fieldInfoMap:e,globalAttributes:r,expressionAttributes:n,layer:t,text:i})}async _getTitle(){const{_effectivePopupTemplate:i,graphic:e}=this;if(!e)return null;const t=i==null?void 0:i.title;return ds(t,{graphic:e})}async _getContent(){const{_effectivePopupTemplate:i,graphic:e}=this;if(!e)return null;const t=i==null?void 0:i.content;return ds(t,{graphic:e})}async _queryFeature(i){const{_featureAbortController:e,_sourceLayer:t,graphic:s,_effectivePopupTemplate:n}=this,o=this.map,r=this.view,l=this.spatialReference;if(e!==this._featureAbortController||!s)return;await ld({graphic:s,popupTemplate:n,layer:t,spatialReference:l},i);const{content:{value:d},title:{value:h}}=await Rt({content:this._getContent(),title:this._getTitle()}),{expressionAttributes:{value:u}}=await Rt({checkForRelatedFeatures:this._checkForRelatedFeatures(i),expressionAttributes:Qd({expressionInfos:n==null?void 0:n.expressionInfos,spatialReference:l,graphic:s,map:o,interceptor:wi.interceptor,view:r})});e===this._featureAbortController&&s&&(this._expressionAttributes=u,this._graphicExpressionAttributes={...s.attributes,...u},this._set("formattedAttributes",this._createFormattedAttributes(d)),this._set("title",this._compileTitle(h)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(d)||null))}_createMediaFormattedAttributes({contentElement:i,contentElementIndex:e,formattedAttributes:t}){const{_effectivePopupTemplate:s,graphic:n,relatedInfos:o,_sourceLayer:r,_fieldInfoMap:l,_graphicExpressionAttributes:d}=this;t.content[e]=Rs({fieldInfos:s==null?void 0:s.fieldInfos,graphic:n,attributes:{...d,...i.attributes},layer:r,fieldInfoMap:l,relatedInfos:o})}_createFieldsFormattedAttributes({contentElement:i,contentElementIndex:e,formattedAttributes:t}){if(i.fieldInfos){const{graphic:s,relatedInfos:n,_sourceLayer:o,_fieldInfoMap:r,_graphicExpressionAttributes:l}=this;t.content[e]=Rs({fieldInfos:i.fieldInfos,graphic:s,attributes:{...l,...i.attributes},layer:o,fieldInfoMap:r,relatedInfos:n})}}_createFormattedAttributes(i){const{_effectivePopupTemplate:e,graphic:t,relatedInfos:s,_sourceLayer:n,_fieldInfoMap:o,_graphicExpressionAttributes:r}=this,l=e==null?void 0:e.fieldInfos,d={global:Rs({fieldInfos:l,graphic:t,attributes:r,layer:n,fieldInfoMap:o,relatedInfos:s}),content:[]};return Array.isArray(i)&&i.forEach((h,u)=>{h.type==="fields"&&this._createFieldsFormattedAttributes({contentElement:h,contentElementIndex:u,formattedAttributes:d}),h.type==="media"&&this._createMediaFormattedAttributes({contentElement:h,contentElementIndex:u,formattedAttributes:d})}),d}_checkForRelatedFeatures(i){const{graphic:e,_effectivePopupTemplate:t}=this;return this._queryRelatedInfos(e,Mo(t),i)}async _queryRelatedInfos(i,e,t){const{relatedInfos:s,_sourceLayer:n}=this;s.clear();const o=M(n==null?void 0:n.associatedLayer)?await(n==null?void 0:n.associatedLayer.load(t)):n;if(!o||!i)return;const r=e.filter(h=>h&&Ke(h.fieldName));if(!r||!r.length)return;e.forEach(h=>this._configureRelatedInfo(h,o));const l=await Ad({relatedInfos:s,layer:o},t);Object.keys(l).forEach(h=>{var g;const u=s.get(h.toString()),p=(g=l[h])==null?void 0:g.value;u&&p&&(u.layerInfo=p.data)});const d=await Fd({graphic:i,relatedInfos:s,layer:o},t);Object.keys(d).forEach(h=>{var u;xd((u=d[h])==null?void 0:u.value,s.get(h.toString()))})}_configureRelatedInfo(i,e){const{relatedInfos:t}=this,s=Zi(i.fieldName);if(!s)return;const{layerId:n,fieldName:o}=s;if(!n)return;const r=t.get(n.toString())||Td(n,e);r&&(Rd({relatedInfo:r,fieldName:o,fieldInfo:i}),this.relatedInfos.set(n,r))}};U.interceptor=new Jd(hd,ud),a([c()],U.prototype,"_error",void 0),a([c()],U.prototype,"_featureAbortController",void 0),a([c({readOnly:!0})],U.prototype,"_effectivePopupTemplate",null),a([c({readOnly:!0})],U.prototype,"_fieldInfoMap",null),a([c({readOnly:!0})],U.prototype,"_sourceLayer",null),a([c()],U.prototype,"abilities",void 0),a([Xe("abilities")],U.prototype,"castAbilities",null),a([c({readOnly:!0})],U.prototype,"content",void 0),a([c({readOnly:!0})],U.prototype,"contentViewModels",void 0),a([c()],U.prototype,"description",void 0),a([c({type:Boolean})],U.prototype,"defaultPopupTemplateEnabled",void 0),a([c({readOnly:!0})],U.prototype,"isTable",null),a([c({readOnly:!0})],U.prototype,"state",null),a([c({readOnly:!0})],U.prototype,"formattedAttributes",void 0),a([c({type:Lt,value:null})],U.prototype,"graphic",null),a([c({readOnly:!0})],U.prototype,"lastEditInfo",void 0),a([c({readOnly:!0})],U.prototype,"relatedInfos",void 0),a([c()],U.prototype,"spatialReference",null),a([c({readOnly:!0})],U.prototype,"title",void 0),a([c()],U.prototype,"map",null),a([c({readOnly:!0})],U.prototype,"waitingForContent",null),a([c()],U.prototype,"view",void 0),U=wi=a([I("esri.widgets.FeatureViewModel")],U);const Bn=U,ie="esri-feature",j={iconText:"esri-icon-font-fallback-text",iconLoading:"esri-icon-loading-indicator esri-rotating",esriTable:"esri-widget__table",esriWidget:"esri-widget",base:ie,container:`${ie}__size-container`,title:`${ie}__title`,main:`${ie}__main-container`,btn:`${ie}__button`,icon:`${ie}__icon`,content:`${ie}__content`,contentNode:`${ie}__content-node`,contentElement:`${ie}__content-element`,text:`${ie}__text`,lastEditedInfo:`${ie}__last-edited-info`,fields:`${ie}__fields`,fieldHeader:`${ie}__field-header`,fieldData:`${ie}__field-data`,fieldDataDate:`${ie}__field-data--date`,loadingSpinnerContainer:`${ie}__loading-container`,spinner:`${ie}__loading-spinner`},ha=i=>{let e=class extends i{constructor(){super(...arguments),this.renderNodeContent=t=>Br(t)&&!t.destroyed?m("div",{class:j.contentNode,key:t},t.render()):t instanceof HTMLElement?m("div",{class:j.contentNode,key:t,bind:t,afterCreate:this._attachToNode}):nc(t)?m("div",{class:j.contentNode,key:t,bind:t.domNode,afterCreate:this._attachToNode}):null}_attachToNode(t){const s=this;t.appendChild(s)}};return e=a([I("esri.widgets.Feature.ContentMixin")],e),e};var un;const zo={title:!0,content:!0,lastEditedInfo:!0},Bo="relationship-handles";let X=un=class extends ha(le){constructor(i,e){super(i,e),this._contentWidgets=[],this.flowItems=null,this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.messagesURIUtils=null,this.visibleElements={...zo},this.viewModel=new Bn}initialize(){this.addHandles(y(()=>{var i;return(i=this.viewModel)==null?void 0:i.contentViewModels},()=>this._setupContentWidgets(),O))}loadDependencies(){return w(()=>import("./calcite-notice-b65ade1f.js"),["assets/calcite-notice-b65ade1f.js","assets/widget-7352089c.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/uuid-73213768.js","assets/observers-4f67f1fb.js","assets/loadable-25ad9e4e.js","assets/t9n-5ae2ba76.js","assets/icon-5450785a.js"])}destroy(){this._destroyContentWidgets()}get graphic(){return this.viewModel.graphic}set graphic(i){this.viewModel.graphic=i}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(i){this.viewModel.defaultPopupTemplateEnabled=i}get isTable(){return this.viewModel.isTable}get label(){var i;return((i=this.messages)==null?void 0:i.widgetLabel)??""}set label(i){this._overrideIfSome("label",i)}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(i){this.viewModel.spatialReference=i}get title(){return this.viewModel.title}castVisibleElements(i){return{...zo,...i}}get map(){return this.viewModel.map}set map(i){this.viewModel.map=i}get view(){return this.viewModel.view}set view(i){this.viewModel.view=i}render(){const{state:i}=this.viewModel,e=m("div",{class:j.container,key:"container"},this.renderTitle(),i==="error"?this.renderError():i==="loading"?this.renderLoading():this.renderContentContainer());return m("div",{class:this.classes(j.base,j.esriWidget)},e)}setActiveMedia(i,e){return this.viewModel.setActiveMedia(i,e)}nextMedia(i){return this.viewModel.nextMedia(i)}previousMedia(i){return this.viewModel.previousMedia(i)}renderError(){const{messagesCommon:i,messages:e,visibleElements:t}=this;return m("calcite-notice",{open:!0,kind:"danger",icon:"exclamation-mark-circle",scale:"s"},t.title?m("div",{key:"error-title",slot:"title"},i.errorMessage):null,m("div",{key:"error-message",slot:"message"},e.loadingError))}renderLoading(){return m("div",{key:"loading-container",class:j.loadingSpinnerContainer},m("span",{class:this.classes(j.iconLoading,j.spinner)}))}renderContentContainer(){const{visibleElements:i}=this;return i.content?m("div",{class:j.main},[this.renderContent(),this.renderLastEditInfo()]):null}renderTitle(){const{visibleElements:i,title:e}=this;return i.title?m(An,{level:this.headingLevel,class:j.title,innerHTML:e}):null}renderContent(){const i=this.viewModel.content,e="content";if(!i)return null;if(Array.isArray(i))return i.length?m("div",{class:j.contentNode,key:`${e}-content-elements`},i.map(this.renderContentElement,this)):null;if(typeof i=="string"){const t=this._contentWidgets[0];return!t||t.destroyed?null:m("div",{class:j.contentNode,key:`${e}-content`},t.render())}return this.renderNodeContent(i)}renderContentElement(i,e){var s;const{visibleElements:t}=this;if(typeof t.content!="boolean"&&!((s=t.content)!=null&&s[i.type]))return null;switch(i.type){case"attachments":return this.renderAttachments(e);case"custom":return this.renderCustom(i,e);case"fields":return this.renderFields(e);case"media":return this.renderMedia(e);case"text":return this.renderText(i,e);case"expression":return this.renderExpression(e);case"relationship":return this.renderRelationship(e);default:return null}}renderAttachments(i){const e=this._contentWidgets[i];if(!e||e.destroyed)return null;const{state:t,attachmentInfos:s}=e.viewModel;return t==="loading"||s.length>0?m("div",{key:this._buildKey("attachments-element",i),class:this.classes(j.contentElement)},e.render()):null}renderRelationship(i){const e=this._contentWidgets[i];return e&&!e.destroyed&&this.flowItems?m("div",{key:this._buildKey("relationship-element",i),class:j.contentElement},e.render()):null}renderExpression(i){const e=this._contentWidgets[i];return!e||e.destroyed?null:m("div",{key:this._buildKey("expression-element",i),class:j.contentElement},e.render())}renderCustom(i,e){const{creator:t}=i,s=this._contentWidgets[e];return!s||s.destroyed?null:t?m("div",{key:this._buildKey("custom-element",e),class:j.contentElement},s.render()):null}renderFields(i){const e=this._contentWidgets[i];return!e||e.destroyed?null:m("div",{key:this._buildKey("fields-element",i),class:j.contentElement},e.render())}renderMedia(i){const e=this._contentWidgets[i];return!e||e.destroyed?null:m("div",{key:this._buildKey("media-element",i),class:j.contentElement},e.render())}renderLastEditInfo(){const{visibleElements:i,messages:e}=this,{lastEditInfo:t}=this.viewModel;if(!t||!i.lastEditedInfo)return null;const{date:s,user:n}=t,o=t.type==="edit"?n?e.lastEditedByUser:e.lastEdited:n?e.lastCreatedByUser:e.lastCreated,r=Le(o,{date:s,user:n});return m("div",{key:"edit-info-element",class:this.classes(j.lastEditedInfo,j.contentElement)},r)}renderText(i,e){const t=i.text,s=this._contentWidgets[e];return!s||s.destroyed?null:t?m("div",{key:this._buildKey("text-element",e),class:this.classes(j.contentElement,j.text)},s.render()):null}_buildKey(i,...e){return`${i}__${this.get("viewModel.graphic.uid")||"0"}-${e.join("-")}`}_destroyContentWidget(i){i&&(i.viewModel=null,!i.destroyed&&i.destroy())}_destroyContentWidgets(){this.removeHandles(Bo),this._contentWidgets.forEach(i=>this._destroyContentWidget(i)),this._contentWidgets=[]}_addFeatureRelationshipHandles(i){const{flowItems:e,visibleElements:t}=this;this.addHandles([xe(()=>i,"select-record",({featureViewModel:s})=>{e&&(s.abilities={relationshipContent:!0},e.push(new un({flowItems:e,viewModel:s,visibleElements:t})))}),xe(()=>i,"show-all-records",()=>{if(!e)return;const{viewModel:s}=i;s.showAllEnabled=!0;const n=new Do({visibleElements:{title:!1,description:!1},viewModel:s});this._addFeatureRelationshipHandles(n),e.push(n)})],Bo)}_setupContentWidgets(){this._destroyContentWidgets();const{headingLevel:i,visibleElements:e}=this,t=this.get("viewModel.content"),{contentViewModels:s}=this.viewModel;if(Array.isArray(t))t.forEach((n,o)=>{if(n.type==="attachments"&&(this._contentWidgets[o]=new _d({displayType:n.displayType,headingLevel:e.title?i+1:i,viewModel:s[o]})),n.type==="fields"&&(this._contentWidgets[o]=new aa({viewModel:s[o]})),n.type==="media"&&(this._contentWidgets[o]=new la({viewModel:s[o]})),n.type==="text"&&(this._contentWidgets[o]=new Wi({viewModel:s[o]})),n.type==="custom"&&(this._contentWidgets[o]=new Wi({viewModel:s[o]})),n.type==="expression"&&(this._contentWidgets[o]=new Xd({viewModel:s[o]})),n.type==="relationship"){const r=new Do({viewModel:s[o]});this._addFeatureRelationshipHandles(r),this._contentWidgets[o]=r}},this);else{const n=s[0];n&&!n.destroyed&&(this._contentWidgets[0]=new Wi({viewModel:n}))}this.scheduleRender()}};a([c()],X.prototype,"graphic",null),a([c()],X.prototype,"defaultPopupTemplateEnabled",null),a([c()],X.prototype,"flowItems",void 0),a([c()],X.prototype,"headingLevel",void 0),a([c({readOnly:!0})],X.prototype,"isTable",null),a([c()],X.prototype,"label",null),a([c(),ae("esri/widgets/Feature/t9n/Feature")],X.prototype,"messages",void 0),a([c(),ae("esri/t9n/common")],X.prototype,"messagesCommon",void 0),a([c(),ae("esri/widgets/support/t9n/uriUtils")],X.prototype,"messagesURIUtils",void 0),a([c()],X.prototype,"spatialReference",null),a([c({readOnly:!0})],X.prototype,"title",null),a([c()],X.prototype,"visibleElements",void 0),a([Xe("visibleElements")],X.prototype,"castVisibleElements",null),a([c()],X.prototype,"map",null),a([c()],X.prototype,"view",null),a([c({type:Bn})],X.prototype,"viewModel",void 0),X=un=a([I("esri.widgets.Feature")],X);const th=X;var ua;const Qi=Symbol("anchorHandles");let vt=class extends xn.EventedAccessor{constructor(e){super(e),this[ua]=new gt,this.location=null,this.screenLocationEnabled=!1,this.view=null,this[Qi].add([Qe(()=>_i(this.screenLocationEnabled?this.view:null,t=>[t.size,t.type==="3d"?t.camera:t.viewpoint]),()=>this.notifyChange("screenLocation")),y(()=>this.screenLocation,(t,s)=>{M(t)&&M(s)&&this.emit("view-change")})])}destroy(){this.view=null,this[Qi]=re(this[Qi])}get screenLocation(){var n;const{location:e,view:t,screenLocationEnabled:s}=this;return s&&M(e)&&M(t)&&t.ready?(n=t.toScreen)==null?void 0:n.call(t,e):null}};ua=Qi,a([c()],vt.prototype,"location",void 0),a([c()],vt.prototype,"screenLocation",null),a([c()],vt.prototype,"screenLocationEnabled",void 0),a([c()],vt.prototype,"view",void 0),vt=a([I("esri.widgets.support.AnchorElementViewModel")],vt);const pa=vt,ih="esri.widgets.CompassViewModel";let Yi=class extends pa{constructor(e){super(e),this.visible=!1}};a([c()],Yi.prototype,"visible",void 0),Yi=a([I(ih)],Yi);const ma=Yi,Hs="esri-spinner",js={base:Hs,spinnerStart:`${Hs}--start`,spinnerFinish:`${Hs}--finish`};let wt=class extends le{constructor(e,t){super(e,t),this._animationDelay=500,this._animationPromise=null,this.viewModel=new ma}initialize(){this.addHandles(y(()=>this.visible,e=>this._visibleChange(e)))}destroy(){this._animationPromise=null}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}show(e){const{location:t,promise:s}=e??{};t&&(this.viewModel.location=t),this.visible=!0;const n=()=>this.hide();s&&s.catch(()=>{}).then(n)}hide(){this.visible=!1}render(){const{visible:e}=this,{screenLocation:t}=this.viewModel,s=!!t,n=e&&s,o=!e&&s,r={[js.spinnerStart]:n,[js.spinnerFinish]:o},l=this._getPositionStyles();return m("div",{class:this.classes(js.base,r),styles:l})}_visibleChange(e){if(e)return void(this.viewModel.screenLocationEnabled=!0);const t=Tn(this._animationDelay);this._animationPromise=t,t.catch(()=>{}).then(()=>{this._animationPromise===t&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)})}_getPositionStyles(){const{screenLocation:e,view:t}=this.viewModel;if(F(t)||F(e))return{};const{padding:s}=t;return{left:e.x-s.left+"px",top:e.y-s.top+"px"}}};a([c()],wt.prototype,"location",null),a([c()],wt.prototype,"view",null),a([c({type:ma})],wt.prototype,"viewModel",void 0),a([c()],wt.prototype,"visible",null),wt=a([I("esri.widgets.Spinner")],wt);const sh=wt,Is={iconZoom:"esri-icon-zoom-in-magnifying-glass",iconTrash:"esri-icon-trash",iconBrowseClusteredFeatures:"esri-icon-table"},At=new Ri({id:"zoom-to-feature",title:"{messages.zoom}",className:Is.iconZoom}),qo=new Ri({id:"remove-selected-feature",title:"{messages.remove}",className:Is.iconTrash}),Xt=new Ri({id:"zoom-to-clustered-features",title:"{messages.zoom}",className:Is.iconZoom}),Jt=new Ri({id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:Is.iconBrowseClusteredFeatures}),nh="esri.widgets.Popup.PopupViewModel",us=V.getLogger(nh),oh=i=>{const{event:e,view:t}=i,{action:s}=e,n=t&&t.popup;if(!s)return Promise.reject(new k("trigger-action:missing-arguments","Event has no action"));if(!n)return Promise.reject(new k("trigger-action:missing-arguments","view.popup is missing"));const{disabled:o,id:r}=s;if(!r)return Promise.reject(new k("trigger-action:invalid-action","action.id is missing"));if(o)return Promise.reject(new k("trigger-action:invalid-action","Action is disabled"));if(r===At.id)return ah(n.viewModel).catch(xl);if(r===Xt.id)return lh(n.viewModel);if(r===Jt.id)return n.featureMenuOpen=!n.featureMenuOpen,n.viewModel.browseClusterEnabled=!n.viewModel.browseClusterEnabled,Promise.resolve();if(n.viewModel.browseClusterEnabled=!1,r===qo.id){n.close();const{selectedFeature:l}=n;if(!l)return Promise.reject(new k(`trigger-action:${qo.id}`,"selectedFeature is required",{selectedFeature:l}));const{sourceLayer:d}=l;return d?d.remove(l):t.graphics.remove(l),Promise.resolve()}return Promise.resolve()};function ga(i){const{selectedFeature:e,location:t,view:s}=i;return s?s.type==="3d"?e??t??null:i.get("selectedFeature.geometry")||t:null}function Et(i){var e,t;return!!i&&i.isAggregate&&((t=(e=i.sourceLayer)==null?void 0:e.featureReduction)==null?void 0:t.type)==="cluster"}async function rh(i,e){if((e==null?void 0:e.type)!=="3d"||!i||i.declaredClass!=="esri.Graphic")return!0;const t=e.getViewForGraphic(i);if(t&&"whenGraphicBounds"in t){let s;try{s=await t.whenGraphicBounds(i,{useViewElevation:!0})}catch{}return!s||!s.boundingBox||s.boundingBox[0]===s.boundingBox[3]&&s.boundingBox[1]===s.boundingBox[4]&&s.boundingBox[2]===s.boundingBox[5]}return!0}async function ah(i){var u;const{location:e,selectedFeature:t,view:s,zoomFactor:n}=i,o=ga(i);if(!s||!o){const p=new k("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:o,view:s});throw us.error(p),p}const r=s.scale/n,l=(u=i.selectedFeature)==null?void 0:u.geometry,d=l??e,h=M(d)&&d.type==="point"&&await rh(t,s);At.active=!0,At.disabled=!0;try{await i.zoomTo({target:{target:o,scale:h?r:void 0}})}catch{const g=new k("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:t});us.error(g)}finally{At.active=!1,At.disabled=!1,i.zoomToLocation=null,h&&(i.location=d)}}async function lh(i){const{selectedFeature:e,view:t}=i;if((t==null?void 0:t.type)!=="2d"){const r=new k("zoomToCluster:invalid-view","View must be 2d MapView.",{view:t});throw us.error(r),r}if(!e||!Et(e)){const r=new k("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:e});throw us.error(r),r}const[s,n]=await qn(t,e);Xt.active=!0,Xt.disabled=!0;const{extent:o}=await s.queryExtent(n);await i.zoomTo({target:o}),Xt.active=!1,Xt.disabled=!1}async function ch(i){const{view:e,selectedFeature:t}=i;if(!e||!t)return;const[s,n]=await qn(e,t),{extent:o}=await s.queryExtent(n);i.selectedClusterBoundaryFeature.geometry=o,e.graphics.add(i.selectedClusterBoundaryFeature)}async function dh(i){var r;const{selectedFeature:e,view:t}=i;if(!t||!e)return;const[s,n]=await qn(t,e);Jt.active=!0,Jt.disabled=!0;const{features:o}=await s.queryFeatures(n);Jt.active=!1,Jt.disabled=!1,(r=t.popup)==null||r.open({features:[e].concat(o),featureMenuOpen:!0})}async function qn(i,e){const t=await i.whenLayerView(e.sourceLayer),s=t.createQuery(),n=e.getObjectId();return s.aggregateIds=n!=null?[n]:[],[t,s]}function hh(i){const e=i.features.filter(t=>Et(t));e.length&&(i.features=e)}function fa(i){var e;if(F(i))return null;switch(i.type){case"point":return i;case"extent":return i.center;case"polygon":return i.centroid;case"multipoint":case"polyline":return(e=i.extent)==null?void 0:e.center;default:return null}}const x="esri-popup",hi=`${x}__header`,_t=`${x}--is-docked`,_={calciteThemeLight:"calcite-mode-light",calciteThemeDark:"calcite-mode-dark",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow",iconDockToTop:"esri-icon-maximize",iconDockToBottom:"esri-icon-dock-bottom",iconDockToLeft:"esri-icon-dock-left",iconDockToRight:"esri-icon-dock-right",iconClose:"esri-icon-close",iconUndock:"esri-icon-minimize",iconCheckMark:"esri-icon-check-mark",iconLoading:"esri-icon-loading-indicator",iconDefaultAction:"esri-icon-default-action",iconActionsMenu:"esri-icon-handle-horizontal",rotating:"esri-rotating",base:x,widget:"esri-widget",main:`${x}__main-container`,loadingContainer:`${x}__loading-container`,isCollapsible:`${x}--is-collapsible`,isCollapsed:`${x}--is-collapsed`,shadow:`${x}--shadow`,isDocked:_t,isDockedTopLeft:`${_t}-top-left`,isDockedTopCenter:`${_t}-top-center`,isDockedTopRight:`${_t}-top-right`,isDockedBottomLeft:`${_t}-bottom-left`,isDockedBottomCenter:`${_t}-bottom-center`,isDockedBottomRight:`${_t}-bottom-right`,alignTopCenter:`${x}--aligned-top-center`,alignBottomCenter:`${x}--aligned-bottom-center`,alignTopLeft:`${x}--aligned-top-left`,alignBottomLeft:`${x}--aligned-bottom-left`,alignTopRight:`${x}--aligned-top-right`,alignBottomRight:`${x}--aligned-bottom-right`,isFeatureMenuOpen:`${x}--feature-menu-open`,isActionsMenuOpen:`${x}--actions-menu-open`,hasFeatureUpdated:`${x}--feature-updated`,header:hi,headerButtons:`${hi}-buttons`,headerContainer:`${hi}-container`,headerContainerButton:`${hi}-container--button`,headerTitle:`${hi}-title`,content:`${x}__content`,contentHasFlows:"esri-content--has-flows",contentFlowItem:"esri-content__flow-item",footer:`${x}__footer`,footerHasPagination:`${x}__footer--has-pagination`,footerHasActions:`${x}__footer--has-actions`,footerHasActionsMenu:`${x}__footer--has-actions-menu`,button:`${x}__button`,buttonDisabled:`${x}__button--disabled`,buttonDock:`${x}__button--dock`,icon:`${x}__icon`,iconDock:`${x}__icon--dock-icon`,inlineActionsContainer:`${x}__inline-actions-container`,actionsMenuButton:`${x}__actions-menu-button`,actions:`${x}__actions`,action:`${x}__action`,actionImage:`${x}__action-image`,actionText:`${x}__action-text`,actionToggle:`${x}__action-toggle`,actionToggleOn:`${x}__action-toggle--on`,actionExit:`${x}__action--exit`,actionSelectFeature:`${x}__action--select-feature`,pointer:`${x}__pointer`,pointerDirection:`${x}__pointer-direction`,navigation:`${x}__navigation`,paginationPrevious:`${x}__pagination-previous`,paginationNext:`${x}__pagination-next`,paginationPreviousIconLTR:`${x}__pagination-previous-icon`,paginationPreviousIconRTL:`${x}__pagination-previous-icon--rtl`,paginationNextIconLTR:`${x}__pagination-next-icon`,paginationNextIconRTL:`${x}__pagination-next-icon--rtl`,featureMenu:`${x}__feature-menu`,featureMenuList:`${x}__feature-menu-list`,featureMenuItem:`${x}__feature-menu-item`,featureMenuViewport:`${x}__feature-menu-viewport`,featureMenuHeader:`${x}__feature-menu-header`,featureMenuNote:`${x}__feature-menu-note`,featureMenuSelected:`${x}__feature-menu-item--selected`,featureMenuButton:`${x}__feature-menu-button`,featureMenuTitle:`${x}__feature-menu-title`,featureMenuObserver:`${x}__feature-menu-observer`,featureMenuLoader:`${x}__feature-menu-loader`,collapseButton:`${x}__collapse-button`,collapseIcon:`${x}__collapse-icon`},uh="OBJECTID";let ph=class{constructor(e,t){this._owner=t,this._properties={},this._afterDispatchHandle=null;for(const s in e){const n=e[s],o=new El(n,void 0,void 0,2,2);this._properties[s]={pool:o,acquired:[]}}this._afterDispatchHandle=kl(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const t=this._properties[e];for(const s of t.acquired)Jn(s)||t.pool.release(s);t.pool.destroy(),t.pool=null,t.acquired=null}this._properties=null,this._owner=null}get(e){const t=this._owner._get(e),s=this._properties[e];let n=s.pool.acquire();for(s.acquired.push(n);n===t;)s.acquired.push(n),n=s.pool.acquire();return n}_release(){for(const e in this._properties){const t=this._properties[e];let s=0;for(const n of t.acquired)Jn(n)?t.acquired[s++]=n:t.pool.release(n);t.acquired.length=s}}};const mh=Se("mac")?"Meta":"Ctrl",Cs={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};for(let i=48;i<58;i++)Cs[i]=String.fromCharCode(i);for(let i=1;i<25;i++)Cs[111+i]=`F${i}`;for(let i=65;i<91;i++)Cs[i]=[String.fromCharCode(i+32),String.fromCharCode(i)];function gh(i){if(i.key!==void 0)return xt(i);const e=Cs[i.keyCode];return Array.isArray(e)?i.shiftKey?e[1]:e[0]:e}function fh(i){switch(i){case"Ctrl":case"Alt":case"Shift":case"Meta":case"Primary":return!0}return!1}let _h=class{constructor(e,t=[]){this.eventType=e,this.keyModifiers=t}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const t=e.modifiers;for(const s of this.keyModifiers)if(!t.has(s))return!1;return!0}};const Uo=V.getLogger("esri.views.input.InputHandler");let ee=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const t=this._incoming[e];for(const s of t)this._incomingEventMatches.push(s.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(e=>e.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager?Uo.error("This InputHandler has already been registered with an InputManager"):(e.setEventCallback(t=>this._handleEvent(t)),e.setUninstallCallback(()=>this._onUninstall()),this._manager=e)}onUninstall(){}registerIncoming(e,t,s){let n;typeof t=="function"?(s=t,n=[]):n=t||[];const o=typeof e=="string"?new _h(e,n):e,r=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},l=u=>{const p=this._incoming[u.match.eventType];if(p){const g=p.indexOf(u);p.splice(g,1),r(),this._manager&&this._manager.updateDependencies()}},d=new yh(o,s,{onPause:l,onRemove:l,onResume:u=>{const p=this._incoming[u.match.eventType];p&&!p.includes(u)&&(p.push(u),r(),this._manager&&this._manager.updateDependencies())}});let h=this._incoming[o.eventType];return h||(h=[],this._incoming[o.eventType]=h),h.push(d),r(),this._manager&&this._manager.updateDependencies(),d}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const t=new vh(e,{onEmit:(s,n,o,r)=>{var l;(l=this._manager)==null||l.emit(s.eventType,n,o,r)},onRemove:s=>{var n;delete this._outgoing[s.eventType],(n=this._manager)==null||n.updateDependencies()}});return this._outgoing[e]=t,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),t}startCapturingPointer(e){var t;(t=this._manager)==null||t.setPointerCapture(e,!0)}stopCapturingPointer(e){var t;(t=this._manager)==null||t.setPointerCapture(e,!1)}refreshHasPendingInputs(){var e;(e=this._manager)==null||e.refreshHasPendingInputs()}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):Uo.error("This InputHandler is not registered with an InputManager")}_handleEvent(e){var s;const t=this._incoming[e.type];if(t){for(const n of t)if(n.match.matches(e)&&((s=n.callback)==null||s.call(n,e),e.shouldStopPropagation()))break}}},yh=class{constructor(e,t,s){this.match=e,this._callback=t,this._handler=s}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},vh=class{constructor(e,t){this.eventType=e,this._removed=!1,this._handler=t}emit(e,t,s){this._removed||this._handler.onEmit(this,e,t,s)}remove(){this._removed=!0,this._handler.onRemove(this)}},wh=class extends ee{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",t=>{this._update(t.data)})}_update(e){const t=e.native.pointerType==="touch"?"touch":"mouse",{x:s,y:n}=e;t===this._value&&this._x===s&&this._y===n||(this._value=t,this._x=s,this._y=n,this._onChange(t,s,n))}},bh=class extends ee{get multiTouchActive(){return this._multiTouchActive.get()}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=new dc(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.set(this._activeTouchPointerIds.size>1)}},$e=class extends D{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=mh,this._latestPointerType="mouse",this._propertiesPool=new ph({latestPointerLocation:Ch},this),this.latestPointerLocation=null,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const t of e)this.uninstallHandlers(t);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(e=>e.handler.hasPendingInputs)}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}installHandlers(e,t,s=pt.INTERNAL){if(this._nameToGroup[e])return void V.getLogger(this.declaredClass).error("There is already an InputHandler group registered under the name `"+e+"`");if(t.length===0)return void V.getLogger(this.declaredClass).error("Can't register a group of zero handlers");const n={name:e,handlers:t.map(o=>({handler:o,active:!0,removed:!1,priorityIndex:0,groupPriority:s,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[e]=n;for(let o=n.handlers.length-1;o>=0;o--){const r=n.handlers[o];this._handlers.push(r),r.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(l,d,h,u,p)=>{this._emitInputEvent(r.priorityIndex+1,l,d,h,p,u)},setPointerCapture:(l,d)=>{this._setPointerCapture(n,r,l,d)},setEventCallback:l=>{r.eventCallback=l},setUninstallCallback:l=>{r.uninstallCallback=l},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const t=this._nameToGroup[e];t?(t.handlers.forEach(s=>{var n;s.removed=!0,(n=s.uninstallCallback)==null||n.call(s)}),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):V.getLogger(this.declaredClass).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,t=new Set;this._handlersPriority=[];for(let s=this._handlers.length-1;s>=0;s--){const n=this._handlers[s];n.priorityIndex=s,this._handlersPriority.push(n)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let s=this._handlersPriority.length-1;s>=0;s--){const n=this._handlersPriority[s];n.priorityIndex=s;let o=n.handler.hasSideEffects;if(!o){for(const r of n.handler.outgoingEventTypes)if(e.has(r)){o=!0;break}}if(o)for(const r of n.handler.incomingEventMatches){e.add(r.eventType);for(const l of r.keyModifiers)fh(l)||t.add(l)}n.active=o}this._sourceEvents=e,this._keyModifiers=t,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,t,s){this._latestPointerType=e;const n=this._get("latestPointerLocation");if(F(n)||n.x!==t||n.y!==s){const o=this._propertiesPool.get("latestPointerLocation");o.x=t,o.y=s,this._set("latestPointerLocation",o)}}_onEventReceived(e,t){if(e==="pointer-capture-lost"){const o=t;this._pointerCaptures.delete(o.native.pointerId)}this._updateKeyModifiers(e,t);const s=this.test.timestamp!=null?this.test.timestamp:t.native?t.native.timestamp:void 0,n=t.native?t.native.cancelable:void 0;this._emitInputEventFromSource(e,t,s,n)}_updateKeyModifiers(e,t){if(!t)return;let s=!1;const n=()=>{if(!s){const l=new Set;this._activeKeyModifiers.forEach(d=>{l.add(d)}),this._activeKeyModifiers=l,s=!0}},o=(l,d)=>{d&&!this._activeKeyModifiers.has(l)?(n(),this._activeKeyModifiers.add(l)):!d&&this._activeKeyModifiers.has(l)&&(n(),this._activeKeyModifiers.delete(l))};if(e==="key-down"||e==="key-up"){const l=t.key;this._keyModifiers.has(l)&&o(l,e==="key-down")}const r=t.native;o("Alt",!(!r||!r.altKey)),o("Ctrl",!(!r||!r.ctrlKey)),o("Shift",!(!r||!r.shiftKey)),o("Meta",!(!r||!r.metaKey)),o("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new wh((e,t,s)=>this._setLatestPointer(e,t,s)),this._multiTouchHandler=new bh,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],pt.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,pt.INTERNAL)}_setPointerCapture(e,t,s,n){const o=e.name+"-"+t.priorityIndex,r=this._pointerCaptures.get(s.pointerId)||new Set;this._pointerCaptures.set(s.pointerId,r),n?(r.add(o),r.size===1&&this.eventSource&&this.eventSource.setPointerCapture(s,!0)):r.has(o)&&(r.delete(o),r.size===0&&(this._pointerCaptures.delete(s.pointerId),this.eventSource&&this.eventSource.setPointerCapture(s,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(e=>!e.removed),this.updateDependencies()}_emitInputEventFromSource(e,t,s,n){this._emitInputEvent(0,e,t,s,n)}_emitInputEvent(e,t,s,n,o,r){const l=n!==void 0?n:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),d=o!==void 0&&o,h={event:new Mh(t,s,l,r||this._activeKeyModifiers,d),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(h):this._doNewPropagation(h)}_doNewPropagation(e){this._currentPropagation={events:new eo,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){var t,s;const e=$l(this._currentPropagation);for(;e.events.length>0;){const{event:n,priorityIndex:o}=e.events.pop(),r=n.data&&n.data.eventId;if(!(r!=null&&this._stoppedPropagationEventIds.has(r)))for(e.currentHandler=this._handlersPriority[o];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!n.shouldStopPropagation()&&((s=(t=e.currentHandler).eventCallback)==null||s.call(t,n)),n.shouldStopPropagation()){r!=null&&this._stoppedPropagationEventIds.add(r);break}if(n.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:n,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}_pausePropagation(e){const t=new eo;t.push(e);const s=this._currentPropagation;if(s){for(;s.events.length;)t.push(s.events.pop());s.events=t,s.currentHandler=null}}_compareHandlerPriority(e,t){if(e.handler.hasSideEffects!==t.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==t.groupPriority)return e.groupPriority>t.groupPriority?-1:1;for(const s of e.handler.incomingEventMatches)for(const n of t.handler.incomingEventMatches){if(s.eventType!==n.eventType)continue;const o=s.keyModifiers.filter(r=>n.keyModifiers.includes(r));if(o.length===s.keyModifiers.length!=(o.length===n.keyModifiers.length))return s.keyModifiers.length>n.keyModifiers.length?-1:1}return e.priorityIndex>t.priorityIndex?-1:1}_sortHandlersPriority(e){const t=[];for(const s of e){let n=0;for(;n<t.length&&this._compareHandlerPriority(s,t[n])>=0;)n++;t.splice(n,0,s)}return t}get debug(){const e=t=>{const s=this._setPointerCapture;this._setPointerCapture=()=>{},t(),this._setPointerCapture=s};return{injectEvent:(t,s)=>{e(()=>{this._onEventReceived(t,s)})},disablePointerCapture:e}}};a([c({readOnly:!0})],$e.prototype,"hasPendingInputs",null),a([c({constructOnly:!0})],$e.prototype,"eventSource",void 0),a([c({constructOnly:!0})],$e.prototype,"recognizers",void 0),a([c()],$e.prototype,"_latestPointerType",void 0),a([c()],$e.prototype,"latestPointerType",null),a([c()],$e.prototype,"multiTouchActive",null),a([c({readOnly:!0})],$e.prototype,"latestPointerLocation",void 0),$e=a([I("esri.views.input.InputManager")],$e);let Mh=class{constructor(e,t,s,n,o){this.type=e,this.data=t,this.timestamp=s,this.modifiers=n,this.cancelable=o,this._propagationState=ut.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=ut.STOPPED}shouldStopPropagation(){return(this._propagationState&ut.STOPPED)!=0}async(e){this._propagationState|=ut.PAUSED;const t=(s,n)=>{this._propagationState&=~ut.PAUSED;const o=this._resumeCallback;if(this._resumeCallback=null,o&&o(),n)throw s;return s};return(typeof e=="function"?e():e).then(s=>t(s,!1),s=>t(s,!0))}shouldPausePropagation(e){return!!(this._propagationState&ut.PAUSED)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};var ut;(function(i){i[i.NONE=0]="NONE",i[i.STOPPED=1]="STOPPED",i[i.PAUSED=2]="PAUSED"})(ut||(ut={}));const pt={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};let Ih=class{};const Ch=Ih,xi=W.ofType({key:"type",defaultKeyValue:"button",base:Pl,typeMap:{button:Ri,toggle:Al}}),Th=()=>[At.clone()],xh=()=>[Xt.clone(),Jt.clone()];let R=class extends Hr(pa){get isLoadingFeature(){return this.featureViewModels.some(e=>e.waitingForContent)}constructor(e){super(e),this._handles=new gt,this._pendingPromises=new Set,this._fetchFeaturesController=null,this._highlightSelectedFeaturePromise=null,this._highlightActiveFeaturePromise=null,this._selectedClusterFeature=null,this.featurePage=null,this.actions=new xi,this.activeFeature=null,this.defaultPopupTemplateEnabled=!1,this.autoCloseEnabled=!1,this.autoOpenEnabled=!0,this.browseClusterEnabled=!1,this.content=null,this.featuresPerPage=20,this.featureViewModelAbilities=null,this.featureViewModels=[],this.highlightEnabled=!0,this.includeDefaultActions=!0,this.selectedClusterBoundaryFeature=new Lt({symbol:new Fl({outline:{width:1.5,color:"cyan"},style:"none"})}),this.title=null,this.updateLocationEnabled=!1,this.view=null,this.visible=!1,this.zoomFactor=4,this.zoomToLocation=null}initialize(){this._handles.add([y(()=>[this.autoOpenEnabled,this.view],()=>this._autoOpenEnabledChange()),this.on("view-change",()=>this._autoClose()),y(()=>[this.highlightEnabled,this.selectedFeature,this.visible,this.view],()=>this._highlightSelectedFeature()),y(()=>[this.highlightEnabled,this.activeFeature,this.visible,this.view],()=>this._highlightActiveFeature()),y(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.animation)==null?void 0:t.state},e=>this._animationStateChange(e)),y(()=>this.location,e=>this._locationChange(e)),y(()=>this.selectedFeature,e=>this._selectedFeatureChange(e)),y(()=>[this.selectedFeatureIndex,this.featureCount,this.featuresPerPage],()=>this._selectedFeatureIndexChange()),y(()=>[this.featurePage,this.selectedFeatureIndex,this.featureCount,this.featuresPerPage,this.featureViewModels],()=>this._setGraphicOnFeatureViewModels()),y(()=>this.featureViewModels,()=>this._featureViewModelsChange()),this.on("trigger-action",e=>oh({event:e,view:this.view})),Qe(()=>!this.waitingForResult,()=>this._waitingForResultChange(),ki),y(()=>{var e,t;return[this.features,(e=this.view)==null?void 0:e.map,(t=this.view)==null?void 0:t.spatialReference]},()=>this._updateFeatureVMs()),y(()=>{var e;return(e=this.view)==null?void 0:e.scale},()=>this._viewScaleChange()),Qe(()=>!this.visible,()=>this.browseClusterEnabled=!1),y(()=>this.browseClusterEnabled,e=>e?this.enableClusterBrowsing():this.disableClusterBrowsing())])}destroy(){this._cancelFetchingFeatures(),this._handles.destroy(),this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null}get active(){return!(!this.visible||this.waitingForResult)}get allActions(){const e=this._get("allActions")||new xi;e.removeAll();const{actions:t,defaultActions:s,defaultPopupTemplateEnabled:n,includeDefaultActions:o,selectedFeature:r}=this,l=o?s.concat(t):t,d=r&&(typeof r.getEffectivePopupTemplate=="function"&&r.getEffectivePopupTemplate(n)||r.popupTemplate),h=d&&d.actions,u=d&&d.overwriteActions?h:h?h.concat(l):l;return u&&u.filter(Boolean).forEach(p=>e.add(p)),e}get defaultActions(){const e=this._get("defaultActions")||new xi;return e.removeAll(),e.addMany(Et(this.selectedFeature)?xh():Th()),e}get featureCount(){return this.features.length}get features(){return this._get("features")||[]}set features(e){const t=e||[];this._set("features",t);const{pendingPromisesCount:s,promiseCount:n,selectedFeatureIndex:o}=this,r=n&&t.length;r&&s&&o===-1?this.selectedFeatureIndex=0:r&&o!==-1||(this.selectedFeatureIndex=t.length?0:-1)}get location(){return this._get("location")||null}set location(e){var n,o,r;let t=e;const s=(o=(n=this.view)==null?void 0:n.spatialReference)==null?void 0:o.isWebMercator;e&&((r=e==null?void 0:e.spatialReference)!=null&&r.isWGS84)&&s&&(t=$r(e)),this._set("location",t)}get pendingPromisesCount(){return this._pendingPromises.size}get waitingForResult(){return!(!(this._fetchFeaturesController||this.pendingPromisesCount>0)||this.featureCount!==0)}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||[]}set promises(e){if(this._pendingPromises.clear(),this.features=[],!Array.isArray(e)||!e.length)return this._set("promises",[]),void this.notifyChange("pendingPromisesCount");this._set("promises",e),(e=e.slice(0)).forEach(t=>{this._pendingPromises.add(t);const s=o=>{this._pendingPromises.has(t)&&this._updateFeatures(o),this._updatePendingPromises(t)},n=()=>this._updatePendingPromises(t);t.then(s,n)}),this.notifyChange("pendingPromisesCount")}get selectedFeature(){const{features:e,selectedFeatureIndex:t}=this;return t===-1?null:e[t]||null}get selectedFeatureIndex(){const e=this._get("selectedFeatureIndex");return typeof e=="number"?e:-1}set selectedFeatureIndex(e){const{featureCount:t}=this;e=isNaN(e)||e<-1||!t?-1:(e+t)%t,this.activeFeature=null,this._set("selectedFeatureIndex",e)}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get state(){return this.get("view.ready")?"ready":"disabled"}centerAtLocation(){const{view:e}=this,t=ga(this);return t&&e?this.callGoTo({target:{target:t,scale:e.scale}}):Promise.reject(new k("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:t,view:e}))}zoomTo(e){return this.callGoTo(e)}clear(){this.set({promises:[],features:[],content:null,title:null,location:null,activeFeature:null})}fetchFeatures(e,t){const{view:s}=this;if(!s||!e)throw new k("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:e,view:s});return s.fetchPopupFeatures(e,{event:t&&t.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:t&&t.signal})}open(e){const t={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...e,visible:!0},{fetchFeatures:s}=t;delete t.fetchFeatures,s&&this._setFetchFeaturesPromises(t.location);const n=["actionsMenuOpen","collapsed","featureMenuOpen"];for(const o of n)delete t[o];this.set(t)}triggerAction(e){const t=this.allActions.getItemAt(e);t&&!t.disabled&&this.emit("trigger-action",{action:t})}next(){return this.selectedFeatureIndex=this.selectedFeatureIndex+1,this}previous(){return this.selectedFeatureIndex=this.selectedFeatureIndex-1,this}disableClusterBrowsing(){hh(this),this._clearBrowsedClusterGraphics()}async enableClusterBrowsing(){const{view:e,selectedFeature:t}=this;(e==null?void 0:e.type)==="2d"?Et(t)?(await ch(this),await dh(this)):V.getLogger(this.declaredClass).warn("enableClusterBrowsing:invalid-selectedFeature: Selected feature must represent an aggregate/cluster graphic.",t):V.getLogger(this.declaredClass).warn("enableClusterBrowsing:invalid-view: View must be 2d MapView.",t)}_animationStateChange(e){this.zoomToLocation||(At.disabled=e==="waiting-for-target")}_clearBrowsedClusterGraphics(){var t;const e=(t=this.view)==null?void 0:t.graphics;e&&(e.remove(this.selectedClusterBoundaryFeature),this._selectedClusterFeature&&e.remove(this._selectedClusterFeature)),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null}_viewScaleChange(){if(Et(this.selectedFeature))return this.browseClusterEnabled=!1,this.visible=!1,void this.clear();this.browseClusterEnabled&&(this.features=this.selectedFeature?[this.selectedFeature]:[])}_locationChange(e){const{selectedFeature:t,updateLocationEnabled:s}=this;s&&e&&(!t||t.geometry)&&this.centerAtLocation()}_selectedFeatureIndexChange(){this.featurePage=this.featureCount>1?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null}_featureViewModelsChange(){this.featurePage=this.featureCount>1?1:null}_setGraphicOnFeatureViewModels(){const{features:e,featureCount:t,featurePage:s,featuresPerPage:n,featureViewModels:o}=this;if(s===null)return;const r=((s-1)*n+t)%t,l=r+n;o.slice(r,l).forEach((d,h)=>{d&&!d.graphic&&(d.graphic=e[r+h])})}async _selectedFeatureChange(e){const{location:t,updateLocationEnabled:s,view:n}=this;if(e&&n){if(this.browseClusterEnabled)return this._selectedClusterFeature&&(n.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),Et(e)?void 0:(e.symbol=await lc(e),this._selectedClusterFeature=e,void n.graphics.add(this._selectedClusterFeature));!s&&t||!e.geometry?s&&!e.geometry&&this.centerAtLocation().then(()=>{var r;const o=(r=n.center)==null?void 0:r.clone();o&&(this.location=o)}):this.location=be(fa(e.geometry))}}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1)}_setFetchFeaturesPromises(e){return this._fetchFeaturesWithController(this._getScreenPoint(e||this.location)).then(t=>{const{clientOnlyGraphics:s,promisesPerLayerView:n}=t,o=Promise.resolve(s),r=n.map(l=>l.promise);this.promises=[o,...r]})}_destroyFeatureVMs(){this.featureViewModels.forEach(e=>e&&!e.destroyed&&e.destroy()),this._set("featureViewModels",[])}_updateFeatureVMs(){const{selectedFeature:e,features:t,featureViewModels:s}=this;if(Et(e)||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),!t||!t.length)return;const n=s.slice(0),o=[];t.forEach((r,l)=>{var h,u;if(!r)return;let d=null;if(n.some((p,g)=>(p&&p.graphic===r&&(d=p,n.splice(g,1)),!!d)),d)o[l]=d;else{const p=new Bn({abilities:this.featureViewModelAbilities,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:(h=this.view)==null?void 0:h.spatialReference,graphic:r===e?r:null,map:(u=this.view)==null?void 0:u.map,view:this.view});o[l]=p}}),n.forEach(r=>r&&!r.destroyed&&r.destroy()),this._set("featureViewModels",o)}_getScreenPoint(e){const{view:t}=this;return t&&e&&typeof t.toScreen=="function"?t.toScreen(e):null}_autoOpenEnabledChange(){const e="auto-fetch-features",{_handles:t,autoOpenEnabled:s}=this;if(t.remove(e),s&&this.view){const n=this.view.on("click",o=>{o.pointerType==="mouse"&&o.button!==0||this._fetchFeaturesAndOpen(o)},pt.WIDGET);t.add(n,e)}}_cancelFetchingFeatures(){const e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}_fetchFeaturesWithController(e,t){this._cancelFetchingFeatures();const s=new AbortController,{signal:n}=s;this._fetchFeaturesController=s,this.notifyChange("waitingForResult");const o=this.fetchFeatures(e,{signal:n,event:t});return o.catch(()=>{}).then(()=>{this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}),o}_fetchFeaturesAndOpen(e){const{screenPoint:t,mapPoint:s}=e,{view:n}=this;this._fetchFeaturesWithController(t,e).then(o=>{var u;const{clientOnlyGraphics:r,promisesPerLayerView:l,location:d}=o,h=[Promise.resolve(r),...l.map(p=>p.promise)];return(u=n==null?void 0:n.popup)==null||u.open({location:d||s,promises:h}),o})}_updatePendingPromises(e){e&&this._pendingPromises.has(e)&&(this._pendingPromises.delete(e),this.notifyChange("pendingPromisesCount"))}_autoClose(){this.autoCloseEnabled&&(this.visible=!1)}async _getLayerView(e,t){return await e.when(),e.whenLayerView(t)}_getHighlightLayer(e){const{layer:t,sourceLayer:s}=e;return s&&"layer"in s&&s.layer?s.layer:(s==null?void 0:s.type)==="map-notes"||(s==null?void 0:s.type)==="subtype-group"?s:t}_getHighlightTarget(e,t){const s=t.type==="imagery"?void 0:"objectIdField"in t?t.objectIdField||uh:null,n=e.attributes;return n&&s&&n[s]||e}async _highlightActiveFeature(){const e="highlight-active-feature";this._handles.remove(e);const{highlightEnabled:t,view:s,activeFeature:n,visible:o}=this;if(!(n&&s&&t&&o))return;const r=this._getHighlightLayer(n);if(!(r&&r instanceof to))return;const l=this._getLayerView(s,r);this._highlightActiveFeaturePromise=l;const d=await l;if(!(d&&ho(d)&&this._highlightActiveFeaturePromise===l&&this.activeFeature&&this.highlightEnabled))return;const h=d.highlight(this._getHighlightTarget(n,r));this._handles.add(h,e)}async _highlightSelectedFeature(){const e="highlight-selected-feature";this._handles.remove(e);const{selectedFeature:t,highlightEnabled:s,view:n,visible:o}=this;if(!(t&&n&&s&&o))return;const r=this._getHighlightLayer(t);if(!(r&&r instanceof to))return;const l=this._getLayerView(n,r);this._highlightSelectedFeaturePromise=l;const d=await l;if(!(d&&ho(d)&&this._highlightSelectedFeaturePromise===l&&this.selectedFeature&&this.highlightEnabled&&this.visible))return;const h=d.highlight(this._getHighlightTarget(t,r));this._handles.add(h,e)}_updateFeatures(e){const{features:t}=this;if(!e||!e.length)return;if(!t.length)return void(this.features=e);const s=e.filter(n=>!t.includes(n));this.features=t.concat(s)}};a([c()],R.prototype,"featurePage",void 0),a([c()],R.prototype,"isLoadingFeature",null),a([c({type:xi})],R.prototype,"actions",void 0),a([c({readOnly:!0})],R.prototype,"active",null),a([c()],R.prototype,"activeFeature",void 0),a([c({readOnly:!0})],R.prototype,"allActions",null),a([c({type:Boolean})],R.prototype,"defaultPopupTemplateEnabled",void 0),a([c()],R.prototype,"autoCloseEnabled",void 0),a([c()],R.prototype,"autoOpenEnabled",void 0),a([c()],R.prototype,"browseClusterEnabled",void 0),a([c()],R.prototype,"content",void 0),a([c({type:xi,readOnly:!0})],R.prototype,"defaultActions",null),a([c({readOnly:!0})],R.prototype,"featureCount",null),a([c()],R.prototype,"features",null),a([c()],R.prototype,"featuresPerPage",void 0),a([c()],R.prototype,"featureViewModelAbilities",void 0),a([c({readOnly:!0})],R.prototype,"featureViewModels",void 0),a([c()],R.prototype,"highlightEnabled",void 0),a([c()],R.prototype,"includeDefaultActions",void 0),a([c({type:se})],R.prototype,"location",null),a([c({readOnly:!0})],R.prototype,"pendingPromisesCount",null),a([c({readOnly:!0})],R.prototype,"selectedClusterBoundaryFeature",void 0),a([c({readOnly:!0})],R.prototype,"waitingForResult",null),a([c({readOnly:!0})],R.prototype,"promiseCount",null),a([c()],R.prototype,"promises",null),a([c({value:null,readOnly:!0})],R.prototype,"selectedFeature",null),a([c({value:-1})],R.prototype,"selectedFeatureIndex",null),a([c({readOnly:!0})],R.prototype,"selectedFeatureViewModel",null),a([c({readOnly:!0})],R.prototype,"state",null),a([c()],R.prototype,"title",void 0),a([c()],R.prototype,"updateLocationEnabled",void 0),a([c()],R.prototype,"view",void 0),a([c()],R.prototype,"visible",void 0),a([c()],R.prototype,"zoomFactor",void 0),a([c()],R.prototype,"zoomToLocation",void 0),a([c()],R.prototype,"centerAtLocation",null),R=a([I("esri.widgets.Popup.PopupViewModel")],R);const _a=R,Ho="selected-index",Eh=0,jo="popup-spinner",Go={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},Wo="esri-popup";function ze(i,e){return e===void 0?`${Wo}__${i}`:`${Wo}__${i}-${e}`}const Zo={closeButton:!0,featureNavigation:!0};let T=class extends ha(le){constructor(e,t){super(e,t),this._blurClose=!1,this._blurContainer=!1,this._containerNode=null,this._mainContainerNode=null,this._featureMenuNode=null,this._actionsMenuNode=null,this._focusClose=!1,this._focusContainer=!1,this._focusDockButton=!1,this._focusFeatureMenuButton=!1,this._focusActionsMenuButton=!1,this._focusFirstFeature=!1,this._focusFirstAction=!1,this._handles=new gt,this._pointerOffsetInPx=16,this._spinner=null,this._feature=null,this._featureMenuIntersectionObserverNode=null,this._featureMenuViewportNode=null,this._rootFlowItemNode=null,this._featureMenuIntersectionObserverCallback=([s])=>{s!=null&&s.isIntersecting&&this.viewModel.featurePage!=null&&this.viewModel.featurePage++},this._featureMenuIntersectionObserver=new IntersectionObserver(this._featureMenuIntersectionObserverCallback,{root:window.document}),this._displaySpinnerThrottled=ii(()=>this._displaySpinner(),Eh),this._exitRelatedRecordsActions=new WeakMap,this._featureSelectionActions=new WeakMap,this._flowItems=new W,this.alignment="auto",this.collapsed=!1,this.collapseEnabled=!0,this.dockEnabled=!1,this.featureMenuOpen=!1,this.headingLevel=2,this.maxInlineActions=3,this.messages=null,this.messagesCommon=null,this.spinnerEnabled=!0,this.viewModel=new _a,this.visibleElements={...Zo},this._handleOpenRelatedFeature=s=>{this._openRelatedFeature(s)},this._addSelectedFeatureIndexHandle(),this.addHandles([y(()=>{var s;return(s=this.viewModel)==null?void 0:s.screenLocation},()=>this._positionContainer()),y(()=>{var s;return[(s=this.viewModel)==null?void 0:s.active,this.dockEnabled]},()=>this._toggleScreenLocationEnabled()),y(()=>{var s;return(s=this.viewModel)==null?void 0:s.screenLocation},(s,n)=>{!!s!=!!n&&this.reposition()}),y(()=>{var s,n,o,r,l,d;return[(n=(s=this.viewModel)==null?void 0:s.view)==null?void 0:n.padding,(r=(o=this.viewModel)==null?void 0:o.view)==null?void 0:r.size,(l=this.viewModel)==null?void 0:l.active,(d=this.viewModel)==null?void 0:d.location,this.alignment]},()=>this.reposition()),y(()=>this.spinnerEnabled,s=>this._spinnerEnabledChange(s)),y(()=>{var s,n;return(n=(s=this.viewModel)==null?void 0:s.view)==null?void 0:n.size},(s,n)=>this._updateDockEnabledForViewSize(s,n)),y(()=>{var s;return(s=this.viewModel)==null?void 0:s.view},(s,n)=>this._viewChange(s,n)),y(()=>{var s,n;return(n=(s=this.viewModel)==null?void 0:s.view)==null?void 0:n.ready},(s,n)=>this._viewReadyChange(s??!1,n??!1)),y(()=>{var s,n;return[(s=this.viewModel)==null?void 0:s.waitingForResult,(n=this.viewModel)==null?void 0:n.location]},()=>{this._hideSpinner(),this._displaySpinnerThrottled()}),y(()=>this.selectedFeatureWidget,()=>this._destroyFlowItemWidgets()),y(()=>{var s,n,o,r;return[(n=(s=this.selectedFeatureWidget)==null?void 0:s.viewModel)==null?void 0:n.title,(r=(o=this.selectedFeatureWidget)==null?void 0:o.viewModel)==null?void 0:r.state]},()=>this._setTitleFromFeatureWidget()),y(()=>{var s,n,o,r;return[(n=(s=this.selectedFeatureWidget)==null?void 0:s.viewModel)==null?void 0:n.content,(r=(o=this.selectedFeatureWidget)==null?void 0:o.viewModel)==null?void 0:r.state]},()=>this._setContentFromFeatureWidget()),Qe(()=>!this.collapsed,()=>{var s,n;((n=(s=this.viewModel)==null?void 0:s.view)==null?void 0:n.widthBreakpoint)==="xsmall"&&this.viewModel.active&&this.collapseEnabled&&this.viewModel.centerAtLocation()}),xe(()=>{var s;return(s=this.viewModel)==null?void 0:s.allActions},"change",()=>this._watchActions()),y(()=>{var s;return(s=this.viewModel)==null?void 0:s.allActions},()=>this._watchActions(),O),y(()=>{var s;return(s=this.viewModel)==null?void 0:s.featureViewModels},()=>this._featureMenuViewportScrollTop()),xe(()=>this._flowItems,"change",()=>{this.notifyChange("_activeFlowItemWidget"),this.scheduleRender()}),y(()=>{var s,n,o,r;return[(n=(s=this._activeFlowItemWidget)==null?void 0:s.viewModel)==null?void 0:n.state,(r=(o=this._activeFlowItemWidget)==null?void 0:o.viewModel)==null?void 0:r.title]},()=>this.scheduleRender())])}loadDependencies(){return Promise.all([w(()=>import("./calcite-flow-16adb5ff.js"),["assets/calcite-flow-16adb5ff.js","assets/widget-7352089c.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/uuid-73213768.js","assets/observers-4f67f1fb.js"]),w(()=>import("./calcite-flow-item-caf50a21.js"),["assets/calcite-flow-item-caf50a21.js","assets/widget-7352089c.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/uuid-73213768.js","assets/interactive-573cbe88.js","assets/loadable-25ad9e4e.js","assets/t9n-5ae2ba76.js","assets/observers-4f67f1fb.js","assets/guid-9426053f.js","assets/action-10d44733.js","assets/icon-5450785a.js","assets/loader-5ac824ac.js","assets/tooltip-eba144bf.js","assets/debounce-31e0cfcc.js","assets/scrim-f0f62705.js"]),w(()=>import("./calcite-action-b9e00222.js"),["assets/calcite-action-b9e00222.js","assets/action-10d44733.js","assets/widget-7352089c.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/uuid-73213768.js","assets/guid-9426053f.js","assets/interactive-573cbe88.js","assets/loadable-25ad9e4e.js","assets/t9n-5ae2ba76.js","assets/observers-4f67f1fb.js","assets/icon-5450785a.js","assets/loader-5ac824ac.js"]),w(()=>import("./calcite-tooltip-ac5b224b.js"),["assets/calcite-tooltip-ac5b224b.js","assets/tooltip-eba144bf.js","assets/widget-7352089c.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/uuid-73213768.js","assets/debounce-31e0cfcc.js","assets/guid-9426053f.js"]),w(()=>import("./calcite-icon-51eb6857.js"),["assets/calcite-icon-51eb6857.js","assets/icon-5450785a.js","assets/widget-7352089c.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/uuid-73213768.js","assets/observers-4f67f1fb.js"])])}destroy(){var e,t;this._destroyFlowItemWidgets(),this._destroySelectedFeatureWidget(),this._destroySpinner(),(e=this._handles)==null||e.destroy(),this._unobserveFeatureMenuObserver(),(t=this._featureMenuIntersectionObserver)==null||t.disconnect()}get actionsMenuId(){return`${this.id}-actions-menu`}get actionsMenuButtonId(){return`${this.id}-actions-menu-button`}get featureMenuId(){return`${this.id}-feature-menu`}get titleId(){return`${this.id}-popup-title`}get contentId(){return`${this.id}-popup-content`}get hasContent(){const{selectedFeatureWidget:e,viewModel:t}=this;if(!e)return!!(t!=null&&t.content);const s=e.viewModel;if(s!=null&&s.waitingForContent||(s==null?void 0:s.state)==="error")return!0;const n=s==null?void 0:s.content;return Array.isArray(n)?!!n.length:!!n}get featureNavigationVisible(){return this.viewModel.active&&this.viewModel.featureCount>1&&this.visibleElements.featureNavigation!=null}get collapsible(){return!!(this.collapseEnabled&&this.viewModel.title&&this.hasContent)}get featureMenuVisible(){return this.featureNavigationVisible&&this.featureMenuOpen}get contentCollapsed(){return this.collapsible&&!this.featureMenuVisible&&this.collapsed}get dividedActions(){return this._divideActions()}get _activeFlowItemWidget(){const{_flowItems:e}=this;return e.getItemAt(e.length-1)||null}get actions(){return this.viewModel.actions}set actions(e){this.viewModel.actions=e}set actionsMenuOpen(e){this._set("actionsMenuOpen",!!e)}get actionsMenuOpen(){return!!this.viewModel.active&&this._get("actionsMenuOpen")}get autoCloseEnabled(){return this.viewModel.autoCloseEnabled}set autoCloseEnabled(e){this.viewModel.autoCloseEnabled=e}get autoOpenEnabled(){return this.viewModel.autoOpenEnabled}set autoOpenEnabled(e){this.viewModel.autoOpenEnabled=e}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(e){this.viewModel.defaultPopupTemplateEnabled=e}get content(){return this.viewModel.content}set content(e){this.viewModel.content=e}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||Go}set dockOptions(e){var d,h;const t={...Go},s=(h=(d=this.viewModel)==null?void 0:d.view)==null?void 0:h.breakpoints,n={};s&&(n.width=s.xsmall,n.height=s.xsmall);const o={...t,...e},r={...t.breakpoint,...n},{breakpoint:l}=o;typeof l=="object"?o.breakpoint={...r,...l}:l&&(o.breakpoint=r),this._set("dockOptions",o),this._setCurrentDockPosition(),this.reposition()}get featureCount(){return this.viewModel.featureCount}get features(){return this.viewModel.features}set features(e){this.viewModel.features=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get highlightEnabled(){return this.viewModel.highlightEnabled}set highlightEnabled(e){this.viewModel.highlightEnabled=e}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get promises(){return this.viewModel.promises}set promises(e){this.viewModel.promises=e}get selectedFeature(){return this.viewModel.selectedFeature}get selectedFeatureIndex(){return this.viewModel.selectedFeatureIndex}set selectedFeatureIndex(e){this.viewModel.selectedFeatureIndex=e}get selectedFeatureWidget(){const{_feature:e,visibleElements:t,headingLevel:s,_flowItems:n}=this,{selectedFeatureViewModel:o}=this.viewModel,r={...t,title:!1};return o?(e?(e.viewModel=o,e.visibleElements=r):this._feature=new th({flowItems:n,headingLevel:s+1,viewModel:o,visibleElements:r}),this._feature):null}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}get updateLocationEnabled(){return this.viewModel.updateLocationEnabled}set updateLocationEnabled(e){this.viewModel.updateLocationEnabled=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}castVisibleElements(e){return{...Zo,...e}}blur(){const{active:e}=this.viewModel;e||V.getLogger(this.declaredClass).warn("Popup can only be blurred when currently active."),this.visibleElements.closeButton?this._blurClose=!0:this._blurContainer=!0,this.scheduleRender()}clear(){return this.viewModel.clear()}close(){this.visible=!1}fetchFeatures(e,t){return this.viewModel.fetchFeatures(e,t)}focus(){const{active:e}=this.viewModel;e||V.getLogger(this.declaredClass).warn("Popup can only be focused when currently active."),this.visibleElements.closeButton?this._focusClose=!0:this._focusContainer=!0,this.scheduleRender()}next(){return this.viewModel.next()}open(e){var o,r;this._handles.remove(Ho);const t=!!e&&!!e.featureMenuOpen,s=!!e&&!!e.actionsMenuOpen,n={collapsed:!!e&&!!e.collapsed,actionsMenuOpen:s,featureMenuOpen:t};((r=(o=this.viewModel)==null?void 0:o.view)==null?void 0:r.widthBreakpoint)==="xsmall"&&(n.collapsed=!0),this.set(n),this.viewModel.open(e),this._shouldFocus(e),this._addSelectedFeatureIndexHandle()}previous(){return this.viewModel.previous()}reposition(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment()}triggerAction(e){return this.viewModel.triggerAction(e)}render(){var C,P,A,N;const{actionsMenuOpen:e,dockEnabled:t,featureMenuVisible:s,dividedActions:n,currentAlignment:o,currentDockPosition:r}=this,{active:l}=this.viewModel,{menuActions:d}=n,h=l&&d.length>1&&e,u=l&&t,p=l&&!t,g=(P=(C=this.selectedFeature)==null?void 0:C.layer)==null?void 0:P.title,f=(N=(A=this.selectedFeature)==null?void 0:A.layer)==null?void 0:N.id,b={[_.alignTopCenter]:o==="top-center",[_.alignBottomCenter]:o==="bottom-center",[_.alignTopLeft]:o==="top-left",[_.alignBottomLeft]:o==="bottom-left",[_.alignTopRight]:o==="top-right",[_.alignBottomRight]:o==="bottom-right",[_.isDocked]:u,[_.shadow]:p,[_.isDockedTopLeft]:r==="top-left",[_.isDockedTopCenter]:r==="top-center",[_.isDockedTopRight]:r==="top-right",[_.isDockedBottomLeft]:r==="bottom-left",[_.isDockedBottomCenter]:r==="bottom-center",[_.isDockedBottomRight]:r==="bottom-right",[_.isFeatureMenuOpen]:s,[_.isActionsMenuOpen]:h};return m("div",{class:this.classes(_.base,b),role:"presentation","data-layer-title":g,"data-layer-id":f,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},l?[this.renderMainContainer(),this.renderPointer()]:null)}renderLoadingIcon(){return m("span",{"aria-hidden":"true",class:this.classes(_.icon,_.iconLoading,_.rotating)})}renderNavigationLoading(){const{messagesCommon:e}=this;return this.viewModel.pendingPromisesCount?m("div",{key:ze("loading-container"),role:"presentation",class:_.loadingContainer,"aria-label":e.loading,title:e.loading},this.renderLoadingIcon()):null}renderPreviousIcon(){const e=De(this.container),t={[_.iconRightTriangleArrow]:e,[_.paginationPreviousIconRTL]:e,[_.iconLeftTriangleArrow]:!e,[_.paginationPreviousIconLTR]:!e};return m("span",{"aria-hidden":"true",class:this.classes(_.icon,t)})}renderPreviousButton(){const{messages:e}=this;return m("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes(_.button,_.paginationPrevious),"aria-label":e.previous,title:e.previous},this.renderPreviousIcon())}renderNextIcon(){const e=De(this.container),t={[_.iconLeftTriangleArrow]:e,[_.paginationNextIconRTL]:e,[_.iconRightTriangleArrow]:!e,[_.paginationNextIconLTR]:!e};return m("span",{"aria-hidden":"true",class:this.classes(_.icon,t)})}renderNextButton(){const{messages:e}=this;return m("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes(_.button,_.paginationNext),"aria-label":e.next,title:e.next},this.renderNextIcon())}renderFeatureMenuButton(){const{featureMenuOpen:e,featureMenuId:t,messagesCommon:s}=this,{featureCount:n,selectedFeatureIndex:o}=this.viewModel;return m("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:this.classes(_.button,_.featureMenuButton),"aria-haspopup":"true","aria-controls":t,"aria-expanded":e.toString(),"aria-label":s.menu,title:s.menu},this._getPageText(n,o))}renderNavigationButtons(){return this.featureNavigationVisible?[this.renderPreviousButton(),this.renderNavigationLoading()||this.renderFeatureMenuButton(),this.renderNextButton()]:[]}renderDockIcon(){const{dockEnabled:e}=this,t=this._wouldDockTo(),s={[_.iconUndock]:e,[_.iconDock]:!e,[_.iconDockToRight]:!e&&(t==="top-right"||t==="bottom-right"),[_.iconDockToLeft]:!e&&(t==="top-left"||t==="bottom-left"),[_.iconDockToTop]:!e&&t==="top-center",[_.iconDockToBottom]:!e&&t==="bottom-center"};return m("span",{"aria-hidden":"true",class:this.classes(s,_.icon)})}renderDockButton(){var o,r,l;const{dockEnabled:e,messages:t}=this,s=(r=(o=this.viewModel)==null?void 0:o.view)==null?void 0:r.widthBreakpoint,n=e?t.undock:t.dock;return s!=="xsmall"&&((l=this.dockOptions)!=null&&l.buttonEnabled)?m("div",{role:"button","aria-label":n,title:n,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes(_.button,_.buttonDock)},this.renderDockIcon()):null}renderTitle(){const{title:e}=this.viewModel,{titleId:t,collapsible:s,contentCollapsed:n,messagesCommon:o}=this,r={[_.headerContainerButton]:s},l=m(An,{level:this.headingLevel,class:_.headerTitle,innerHTML:e??""}),d=s?m("button",{key:`${e}--collapsible`,id:t,title:n?o.expand:o.collapse,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(_.headerContainer,r),"aria-expanded":n?"false":"true",onclick:this._toggleCollapsed,type:"button"},l,m("calcite-icon",{class:_.collapseIcon,key:"collapse-icon",icon:n?"chevron-down":"chevron-up",scale:"m"})):m("div",{key:e??"title",id:t,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(_.headerContainer,r)},l);return e?d:null}renderCloseIcon(){return m("span",{"aria-hidden":"true",class:this.classes(_.icon,_.iconClose)})}renderCloseButton(){const{visibleElements:e,messagesCommon:t}=this;return e.closeButton?m("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:_.button,"aria-label":t.close,title:t.close,afterCreate:this._closeButtonNodeUpdated,afterUpdate:this._closeButtonNodeUpdated},this.renderCloseIcon()):null}renderHeader(){return m("header",{class:_.header},this.renderTitle(),m("div",{class:_.headerButtons},this.renderDockButton(),this.renderCloseButton()))}renderContentContainer(){const{contentId:e,hasContent:t,contentCollapsed:s,_flowItems:n}=this,{content:o}=this.viewModel,r=n.toArray(),l={[_.contentHasFlows]:!!r.length};return t&&!s?m("div",{key:o??"content",enterAnimation:this._createFeatureUpdatedAnimation(),id:e,class:this.classes(_.content,l)},m("calcite-flow",{bind:this},m("calcite-flow-item",{bind:this,"data-node-ref":"_rootFlowItemNode",afterCreate:as,key:"root-flow-item",onCalciteFlowItemBack:this._handleBackClick},this.renderContent()),r.map(d=>this.renderFlowItem(d))),r.map(d=>this.renderFlowItemTooltips(d))):null}renderFlowItem(e){const{messages:t}=this,s=rn(),n="graphic"in e&&!e.isTable;return m("calcite-flow-item",{bind:this,class:this.classes({[_.calciteThemeDark]:!s,[_.calciteThemeLight]:s}),heading:e.title??"",description:this._getFlowItemDescription(e),onCalciteFlowItemBack:this._handleBackClick,key:`flow-item-${e.viewModel.uid}`},m("calcite-action",{class:_.actionExit,icon:"move-up",label:t==null?void 0:t.exitRelatedRecords,text:t==null?void 0:t.exitRelatedRecords,slot:"header-actions-start",bind:this,afterCreate:o=>this._storeExitRelatedRecordsAction(e,o),onclick:this._destroyFlowItemWidgets}),n?m("calcite-action",{class:_.actionSelectFeature,icon:"zoom-to-object",label:t==null?void 0:t.selectFeature,text:t==null?void 0:t.selectFeature,slot:"header-actions-end",bind:this,afterCreate:o=>this._storeFeatureSelectionAction(e,o),onclick:()=>this._handleOpenRelatedFeature(e)}):null,m("div",{class:this.classes(_.contentFlowItem,{[_.calciteThemeDark]:s,[_.calciteThemeLight]:!s})},e.render()))}renderFlowItemTooltips(e){const{messages:t,_exitRelatedRecordsActions:s,_featureSelectionActions:n}=this,o=rn(),r=n.get(e);return[m("calcite-tooltip",{class:this.classes({[_.calciteThemeDark]:!o,[_.calciteThemeLight]:o}),key:`exit-related-records-tooltip-${e.viewModel.uid}`,label:t==null?void 0:t.exitRelatedRecords,overlayPositioning:"fixed",referenceElement:s.get(e),placement:"top"},t==null?void 0:t.exitRelatedRecords),r?m("calcite-tooltip",{class:this.classes({[_.calciteThemeDark]:!o,[_.calciteThemeLight]:o}),key:`select-related-record-tooltip-${e.viewModel.uid}`,label:t==null?void 0:t.selectFeature,overlayPositioning:"fixed",referenceElement:r,placement:"top"},t==null?void 0:t.selectFeature):null]}renderActionsMenuButton(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:s,dividedActions:n,messagesCommon:o}=this,r=s?o.close:o.open,{menuActions:l}=n;return l.length?m("div",{key:ze("actions-menu-button"),class:this.classes(_.button,_.actionsMenuButton),role:"button",id:t,"aria-haspopup":"true","aria-controls":s?e:null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":r,title:r},m("span",{"aria-hidden":"true",class:_.iconActionsMenu})):null}renderMenuActions(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:s,dividedActions:n}=this,{menuActions:o}=n;return o.length&&s?m("ul",{id:e,role:"menu","aria-labelledby":t,key:ze("actions"),class:_.actions,bind:this,onkeyup:this._handleActionMenuKeyup,afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},o.toArray().map(r=>this.renderAction({action:r,type:"menu-item"}))):null}renderInlineActions(){const{inlineActions:e}=this.dividedActions;return e.length?e.toArray().map(t=>this.renderAction({action:t,type:"inline"})):[]}renderInlineActionsContainer(){const{inlineActions:e,menuActions:t}=this.dividedActions,s=!!e.length,n=!!t.length;return s||n?m("div",{key:"inline-actions-container","data-inline-actions":s.toString(),"data-menu-actions":n.toString(),class:_.inlineActionsContainer},this.renderInlineActions(),this.renderActionsMenuButton(),this.renderMenuActions()):null}renderNavigation(){return this.featureNavigationVisible?m("section",{key:ze("navigation"),class:this.classes(_.navigation)},this.renderNavigationButtons()):null}renderFooter(){const{featureNavigationVisible:e,dividedActions:t}=this,{inlineActions:s,menuActions:n}=t,o=!!s.length,r=!!n.length,l={[_.footerHasPagination]:e,[_.footerHasActions]:o,[_.footerHasActionsMenu]:r};return e||o?m("div",{key:ze("feature-buttons"),class:this.classes(_.footer,l)},this.renderInlineActionsContainer(),this.renderNavigation()):null}renderFeatureMenuContainer(){const{messages:e}=this,{featureViewModels:t,isLoadingFeature:s}=this.viewModel,n=Le(e.selectedFeatures,{total:t.length});return m("section",{key:ze("menu"),class:_.featureMenu},m("strong",{class:_.featureMenuHeader},n),m("nav",{bind:this,class:_.featureMenuViewport,"data-node-ref":"_featureMenuViewportNode",afterCreate:as},this.renderFeatureMenu(),m("div",{class:_.featureMenuObserver,bind:this,afterCreate:this._featureMenuIntersectionObserverCreated}),s?m("div",{class:_.featureMenuLoader},this.renderLoadingIcon()):null))}renderPointer(){return this.dockEnabled?null:m("div",{key:ze("pointer"),class:_.pointer,role:"presentation"},m("div",{class:this.classes(_.pointerDirection,_.shadow)}))}renderMainContainer(){const{dockEnabled:e,currentAlignment:t,currentDockPosition:s,titleId:n,contentId:o,collapsible:r,hasContent:l,contentCollapsed:d,visibleElements:h}=this,{title:u}=this.viewModel,p=t==="bottom-left"||t==="bottom-center"||t==="bottom-right"||s==="top-left"||s==="top-center"||s==="top-right",g=t==="top-left"||t==="top-center"||t==="top-right"||s==="bottom-left"||s==="bottom-center"||s==="bottom-right",f={[_.shadow]:e,[_.isCollapsible]:r,[_.isCollapsed]:d};return m("div",{class:this.classes(_.main,_.widget,f),tabIndex:h.closeButton?void 0:-1,role:"dialog","aria-labelledby":u?n:"","aria-describedby":l&&!d?o:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},p?this.renderFooter():null,p?this.renderFeatureMenuContainer():null,this.renderHeader(),this.renderContentContainer(),g?this.renderFooter():null,g?this.renderFeatureMenuContainer():null)}renderContent(){var t;const e=(t=this.viewModel)==null?void 0:t.content;return e?typeof e=="string"?m("div",{class:j.contentNode,key:e,innerHTML:e}):this.renderNodeContent(e):null}renderActionText(e){return m("span",{key:"text",class:_.actionText},e)}renderActionIcon(e){const t=this._getActionClass(e),s=this._getActionImage(e),n={[_.iconLoading]:e.active,[_.rotating]:e.active,[_.icon]:!!t,[_.actionImage]:!e.active&&!!s};return t&&(n[t]=!e.active),m("span",{key:"icon","aria-hidden":"true",class:this.classes(_.icon,n),styles:this._getIconStyles(s)})}renderAction(e){const{action:t,type:s}=e,n=this._getActionTitle(t),o={[_.action]:t.type!=="toggle",[_.actionToggle]:t.type==="toggle",[_.actionToggleOn]:t.type==="toggle"&&t.value,[_.buttonDisabled]:t.disabled},r=[this.renderActionIcon(t),this.renderActionText(n)],l=s==="menu-item"?m("li",{key:t.uid,role:"menuitem",tabIndex:0,title:n,"aria-label":n,class:this.classes(_.button,o),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":t.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},r):m("div",{key:t.uid,role:"button",tabIndex:0,title:n,"aria-label":n,class:this.classes(_.button,o),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":t.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},r);return t.visible?l:null}renderFeatureMenuItem(e,t){const{messages:s,messagesCommon:n}=this,{selectedFeatureIndex:o,selectedFeatureViewModel:r}=this.viewModel,l=e===r,d={[_.featureMenuSelected]:l},h=l?m("span",{key:ze(`feature-menu-selected-feature-${o}`),title:s.selectedFeature,"aria-label":s.selectedFeature,class:_.iconCheckMark}):null,u=m("span",{innerHTML:e.title||n.untitled});return m("li",{role:"menuitem",tabIndex:-1,key:ze(`feature-menu-feature-${o}`),class:this.classes(d,_.featureMenuItem),bind:this,"data-feature-index":t,onblur:this._removeActiveFeature,onfocus:this._setActiveFeature,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature,onmouseover:this._setActiveFeature,onmouseleave:this._removeActiveFeature},m("span",{class:_.featureMenuTitle},u,h))}renderFeatureMenu(){const{featureMenuId:e}=this,{featureViewModels:t}=this.viewModel;return t.length>1?m("ol",{class:_.featureMenuList,id:e,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},t.filter(s=>!!s.graphic).map((s,n)=>this.renderFeatureMenuItem(s,n))):null}_storeFeatureSelectionAction(e,t){this._featureSelectionActions.set(e,t),this.scheduleRender()}_storeExitRelatedRecordsAction(e,t){this._exitRelatedRecordsActions.set(e,t),this.scheduleRender()}_getFlowItemDescription(e){return"featureCountDescription"in e?e.featureCountDescription:e.viewModel.description??""}async _openRelatedFeature(e){await e.viewModel.updateGeometry();const t=e.graphic,s=t==null?void 0:t.geometry;if(F(s)||F(t))return;this._destroyFlowItemWidgets(),await this.viewModel.zoomTo({target:s});const n=fa(s);this.open({features:[t],location:M(n)?n:void 0})}_destroyFlowItemWidgets(){this._flowItems.removeAll().forEach(e=>{"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e.viewModel=null,e.destroy()})}_handleBackClick(){const e=this._flowItems.pop();e&&(this._exitRelatedRecordsActions.delete(e),this._featureSelectionActions.delete(e),"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e&&(e.viewModel=null,e.destroy()))}_getActionTitle(e){const{messages:t,selectedFeature:s,messagesCommon:n}=this,{id:o}=e,r=s==null?void 0:s.attributes,l=e.title??"",d=o==="zoom-to-feature"?Le(l,{messages:t}):o==="remove-selected-feature"?Le(l,{messages:n}):o==="zoom-to-clustered-features"||o==="browse-clustered-features"?Le(l,{messages:t}):e.title;return d&&r?Le(d,r):d??""}_getActionClass(e){const{selectedFeature:t}=this,s=t==null?void 0:t.attributes,{className:n,image:o}=e,r=o||n?n:_.iconDefaultAction;return r&&s?Le(r,s):r??""}_getActionImage(e){const{selectedFeature:t}=this,s=t==null?void 0:t.attributes,{image:n}=e;return n&&s?Le(n,s):n??""}_createFeatureUpdatedAnimation(){return oc("enter",_.hasFeatureUpdated)}_getInlineActionCount(){const{maxInlineActions:e,featureNavigationVisible:t}=this;if(typeof e!="number")return null;const s=Math.round(e);return Math.max(t?s-1:s,0)}_watchActions(){const{allActions:e}=this.viewModel;this.notifyChange("dividedActions");const t="actions";this._handles.remove(t),e&&e.forEach(s=>{this._handles.add(y(()=>[s.uid,s.active,s.className,s.disabled,s.id,s.title,s.image,s.visible],()=>this.scheduleRender()),t)})}_divideActions(){const{allActions:e}=this.viewModel,t=e.filter(r=>r.visible),s=this._getInlineActionCount(),n=s===null,o=s===0;return{inlineActions:n?t.slice(0):o?new W:t.slice(0,s),menuActions:n?new W:o?t.slice(0):t.slice(s)}}_featureMenuOpenChanged(e){e?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0}_actionsMenuOpenChanged(e){e?this._focusFirstAction=!0:this._focusActionsMenuButton=!0}_setTitleFromFeatureWidget(){var s,n;const{selectedFeatureWidget:e,messagesCommon:t}=this;e&&(this.viewModel.title=((s=e.viewModel)==null?void 0:s.state)==="error"?t.errorMessage:((n=e.viewModel)==null?void 0:n.title)||"")}_setContentFromFeatureWidget(){const{selectedFeatureWidget:e}=this;e&&(this.viewModel.content=e)}_unobserveFeatureMenuObserver(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)}_featureMenuIntersectionObserverCreated(e){this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver.observe(e),this._featureMenuIntersectionObserverNode=e}_handleFeatureMenuKeyup(e){xt(e)==="Escape"&&(e.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender())}_handleActionMenuKeyup(e){xt(e)==="Escape"&&(e.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender())}_setActiveFeature(e){const{viewModel:t}=this,s=e.currentTarget["data-feature-index"];t.activeFeature=t.features[s]||null}_removeActiveFeature(){this.viewModel.activeFeature=null}_handleFeatureMenuItemKeyup(e){const t=xt(e),{_featureMenuNode:s}=this,n=e.currentTarget["data-feature-index"];if(!s)return;const o=s.querySelectorAll("li"),r=o.length;t!=="ArrowUp"?t!=="ArrowDown"?t!=="Home"?t!=="End"||(e.stopPropagation(),o[o.length-1].focus()):(e.stopPropagation(),o[0].focus()):(e.stopPropagation(),o[(n+1+r)%r].focus()):(e.stopPropagation(),o[(n-1+r)%r].focus())}_handleActionMenuItemKeyup(e){const t=xt(e),{_actionsMenuNode:s}=this,n=e.currentTarget.dataset.actionUid,{menuActions:o}=this.dividedActions,r=o.findIndex(h=>h.uid===n);if(!s)return;const l=s.querySelectorAll("li"),d=l.length;t!=="ArrowUp"?t!=="ArrowDown"?t!=="Home"?t!=="End"||(e.stopPropagation(),l[l.length-1].focus()):(e.stopPropagation(),l[0].focus()):(e.stopPropagation(),l[(r+1+d)%d].focus()):(e.stopPropagation(),l[(r-1+d)%d].focus())}_handleMainKeyup(e){const t=xt(e);t==="ArrowLeft"&&(e.stopPropagation(),this.previous()),t==="ArrowRight"&&(e.stopPropagation(),this.next())}_spinnerEnabledChange(e){if(this._destroySpinner(),!e)return;const t=this.get("viewModel.view");this._createSpinner(t)}_hideSpinner(){const{_spinner:e}=this;e&&(e.location=null,e.hide())}_displaySpinner(){const{_spinner:e}=this;if(!e)return;const{location:t,waitingForResult:s}=this.viewModel;s&&t?e.show({location:t}):e.hide()}_getIconStyles(e){return{"background-image":e?`url(${e})`:""}}async _shouldFocus(e){e!=null&&e.shouldFocus&&(await En(()=>{var t;return((t=this.viewModel)==null?void 0:t.active)===!0}),this.focus())}_addSelectedFeatureIndexHandle(){const e=y(()=>{var t;return(t=this.viewModel)==null?void 0:t.selectedFeatureIndex},(t,s)=>this._selectedFeatureIndexUpdated(t,s));this._handles.add(e,Ho)}_selectedFeatureIndexUpdated(e,t){const{featureCount:s}=this;s&&e!==t&&e!==-1&&(this._destroyFlowItemWidgets(),this.actionsMenuOpen=!1,this.featureMenuOpen=!1,this._mainContainerNode&&(this._mainContainerNode.scrollTop=0),this._rootFlowItemNode&&this._rootFlowItemNode.scrollContentTo({top:0}))}_destroySelectedFeatureWidget(){const{_feature:e}=this;e&&(e.viewModel=null,e&&!e.destroyed&&e.destroy()),this._feature=null}_isScreenLocationWithinView(e,t){return e.x>-1&&e.y>-1&&e.x<=t.width&&e.y<=t.height}_isOutsideView(e){const{popupHeight:t,popupWidth:s,screenLocation:n,side:o,view:r}=e;if(isNaN(s)||isNaN(t)||!r||!n)return!1;const l=r.padding;return o==="right"&&n.x+s/2>r.width-l.right||o==="left"&&n.x-s/2<l.left||o==="top"&&n.y-t<l.top||o==="bottom"&&n.y+t>r.height-l.bottom}_calculateAutoAlignment(e){if(e!=="auto")return e;const{_pointerOffsetInPx:t,_containerNode:s,_mainContainerNode:n,viewModel:o}=this,{screenLocation:r,view:l}=o;if(F(r)||!l||!s)return"top-center";if(!this._isScreenLocationWithinView(r,l))return this._get("currentAlignment")||"top-center";function d(H){return parseInt(H.replace(/[^-\d\.]/g,""),10)}const h=n?window.getComputedStyle(n,null):null,u=h?d(h.getPropertyValue("max-height")):0,p=h?d(h.getPropertyValue("height")):0,{height:g,width:f}=s.getBoundingClientRect(),b=f+t,C=Math.max(g,u,p)+t,P=this._isOutsideView({popupHeight:C,popupWidth:b,screenLocation:r,side:"right",view:l}),A=this._isOutsideView({popupHeight:C,popupWidth:b,screenLocation:r,side:"left",view:l}),N=this._isOutsideView({popupHeight:C,popupWidth:b,screenLocation:r,side:"top",view:l}),L=this._isOutsideView({popupHeight:C,popupWidth:b,screenLocation:r,side:"bottom",view:l});return A?N?"bottom-right":"top-right":P?N?"bottom-left":"top-left":N?L?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(e){return typeof e=="function"?e.call(this):e}_getCurrentAlignment(){const{alignment:e,dockEnabled:t}=this;return t||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(e)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment())}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition())}_calculatePositionResult(e){const t=["left","right"];return De(this.container)&&t.reverse(),e.replace(/leading/gi,t[0]).replace(/trailing/gi,t[1])}_callDockPosition(e){return typeof e=="function"?e.call(this):e}_getDockPosition(){var e;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition((e=this.dockOptions)==null?void 0:e.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_wouldDockTo(){return this.dockEnabled?null:this._getDockPosition()}_calculateAutoDockPosition(e){var l;if(e!=="auto")return e;const t=(l=this.viewModel)==null?void 0:l.view,s=De(this.container)?"top-left":"top-right";if(!t)return s;const n=t.padding||{left:0,right:0,top:0,bottom:0},o=t.width-n.left-n.right,{breakpoints:r}=t;return r&&o<=r.xsmall?"bottom-center":s}_positionContainer(e=this._containerNode){if(e&&(this._containerNode=e),!this._containerNode)return;const{screenLocation:t}=this.viewModel,{width:s}=this._containerNode.getBoundingClientRect(),n=this._calculatePositionStyle(t,s);n&&Object.assign(this._containerNode.style,n)}_calculateFullWidth(e){const{currentAlignment:t,_pointerOffsetInPx:s}=this;return t==="top-left"||t==="bottom-left"||t==="top-right"||t==="bottom-right"?e+s:e}_calculateAlignmentPosition(e,t,s,n){const{currentAlignment:o,_pointerOffsetInPx:r}=this;if(!s)return;const{padding:l}=s,d=n/2,h=s.height-t,u=s.width-e;return o==="bottom-center"?{top:t+r-l.top,left:e-d-l.left}:o==="top-left"?{bottom:h+r-l.bottom,right:u+r-l.right}:o==="bottom-left"?{top:t+r-l.top,right:u+r-l.right}:o==="top-right"?{bottom:h+r-l.bottom,left:e+r-l.left}:o==="bottom-right"?{top:t+r-l.top,left:e+r-l.left}:o==="top-center"?{bottom:h+r-l.bottom,left:e-d-l.left}:void 0}_calculatePositionStyle(e,t){const{dockEnabled:s,view:n}=this;if(!n)return;if(s)return{left:"",top:"",right:"",bottom:""};if(F(e)||!t)return;const o=this._calculateFullWidth(t),r=this._calculateAlignmentPosition(e.x,e.y,n,o);return r?{top:r.top!==void 0?`${r.top}px`:"auto",left:r.left!==void 0?`${r.left}px`:"auto",bottom:r.bottom!==void 0?`${r.bottom}px`:"auto",right:r.right!==void 0?`${r.right}px`:"auto"}:void 0}_viewChange(e,t){e&&t&&(this.close(),this.clear())}_viewReadyChange(e,t){if(e){const s=this.get("viewModel.view");this._wireUpView(s)}else t&&(this.close(),this.clear())}_wireUpView(e){if(this._destroySpinner(),!e)return;const{spinnerEnabled:t}=this;t&&this._createSpinner(e),this._setDockEnabledForViewSize(this.dockOptions)}_dockingThresholdCrossed(e,t,s){const[n,o]=e,[r,l]=t,{width:d=0,height:h=0}=s??{};return n<=d&&r>d||n>d&&r<=d||o<=h&&l>h||o>h&&l<=h}_updateDockEnabledForViewSize(e,t){if(!e||!t)return;const s=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},n=s.left+s.right,o=s.top+s.bottom,r=[],l=[];r[0]=e[0]-n,r[1]=e[1]-o,l[0]=t[0]-n,l[1]=t[1]-o;const{dockOptions:d}=this,h=d.breakpoint;this._dockingThresholdCrossed(r,l,h)&&this._setDockEnabledForViewSize(d),this._setCurrentDockPosition()}_focusDockButtonNode(e){this._focusDockButton&&(this._focusDockButton=!1,e.focus())}_closeButtonNodeUpdated(e){return this._focusClose?(this._focusClose=!1,void e.focus()):this._blurClose?(this._blurClose=!1,void e.blur()):void 0}_mainContainerNodeUpdated(e){return this._mainContainerNode=e,this._focusContainer?(this._focusContainer=!1,void e.focus()):this._blurContainer?(this._blurContainer=!1,void e.blur()):void 0}_featureMenuNodeUpdated(e){if(this._featureMenuNode=e,!e||!this._focusFirstFeature)return;this._focusFirstFeature=!1;const t=e.querySelectorAll("li");t.length&&t[0].focus()}_actionsMenuNodeUpdated(e){if(this._actionsMenuNode=e,!e||!this._focusFirstAction)return;this._focusFirstAction=!1;const t=e.querySelectorAll("li");t.length&&t[0].focus()}_focusFeatureMenuButtonNode(e){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,e.focus())}_focusActionsMenuButtonNode(e){this._focusActionsMenuButton&&(this._focusActionsMenuButton=!1,e.focus())}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&(this._featureMenuViewportNode.scrollTop=0)}_toggleScreenLocationEnabled(){const{dockEnabled:e,viewModel:t}=this;if(!t)return;const s=t.active&&!e;t.screenLocationEnabled=s}_shouldDockAtCurrentViewSize(e){var d,h;const t=e.breakpoint,s=(h=(d=this.viewModel)==null?void 0:d.view)==null?void 0:h.ui;if(!s)return!1;const{width:n,height:o}=s;if(isNaN(n)||isNaN(o)||!t)return!1;const r=t.hasOwnProperty("width")&&n<=(t.width??0),l=t.hasOwnProperty("height")&&o<=(t.height??0);return r||l}_setDockEnabledForViewSize(e){e.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(e))}_getPageText(e,t){return this.featureNavigationVisible?Le(this.messages.pageText,{index:t+1,total:e}):null}_destroySpinner(){const{_spinner:e,view:t}=this;e&&(t&&t.ui&&t.ui.remove(e,jo),e.destroy(),this._spinner=null)}_createSpinner(e){e&&(this._spinner=new sh({view:e}),e.ui.add(this._spinner,{key:jo,position:"manual"}))}_toggleCollapsed(){this.collapsed=!this.collapsed}_close(){this.close(),this.view&&this.view.focus()}_toggleDockEnabled(){this.dockEnabled=!this.dockEnabled,this._focusDockButton=!0,this.scheduleRender()}_toggleFeatureMenu(){const e=!this.featureMenuOpen;this._featureMenuOpenChanged(e),this.actionsMenuOpen=!1,this.featureMenuOpen=e}_toggleActionsMenu(){const e=!this.actionsMenuOpen;this._actionsMenuOpenChanged(e),this.featureMenuOpen=!1,this.actionsMenuOpen=e}_triggerAction(e){const t=e.currentTarget.dataset.actionUid,{allActions:s}=this.viewModel,n=s.findIndex(r=>r.uid===t),o=s.getItemAt(n);o&&o.type==="toggle"&&(o.value=!o.value),this.actionsMenuOpen=!1,this.viewModel.triggerAction(n)}_selectFeature(e){const t=e.currentTarget["data-feature-index"];isNaN(t)||(this.viewModel.selectedFeatureIndex=t),this.featureMenuOpen=!1,this._focusFeatureMenuButton=!0,this.scheduleRender()}_next(){this.next()}_previous(){this.previous()}};a([c({readOnly:!0})],T.prototype,"actionsMenuId",null),a([c({readOnly:!0})],T.prototype,"actionsMenuButtonId",null),a([c({readOnly:!0})],T.prototype,"featureMenuId",null),a([c({readOnly:!0})],T.prototype,"titleId",null),a([c({readOnly:!0})],T.prototype,"contentId",null),a([c({readOnly:!0})],T.prototype,"hasContent",null),a([c({readOnly:!0})],T.prototype,"featureNavigationVisible",null),a([c({readOnly:!0})],T.prototype,"collapsible",null),a([c({readOnly:!0})],T.prototype,"featureMenuVisible",null),a([c({readOnly:!0})],T.prototype,"contentCollapsed",null),a([c({readOnly:!0})],T.prototype,"dividedActions",null),a([c({readOnly:!0,dependsOn:["_flowItems.length"]})],T.prototype,"_activeFlowItemWidget",null),a([c()],T.prototype,"actions",null),a([c()],T.prototype,"actionsMenuOpen",null),a([c()],T.prototype,"alignment",void 0),a([c()],T.prototype,"autoCloseEnabled",null),a([c()],T.prototype,"autoOpenEnabled",null),a([c()],T.prototype,"defaultPopupTemplateEnabled",null),a([c()],T.prototype,"content",null),a([c()],T.prototype,"collapsed",void 0),a([c()],T.prototype,"collapseEnabled",void 0),a([c({readOnly:!0})],T.prototype,"currentAlignment",null),a([c({readOnly:!0})],T.prototype,"currentDockPosition",null),a([c()],T.prototype,"dockOptions",null),a([c()],T.prototype,"dockEnabled",void 0),a([c({readOnly:!0})],T.prototype,"featureCount",null),a([c()],T.prototype,"featureMenuOpen",void 0),a([c()],T.prototype,"features",null),a([c()],T.prototype,"goToOverride",null),a([c()],T.prototype,"headingLevel",void 0),a([c()],T.prototype,"highlightEnabled",null),a([c()],T.prototype,"location",null),a([c()],T.prototype,"label",null),a([c()],T.prototype,"maxInlineActions",void 0),a([c(),ae("esri/widgets/Popup/t9n/Popup")],T.prototype,"messages",void 0),a([c(),ae("esri/t9n/common")],T.prototype,"messagesCommon",void 0),a([c()],T.prototype,"promises",null),a([c({readOnly:!0})],T.prototype,"selectedFeature",null),a([c()],T.prototype,"selectedFeatureIndex",null),a([c({readOnly:!0})],T.prototype,"selectedFeatureWidget",null),a([c()],T.prototype,"spinnerEnabled",void 0),a([c()],T.prototype,"title",null),a([c()],T.prototype,"updateLocationEnabled",null),a([c()],T.prototype,"view",null),a([c({type:_a}),pc(["triggerAction","trigger-action"])],T.prototype,"viewModel",void 0),a([c()],T.prototype,"visible",null),a([c()],T.prototype,"visibleElements",void 0),a([Xe("visibleElements")],T.prototype,"castVisibleElements",null),a([Me()],T.prototype,"_close",null),a([Me()],T.prototype,"_toggleDockEnabled",null),a([Me()],T.prototype,"_toggleFeatureMenu",null),a([Me()],T.prototype,"_toggleActionsMenu",null),a([Me()],T.prototype,"_triggerAction",null),a([Me()],T.prototype,"_selectFeature",null),a([Me()],T.prototype,"_next",null),a([Me()],T.prototype,"_previous",null),T=a([I("esri.widgets.Popup")],T);const Ko=T,Gs=[0,0];function kh(i){const e=(i.ownerDocument||window.document).defaultView,t=i.getBoundingClientRect();return Gs[0]=t.left+((e==null?void 0:e.pageXOffset)??0),Gs[1]=t.top+((e==null?void 0:e.pageYOffset)??0),Gs}function Qo(i){i&&(Ur(i),i.parentNode&&i.parentNode.removeChild(i))}function $h(i){const e=document.createElement("div");return i.appendChild(e),e}const ui=16,qi=750,Ph=512,Ah=2,Fh=i=>{let e=class extends i{constructor(...t){var s;super(...t),this._freqInfo={freq:ui,time:qi},this._overlayRenderTaskHandle=null,this.height=0,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,t.length!==0&&((s=t[0])==null?void 0:s.popup)!==void 0||(this.popup=new Ko({view:this})),this.handles.add([y(()=>this.cursor,n=>{const{surface:o}=this;o&&o.setAttribute("data-cursor",n)}),y(()=>this.interacting,n=>{const{surface:o}=this;o&&o.setAttribute("data-interacting",n.toString())})])}initialize(){this.handles.add(y(()=>this.ui,(t,s)=>this._handleUIChange(t,s))),this._wireUI(this.ui),this.handles.add([this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused"))])}destroy(){this.destroyed||(this.ui=re(this.ui),this.popup&&!this.popup.destroyed&&this.popup.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(t){const s=this._get("container"),n=qr(t);if(n||typeof t!="string"||V.getLogger(this.declaredClass).error("#container",`element with id '${t}' not found`),s===n)return;const o="dom-size";if(this.handles.remove(o),this._stopMeasuring(),s&&(s.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(Qo(this.root),this._set("root",null)),this.userContent&&(ao(this.userContent,s),Qo(this.userContent),this._set("userContent",null))),!n)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);n.classList.add("esri-view");const r=document.createElement("div");r.className="esri-view-user-storage",ao(n,r),n.appendChild(r),this._set("userContent",r);const l=document.createElement("div");l.className="esri-view-root",n.insertBefore(l,n.firstChild),this._set("root",l);const d=document.createElement("div");d.className="esri-view-surface",d.setAttribute("role","application"),d.tabIndex=0,l.appendChild(d),this._set("surface",d);const h=new yo;l.appendChild(h.surface),this._set("overlay",h),y(()=>h.needsRender,u=>{u&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=ni({render:()=>{var p;return(p=this.overlay)==null?void 0:p.render()}}):this._overlayRenderTaskHandle=Ye(this._overlayRenderTaskHandle)}),this.forceDOMReadyCycle(),this.handles.add(y(()=>this.size,u=>{const[p,g]=u,f="esri-view-surface--inset-outline";p>=document.body.clientWidth||g>=document.body.clientHeight?d.classList.add(f):d.classList.remove(f)},O),o),this._set("container",n),this._startMeasuring()}get focused(){const t=document.activeElement===this.surface;return document.hasFocus()&&t}set popup(t){const s=this._get("popup");s&&s!==t&&s.destroy(),this._set("popup",t)}get size(){return[this.width,this.height]}blur(){this.surface&&this.surface.blur()}focus(){this.surface&&this.surface.focus()}pageToContainer(t,s,n){const o=this.position;return t-=o?o[0]:0,s-=o?o[1]:0,n?(n[0]=t,n[1]=s):n=[t,s],n}containerToPage(t,s,n){const o=this.position;return t+=o?o[0]:0,s+=o?o[1]:0,n?(n[0]=t,n[1]=s):n=[t,s],n}_handleUIChange(t,s){s&&(this.handles.remove("ui"),s.destroy()),t&&this._wireUI(t),this._set("ui",t)}_wireUI(t){this.handles.remove("ui"),t&&(t.view=this,this.handles.add([y(()=>this.root,s=>{t.container=s?$h(s):null},O),y(()=>this.popup,(s,n)=>{const o="popup",r="manual";n&&t.remove(n,o),s&&(s.view=t.view,t.add(s,{key:o,position:r}))},O)],"ui"))}_stopMeasuring(){this.handles.remove("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const t=this._freqInfo;t.freq=ui,t.time=qi,this.handles.add([(()=>{const s=()=>{t.freq=ui,t.time=qi};return window.addEventListener("resize",s),{remove(){window.removeEventListener("resize",s)}}})(),ni({prepare:s=>{const n=this._measure(),o=this._freqInfo;if(o.time+=s.deltaTime,n&&(o.freq=ui,this._get("resizing")||this._set("resizing",!0)),o.time<o.freq)return;o.time=0;const r=this._position();o.freq=r||n?ui:Math.min(qi,o.freq*Ah),!n&&o.freq>=Ph&&this._get("resizing")&&this._set("resizing",!1)}})],"measuring"),this._measure(),this._position()}_measure(){const t=this.container,s=t?t.clientWidth:0,n=t?t.clientHeight:0;if(s===0||n===0)return this.suspended||this._set("suspended",!0),!1;const o=this.width,r=this.height;return s===o&&n===r?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",s),this._set("height",n),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:o,oldHeight:r,width:s,height:n}),!0)}_position(){const t=this.container,s=this.position,n=t&&kh(t);return!!n&&(!s||n[0]!==s[0]||n[1]!==s[1])&&(this._set("position",[n[0],n[1]]),!0)}forceDOMReadyCycle(){}};return a([c()],e.prototype,"container",null),a([c({readOnly:!0})],e.prototype,"focused",null),a([c({readOnly:!0})],e.prototype,"height",void 0),a([c({type:Ko})],e.prototype,"popup",null),a([c({type:yo})],e.prototype,"overlay",void 0),a([c({readOnly:!0})],e.prototype,"position",void 0),a([c({readOnly:!0})],e.prototype,"resizing",void 0),a([c({readOnly:!0})],e.prototype,"root",void 0),a([c({value:null,readOnly:!0})],e.prototype,"size",null),a([c({readOnly:!0})],e.prototype,"surface",void 0),a([c({readOnly:!0})],e.prototype,"suspended",void 0),a([c()],e.prototype,"ui",void 0),a([c({readOnly:!0})],e.prototype,"userContent",void 0),a([c({readOnly:!0})],e.prototype,"width",void 0),a([c()],e.prototype,"widthBreakpoint",void 0),e=a([I("esri.views.DOMContainer")],e),e},Rh=i=>{let e=class extends i{async fetchPopupFeatures(t,s){await this.when();const{location:n,queryArea:o,layerViewsAndGraphics:r,clientOnlyGraphics:l}=await this._prepareFetchPopupFeatures(t,s),d=Promise.resolve(l),h=this._queryLayerPopupFeatures(o,r,s),u=h.map(p=>p.promise);return{location:n,clientOnlyGraphics:l,allGraphicsPromise:Rl([d,...u]).then(p=>Array.from(new Set(p.flat()))),promisesPerLayerView:h}}_queryLayerPopupFeatures(t,s,n){return s.map(({layerView:o,graphics:r})=>{const l={clientGraphics:r,event:M(n)?n.event:void 0,signal:M(n)?n.signal:void 0,defaultPopupTemplateEnabled:!!M(n)&&!!n.defaultPopupTemplateEnabled},d=o.fetchPopupFeatures(t,l);return{layerView:o,promise:d}})}_isValidPopupGraphic(t,s){return t&&!!t.getEffectivePopupTemplate(M(s)&&s.defaultPopupTemplateEnabled)}async _prepareFetchPopupFeatures(t,s){const{clientGraphics:n,queryArea:o,location:r}=await this._popupHitTestGraphics(t,s),l=this._getFetchPopupLayerViews(),{layerViewsAndGraphics:d,clientOnlyGraphics:h}=this._graphicsPerFetchPopupLayerView(n,l);return{clientOnlyGraphics:h,layerViewsAndGraphics:d,queryArea:o,location:r}}async _popupHitTestGraphics(t,s){const n=await this.popupHitTest(t),o=n.results,r=n.mapPoint,l=o.filter(h=>h.type==="graphic"&&this._isValidPopupGraphic(h.graphic,s)),d=l.length?l[0].mapPoint:null;return{clientGraphics:l.map(h=>h.graphic),queryArea:r,location:r||d}}_getFetchPopupLayerViews(){const t=[];return this.allLayerViews.forEach(s=>{this._isValidPopupLayerView(s)&&t.push(s)}),M(this.graphicsView)&&this._isValidPopupLayerView(this.graphicsView)&&t.push(this.graphicsView),t.reverse()}_isValidPopupLayerView(t){return M(t)&&(!("layer"in t)||!t.suspended)&&"fetchPopupFeatures"in t}_graphicsPerFetchPopupLayerView(t,s){const n=[],o=new Map,r=s.map(l=>{const d=[];return"layer"in l?o.set(l.layer,d):o.set(l.graphics,d),{layerView:l,graphics:d}});for(const l of t){const d=o.get(l.layer)||o.get(l.sourceLayer)||null;d?d.push(l):n.push(l)}return{layerViewsAndGraphics:r,clientOnlyGraphics:n}}};return e=a([I("esri.views.PopupView")],e),e};let ps=class extends gc{constructor(e){super(e),this.handles.add(this.on("before-add",t=>{F(t.item)||t.item.parent===this.owner&&(V.getLogger(this.declaredClass).warn("Analysis inside the collection must be unique. Not adding this element again."),t.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};ps=a([I("esri.support.AnalysesCollection")],ps);let rt=class extends D{constructor(e){super(e),this.view=null,this.baseLayerViews=new W,this.referenceLayerViews=new W,this._loadingHandle=y(()=>{var t,s;return(s=(t=this.view)==null?void 0:t.map)==null?void 0:s.basemap},t=>{t&&t.load().catch(()=>{})},O)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null)}get suspended(){return!this.view||this.view.suspended}get updating(){var t,s;if(this.view&&this.view.suspended)return!1;const e=(s=(t=this.view)==null?void 0:t.map)==null?void 0:s.basemap;return!!e&&!!e.loaded&&(this.baseLayerViews.some(n=>n.updating)||this.referenceLayerViews.some(n=>n.updating))}};a([c({constructOnly:!0})],rt.prototype,"view",void 0),a([c({readOnly:!0})],rt.prototype,"baseLayerViews",void 0),a([c({readOnly:!0})],rt.prototype,"referenceLayerViews",void 0),a([c({readOnly:!0})],rt.prototype,"suspended",null),a([c({type:Boolean,readOnly:!0})],rt.prototype,"updating",null),rt=a([I("esri.views.BasemapView")],rt);function Lh(i){return"tryRecycleWith"in i}class Sh{constructor(e,t,s){this.layer=e,this.view=t,this.layerViewImporter=s,this._controller=new AbortController,this._deferred=Pr(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,ks(this._controller.signal,()=>{const n=new k("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(n)})}tryRecycle(e){if(!this.done||!this.layerView||!Lh(this.layerView))return null;const t=this.layer.type,s=this._controller.signal;for(let n=0;n<e.length;n++){const o=e[n];if(o.type!==t)continue;const r=this.layerView.tryRecycleWith(o,{signal:s});if(r){e.splice(n,1),this.layer=o;const l=this.layerView,d=l.view;return this.promise=Promise.race([r.then(()=>(ti(this._controller.signal),o.emit("layerview-destroy",{view:d,layerView:l}),d.emit("layerview-destroy",{view:d,layerView:l}),o.emit("layerview-create",{view:d,layerView:l}),d.emit("layerview-create",{view:d,layerView:l}),l)),new Promise((h,u)=>ks(this._controller.signal,()=>u(Ar())))]),this.promise}}return null}destroy(){this._controller.abort();const{layerView:e}=this;if(!e)return;const{layer:t,view:s}=this;t.emit("layerview-destroy",{view:s,layerView:e}),s.emit("layerview-destroy",{layer:t,layerView:e}),this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null}async start(){var n,o,r;if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:t,view:s}=this;this._map=s.map;try{let l,d;if(await t.load({signal:e}),"prefetchResources"in t&&await((n=t.prefetchResources)==null?void 0:n.call(t,{signal:e})),Oh(t))l=await t.createLayerView(s,{signal:e});else{if(!this.layerViewImporter.hasLayerViewModule(t))throw new k("layer:view-not-supported","No layerview implementation was found");const p=await this.layerViewImporter.importLayerView(t);ti(e),l="default"in p?new p.default({layer:t,view:s}):new p({layer:t,view:s})}const h=()=>{d=Ye(d),l.destroyed||l.destroy(),l.layer=null,l.parent=null,l.view=null,this.done=!0};d=ks(e,h),ti(e);try{await l.when()}catch(p){throw h(),p}if(!((r=(o=this._map)==null?void 0:o.allLayers)==null?void 0:r.includes(t)))return h(),void this._deferred.reject(new k("view:no-layerview-for-layer","The layer has been removed from the map",{layer:t}));this.layerView=l,t.emit("layerview-create",{view:s,layerView:l}),s.emit("layerview-create",{layer:t,layerView:l}),this.done=!0,this._deferred.resolve(l)}catch(l){t.emit("layerview-create-error",{view:s,error:l}),s.emit("layerview-create-error",{layer:t,error:l}),this.done=!0,this._deferred.reject(new k("layerview:create-error","layerview creation failed",{layer:t,error:l}))}}}let we=class extends D{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new Mr,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var s;const t=(s=this.view.map)==null?void 0:s.allLayers;if(t)for(const n of t)this.layerViewImporter.hasLayerViewModule(n)&&this.layerViewImporter.importLayerView(n)},this._reschedule=()=>(F(this._workPromise)&&(this._workPromise=Pr(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(Ll(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var d,h,u;const t=this.view.map;if(this._map!==t&&(this.clear(),this._map=t),F(this._workPromise))return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const s=new Set,n=[],o=this.view.ready,r=p=>{if(!F(p)){for(const g of p)if(g){s.add(g);const f=this._layerLayerViewInfoMap.get(g);f&&o?f.start():f||this._recyclingInfoMap.has(g)||n.push(g),"layers"in g&&g.layers&&r(g.layers)}}};for(const p of this._rootCollectionNames)r(this.get(p));for(const[p,g]of this._layerLayerViewInfoMap)if(!s.has(p)){this._layerLayerViewInfoMap.delete(g.layer);const f=g.tryRecycle(n);f?(this._recyclingInfoMap.set(g.layer,g),f.then(()=>{this._recyclingInfoMap.delete(g.layer),this._layerLayerViewInfoMap.set(g.layer,g),this._reschedule()}).catch(()=>{this._recyclingInfoMap.delete(g.layer),g.destroy(),this._reschedule()})):g.destroy()}for(const[p,g]of this._recyclingInfoMap)s.has(p)||(this._recyclingInfoMap.delete(g.layer),g.destroy());for(const p of n)this._createLayerView(p);this._refreshCollections();const l=[(d=t==null?void 0:t.ground)==null?void 0:d.layers,(h=t==null?void 0:t.basemap)==null?void 0:h.baseLayers,(u=t==null?void 0:t.basemap)==null?void 0:u.referenceLayers,t==null?void 0:t.layers].filter(p=>!!p);s.forEach(p=>"layers"in p&&l.push(p.layers)),this.addHandles(l.map(p=>this._watchUpdatingTracking.addOnCollectionChange(()=>p,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.own([xe(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.allLayers},"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),y(()=>{const e=this.view,t=e==null?void 0:e.map;return[t==null?void 0:t.basemap,t==null?void 0:t.ground,t==null?void 0:t.layers,e==null?void 0:e.ready]},()=>this._reschedule(),yt)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),this._watchUpdatingTracking.destroy(),this._map=null,M(this._workPromise)&&(this._workPromise.reject(Ar()),this._workPromise=null)}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return M(this._workPromise)||this._watchUpdatingTracking.updating||gs(this._layerLayerViewInfoMap,e=>!e.done)}get updatingRemaining(){let e=0;for(const t of this._layerLayerViewInfoMap.values())t.done||++e;return e}clear(){if(!this.destroyed){for(const e of this._layerLayerViewInfoMap.values())e.destroy();this._layerLayerViewInfoMap.clear(),this._refreshCollections()}}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e)){if(this._recyclingInfoMap.has(e))return this._recyclingInfoMap.get(e).promise;throw new k("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e})}return this._layerLayerViewInfoMap.get(e).promise}_refreshCollections(){for(const[e,t]of this._layersToLayerViews)this._populateLayerViewsOwners(this.get(e),this.get(t),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(e,t,s){if(!e||!t)return void(t&&t.removeAll());let n=0;for(const o of e){const r=this._layerLayerViewInfoMap.get(o);if(!r||!r.layerView)continue;const l=r.layerView;l.layer=o,l.parent=s,t.getItemAt(n)!==l&&t.splice(n,0,l),o.layers&&this._populateLayerViewsOwners(o.layers,l.layerViews,l),n+=1}n<t.length&&t.splice(n,t.length)}_createLayerView(e){e.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const t=new Sh(e,this.view,this.layerViewImporter);t.promise.then(()=>this._refreshCollections(),s=>{s&&(kr(s)||s.name==="cancelled:layerview-create")||V.getLogger(this.declaredClass).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:s}),this._refreshCollections()}),this._layerLayerViewInfoMap.set(e,t),this.view.ready&&t.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};a([c()],we.prototype,"_workPromise",void 0),a([c({readOnly:!0})],we.prototype,"_watchUpdatingTracking",void 0),a([c({readOnly:!0})],we.prototype,"_layersToLayerViews",null),a([c({readOnly:!0})],we.prototype,"_rootCollectionNames",null),a([c()],we.prototype,"layerViewImporter",void 0),a([c()],we.prototype,"supportsGround",void 0),a([c({readOnly:!0})],we.prototype,"updating",null),a([c({readOnly:!0})],we.prototype,"updatingRemaining",null),a([c({constructOnly:!0})],we.prototype,"view",void 0),we=a([I("esri.views.LayerViewManager")],we);const Dh=we;function Oh(i){return"createLayerView"in i&&i.createLayerView!=null}let ye=class extends D{constructor(e){super(e),this.factor=1.5,this.offset=pe(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};a([c({type:Number})],ye.prototype,"factor",void 0),a([c({nonNullable:!0})],ye.prototype,"offset",void 0),a([c()],ye.prototype,"position",void 0),a([c({type:Number,range:{min:0}})],ye.prototype,"size",void 0),a([c()],ye.prototype,"maskUrl",void 0),a([c()],ye.prototype,"maskEnabled",void 0),a([c()],ye.prototype,"overlayUrl",void 0),a([c()],ye.prototype,"overlayEnabled",void 0),a([c({readOnly:!0})],ye.prototype,"version",null),a([c({type:Boolean})],ye.prototype,"visible",void 0),ye=a([I("esri.views.Magnifier")],ye);const ya=ye;let bi=class extends D{constructor(e,t){super({}),this._stage=e,this._textureRequests=new Map,this._frameTask=(t==null?void 0:t.registerTask(hc.TEXTURE_UNLOAD))??uc}normalizeCtorArgs(){return{}}destroy(){super.destroy(),this._frameTask.remove(),this._textureRequests.forEach(e=>this._releaseTextureRequest(e)),this._textureRequests.clear()}get updating(){return this._frameTask.updating}fromData(e,t,s){const n=this.makeUid(e);let o=this._textureRequests.get(n);if(!o){const r=t();o={referenceCount:0,texture:r,textureAsync:null,abortController:null,onRemove:s},this._stage&&(this._stage.add(r),this._stage.loadImmediate(r)),this._textureRequests.set(n,o)}return o.referenceCount++,{uid:n,texture:o.texture,release:()=>this._release(n)}}_release(e){const t=this._textureRequests.get(e);t?(t.referenceCount<1&&console.warn("TextureCollection: reference count is < 1 for "+e),t.referenceCount--,t.referenceCount<1&&this._frameTask.schedule(()=>this._releaseNow(e))):console.warn(`TextureCollection: texture doesn't exist: '${e}'`)}get test(){return{textureRequests:this._textureRequests}}_releaseNow(e){if(!this._textureRequests)return;const t=this._textureRequests.get(e);!t||t.referenceCount>0||(this._releaseTextureRequest(t),this._textureRequests.delete(e))}_releaseTextureRequest(e){var t;e.onRemove&&e.onRemove(),e.texture?(t=this._stage)==null||t.remove(e.texture):e.abortController&&(e.abortController.abort(),e.abortController=null)}makeUid(e,t=null){return M(t)?`${e}.${t}px`:e}};a([c()],bi.prototype,"_frameTask",void 0),a([c()],bi.prototype,"updating",null),bi=a([I("esri.views.3d.support.TextureCollection")],bi);var Yo;(function(i){i[i.Left=0]="Left",i[i.Middle=1]="Middle",i[i.Right=2]="Right"})(Yo||(Yo={}));const va=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],wa={};function ba(i){return!!wa[i]}function Vh(i){for(const e of i)if(!ba(e))return!1;return!0}va.forEach(i=>{wa[i]=!0});let Nh=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(({handler:t,priority:s},n)=>{var o;return(o=this.inputManager)==null?void 0:o.installHandlers(n,[t],s)})}disconnect(){this.inputManager&&this._handlers.forEach((e,t)=>{var s;return(s=this.inputManager)==null?void 0:s.uninstallHandlers(t)}),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,t,s,n){const o=Array.isArray(e)?e:e.split(",");if(!Vh(o))return o.some(ba)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let r,l;Array.isArray(t)?l=t:(r=t,l=[]),typeof s=="function"?r=s:n=s,n=n??pt.DEFAULT;const d=this._createUniqueGroupName(),h=new zh(this.view,o,l,r);this._handlers.set(d,{handler:h,priority:n});for(const u of o){const p=this._handlerCounts.get(u)||0;this._handlerCounts.set(u,p+1)}return this.inputManager&&this.inputManager.installHandlers(d,[h],n),{remove:()=>this._removeHandler(d,o)}}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,t){if(this._handlers.has(e)){this._handlers.delete(e);for(const s of t){const n=this._handlerCounts.get(s);n===void 0?console.error("Trying to remove handler for event that has no handlers registered: ",s):n===1?this._handlerCounts.delete(s):this._handlerCounts.set(s,n-1)}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},zh=class extends ee{constructor(e,t,s,n){super(!0),this._latestDragStart=void 0,this.view=e;for(const o of t)switch(o){case"click":this.registerIncoming("click",s,r=>n(this._wrapClick(r)));break;case"double-click":this.registerIncoming("double-click",s,r=>n(this._wrapDoubleClick(r)));break;case"immediate-click":this.registerIncoming("immediate-click",s,r=>n(this._wrapImmediateClick(r)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",s,r=>n(this._wrapImmediateDoubleClick(r)));break;case"hold":this.registerIncoming("hold",s,r=>n(this._wrapHold(r)));break;case"drag":this.registerIncoming("drag",s,r=>{const l=this._wrapDrag(r);l&&n(l)});break;case"key-down":this.registerIncoming("key-down",s,r=>n(this._wrapKeyDown(r)));break;case"key-up":this.registerIncoming("key-up",s,r=>n(this._wrapKeyUp(r)));break;case"pointer-down":this.registerIncoming("pointer-down",s,r=>n(this._wrapPointer(r,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",s,r=>n(this._wrapPointer(r,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",s,r=>n(this._wrapPointer(r,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",s,r=>n(this._wrapPointerDrag(r)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",s,r=>n(this._wrapMouseWheel(r)));break;case"pointer-enter":this.registerIncoming("pointer-enter",s,r=>n(this._wrapPointer(r,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",s,r=>n(this._wrapPointer(r,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",s,r=>{n(this._wrapGamepad(r))});break;case"focus":this.registerIncoming("focus",s,r=>{n(this._wrapFocus(r))});break;case"blur":this.registerIncoming("blur",s,r=>{n(this._wrapBlur(r))})}}_wrapFocus(e){return{type:"focus",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}_wrapBlur(e){return{type:"blur",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}_wrapClick(e){const{pointerType:t,button:s,buttons:n,x:o,y:r,native:l,eventId:d}=e.data,{cancelable:h,timestamp:u}=e;return{type:"click",pointerType:t,button:s,buttons:n,x:o,y:r,native:l,timestamp:u,screenPoint:pe(o,r),mapPoint:this._getMapPoint(o,r),eventId:d,cancelable:h,stopPropagation:()=>e.stopPropagation(),async:p=>e.async(p),preventDefault:()=>e.preventDefault()}}_wrapDoubleClick(e){const{pointerType:t,button:s,buttons:n,x:o,y:r,native:l,eventId:d}=e.data,{cancelable:h,timestamp:u}=e;return{type:"double-click",pointerType:t,button:s,buttons:n,x:o,y:r,native:l,timestamp:u,mapPoint:this._getMapPoint(o,r),eventId:d,cancelable:h,stopPropagation:()=>e.stopPropagation(),async:p=>e.async(p),preventDefault:()=>e.preventDefault()}}_wrapImmediateClick(e){const{pointerType:t,button:s,buttons:n,x:o,y:r,native:l,eventId:d}=e.data,h=l.pointerId,{cancelable:u,timestamp:p}=e;return{type:"immediate-click",pointerId:h,pointerType:t,button:s,buttons:n,x:o,y:r,native:l,timestamp:p,mapPoint:this._getMapPoint(o,r),eventId:d,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:g=>e.async(g),preventDefault:()=>e.preventDefault()}}_wrapImmediateDoubleClick(e){const{pointerType:t,button:s,buttons:n,x:o,y:r,native:l,eventId:d}=e.data,h=l.pointerId,{cancelable:u,timestamp:p}=e;return{type:"immediate-double-click",pointerId:h,pointerType:t,button:s,buttons:n,x:o,y:r,native:l,timestamp:p,mapPoint:this._getMapPoint(o,r),eventId:d,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:g=>e.async(g),preventDefault:()=>e.preventDefault()}}_wrapHold(e){const{pointerType:t,button:s,buttons:n,x:o,y:r,native:l}=e.data,{cancelable:d,timestamp:h}=e;return{type:"hold",pointerType:t,button:s,buttons:n,x:o,y:r,native:l,timestamp:h,mapPoint:this._getMapPoint(o,r),cancelable:d,stopPropagation:()=>e.stopPropagation(),async:u=>e.async(u),preventDefault:()=>e.preventDefault()}}_getMapPoint(e,t){return this.view.toMap(pe(e,t),{exclude:[]})}_wrapDrag(e){const t=e.data,{x:s,y:n}=t.center,{action:o,pointerType:r,button:l}=t;if(o==="start"&&(this._latestDragStart=t),!this._latestDragStart)return;const d=t.pointer.native,h=t.buttons,{cancelable:u,timestamp:p}=e,g={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return o==="end"&&(this._latestDragStart=void 0),{type:"drag",action:o,x:s,y:n,origin:g,pointerType:r,button:l,buttons:h,radius:t.radius,angle:Sl(t.angle),native:d,timestamp:p,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:f=>e.async(f),preventDefault:()=>e.preventDefault()}}_wrapKeyDown(e){const{key:t,repeat:s,native:n}=e.data,{cancelable:o,timestamp:r}=e;return{type:"key-down",key:t,repeat:s,native:n,timestamp:r,cancelable:o,stopPropagation:()=>e.stopPropagation(),async:l=>e.async(l),preventDefault:()=>e.preventDefault()}}_wrapKeyUp(e){const{key:t,native:s}=e.data,{cancelable:n,timestamp:o}=e;return{type:"key-up",key:t,native:s,timestamp:o,cancelable:n,stopPropagation:()=>e.stopPropagation(),async:r=>e.async(r),preventDefault:()=>e.preventDefault()}}_wrapPointer(e,t){const{x:s,y:n,button:o,buttons:r,native:l,eventId:d}=e.data,h=l.pointerId,u=l.pointerType,{cancelable:p,timestamp:g}=e;return{type:t,x:s,y:n,pointerId:h,pointerType:u,button:o,buttons:r,native:l,timestamp:g,eventId:d,cancelable:p,stopPropagation:()=>e.stopPropagation(),async:f=>e.async(f),preventDefault:()=>e.preventDefault()}}_wrapPointerDrag(e){const{x:t,y:s,buttons:n,native:o,eventId:r}=e.data.currentEvent,{button:l}=e.data.startEvent,d=e.data.startEvent.native.pointerId,h=e.data.startEvent.native.pointerType,u=e.data.action,p={x:e.data.startEvent.x,y:e.data.startEvent.y},{cancelable:g,timestamp:f}=e;return{type:"pointer-drag",x:t,y:s,pointerId:d,pointerType:h,button:l,buttons:n,action:u,origin:p,native:o,timestamp:f,eventId:r,cancelable:g,stopPropagation:()=>e.stopPropagation(),async:b=>e.async(b),preventDefault:()=>e.preventDefault()}}_wrapMouseWheel(e){const{cancelable:t,data:s,timestamp:n}=e,{x:o,y:r,deltaY:l,native:d}=s;return{type:"mouse-wheel",x:o,y:r,deltaY:l,native:d,timestamp:n,cancelable:t,stopPropagation:()=>e.stopPropagation(),async:h=>e.async(h),preventDefault:()=>e.preventDefault()}}_wrapGamepad(e){const{action:t,state:s,device:n}=e.data,{cancelable:o,timestamp:r}=e,{buttons:l,axes:d}=s;return{type:"gamepad",device:n,timestamp:r,action:t,buttons:l,axes:d,cancelable:o,stopPropagation:()=>e.stopPropagation(),async:h=>e.async(h),preventDefault:()=>e.preventDefault()}}};var Fi,Xo,Jo;(function(i){i[i.USER=0]="USER",i[i.MANAGER=1]="MANAGER"})(Fi||(Fi={})),function(i){i[i.None=0]="None",i[i.Unfocused=1]="Unfocused",i[i.Focused=2]="Focused",i[i.Unselected=4]="Unselected",i[i.Selected=8]="Selected",i[i.All=15]="All"}(Xo||(Xo={})),function(i){i[i.None=0]="None",i[i.Custom1=16]="Custom1",i[i.Custom2=32]="Custom2",i[i.Custom3=64]="Custom3",i[i.Custom4=128]="Custom4",i[i.Custom5=256]="Custom5",i[i.Custom6=512]="Custom6",i[i.Custom7=1024]="Custom7",i[i.Custom8=2048]="Custom8",i[i.Custom9=4096]="Custom9",i[i.Custom10=8192]="Custom10",i[i.Custom11=16384]="Custom11",i[i.Custom12=32768]="Custom12",i[i.All=65520]="All"}(Jo||(Jo={}));function Bh(i){return[i.on("before-add",e=>{const t=e.item;if(t==null||i.includes(t))return V.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();t.onAdd()}),i.on("after-remove",e=>{const t=e.item;t.active&&(t.view.activeTool=null),t.destroy()})]}function pn(i){return i.visible&&i.getEditableFlag!=null&&i.getEditableFlag(Fi.USER)&&i.getEditableFlag(Fi.MANAGER)}function Pe(i){return pe(i.x,i.y)}function Ma(i,e){var s;const t=(s=i instanceof HTMLElement?i:i.surface)==null?void 0:s.getBoundingClientRect();return t?pe(e.clientX-t.left,e.clientY-t.top):pe(0,0)}function er(i,e){return e instanceof Event?Ma(i,e):Pe(e)}function tr(i){if(i instanceof Event)return!0;if(typeof i=="object"&&"type"in i)switch(i.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let qh=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}handleInputEvent(e,t){const s=()=>e.stopPropagation();switch(e.type){case"pointer-move":ir(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(s(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!sr(e))break;const n=Pe(e),o=this._intersect(n,e.pointerType,t.forEachTool);if(F(o))break;const r=o.manipulator,l=o.tool;!(M(r)&&M(l)&&r.interactive)||r.grabbable&&r.grabbableForEvent(e)||!r.grabbing||r.dragging||this._ungrabManipulatorBeforeDragging(r,e,t),M(r)&&M(l)&&r.interactive&&r.grabbable&&r.grabbableForEvent(e)&&!r.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:r,tool:l,start:n,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&F(t.activeTool)&&(this._revertToNullActiveTool=!0,t.setActiveTool(o.tool)),r.grabbing=!0,r.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:n}),s());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,t);break;case"pointer-drag":{if(!sr(e))break;const n=this._grabbedManipulators.get(e.pointerId),o=_i(n,({manipulator:u})=>u),r=_i(n,({tool:u})=>u);if(F(o)||F(r))break;const l=Pe(e);l.x=rs(l.x,0,t.view.width),l.y=rs(l.y,0,t.view.height);const d=be(n).start,h=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(o.dragging=!0,h?o.events.emit("drag",{action:"update",start:d,screenPoint:l}):o.events.emit("drag",{action:"start",start:d,screenPoint:l,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:r,manipulator:o,start:d}));break;case"end":o.dragging=!1,h&&o.events.emit("drag",{action:"end",start:d,screenPoint:l}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,t)}s();break}case"immediate-click":{const n=Pe(e),o=this._intersect(n,e.pointerType,t.forEachTool);if(Uh(e)||t.forEachTool(h=>{if((!M(o)||o.tool!==h||h.automaticManipulatorSelection)&&h.manipulators){let u=!1;h.manipulators.forEach(({manipulator:p})=>{p.selected&&(p.selected=!1,u=!0)}),u&&h.onManipulatorSelectionChanged&&h.onManipulatorSelectionChanged()}}),F(o))break;const{manipulator:r,tool:l}=o;if(!r.interactive)break;r.selectable&&l.automaticManipulatorSelection&&(r.selected=!r.selected,l.onManipulatorSelectionChanged&&l.onManipulatorSelectionChanged());const d=e.native.shiftKey;r.events.emit("immediate-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:d,stopPropagation:s});break}case"click":{const n=Pe(e),o=this._intersect(n,e.pointerType,t.forEachTool),r=M(o)?o.manipulator:null;if(F(r)||!r.interactive)break;const l=e.native.shiftKey;r.events.emit(e.type,{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:l}),s();break}case"double-click":{const n=Pe(e),o=this._intersect(n,e.pointerType,t.forEachTool),r=M(o)?o.manipulator:null;if(F(r)||!r.interactive)break;const l=e.native.shiftKey;r.events.emit("double-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:s});break}case"immediate-double-click":{const n=Pe(e),o=this._intersect(n,e.pointerType,t.forEachTool),r=M(o)?o.manipulator:null;if(F(r)||!r.interactive)break;const l=e.native.shiftKey;r.events.emit("immediate-double-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:s});break}}this._onFocusChange(t.forEachTool)}_ungrabManipulatorBeforeDragging(e,t,s){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:Pe(t)}),this._grabbedManipulators.forEach(({manipulator:n},o)=>{n===e&&this._grabbedManipulators.delete(o)}),this._afterManipulatorUngrab(s.setActiveTool)}_handlePointerEnd(e,t){const s=_i(this._grabbedManipulators.get(e.pointerId),({manipulator:n})=>n);F(s)||s.grabbing&&(s.grabbing=!1,s.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:Pe(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorUngrab(t.setActiveTool))}_cursorFromMap(e){let t=null;return gs(e,({manipulator:s})=>!(F(s)||!s.interactive)&&(s.grabbing&&s.grabCursor?(t=s.grabCursor,!0):!!s.cursor&&(t=s.cursor,!0))),t}_onFocusChange(e){this._updateCursor(),this._updateFocusedManipulatorTools(e)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(e){const t=new Set,s=new Set;this._grabbedManipulators.forEach(({tool:n})=>{t.add(n)}),this._hoveredManipulators.forEach(({tool:n})=>{s.add(n)}),e(n=>{n.hasGrabbedManipulators=t.has(n),n.hasHoveredManipulators=s.has(n);const o=this._grabbedManipulators.values(),r=Dl(o,({tool:l})=>l===n);n.firstGrabbedManipulator=M(r)?r.manipulator:null})}clearPointers(e,{forEachTool:t,setActiveTool:s},n=!0,o){const r=(l,d)=>l===e&&(F(o)||o===d);this._grabbedManipulators.forEach(({tool:l,manipulator:d,pointerType:h},u)=>{r(l,d)&&(this._grabbedManipulators.delete(u),d.grabbing=!1,d.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:h}))}),this._draggedManipulators.forEach(({tool:l,manipulator:d},h)=>{r(l,d)&&(this._draggedManipulators.delete(h),d.dragging=!1,d.events.emit("drag",{action:"cancel"}))}),n&&this._hoveredManipulators.forEach(({tool:l,manipulator:d},h)=>{r(l,d)&&(this._hoveredManipulators.delete(h),d.hovering=!1)}),this._afterManipulatorUngrab(s),this._onFocusChange(t)}_intersect(e,t,s){let n=null;return s(o=>{if(o.manipulators==null||!pn(o))return!1;const r=o.manipulators.intersect(e,t);return!F(r)&&(n={tool:o,manipulator:r},!0)}),n}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((t,s)=>{this._updateHoveredStateForPointerAtScreenPosition(pe(t.x,t.y),s,t.pointerType,e)})}handleHoverEvent(e,t){e.type!=="pointer-up"&&e.type!=="immediate-click"&&e.type!=="pointer-move"||!ir(e.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(Pe(e),e.pointerId,e.pointerType,t)}_updateHoveredStateForPointerAtScreenPosition(e,t,s,n){let o=this._intersect(e,s,n);const r=_i(this._hoveredManipulators.get(t),({manipulator:l})=>l);M(o)&&!o.manipulator.interactive&&(o=null),M(o)&&r===o.manipulator||(M(r)&&(r.hovering=!1),M(o)?(o.manipulator.hovering=!0,this._hoveredManipulators.set(t,o)):this._hoveredManipulators.delete(t),this._onFocusChange(n))}_afterManipulatorUngrab(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}};function ir(i){return i==="mouse"}function sr(i){return i.pointerType!=="mouse"||i.button===0}function Uh(i){return!!i.native.shiftKey}const nr="attached",Ws="tools";let He=class extends Fr{constructor(e){super(e),this._manipulatorState=new qh,this.tools=new W,this.cursor=null,this._forEachTool=t=>{for(const s of this.tools.items)if(t(s))return}}initialize(){this.handles.add([this.view.on(va,e=>{this._handleInputEvent(e)},pt.TOOL),...Bh(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.detach(),this.handles.removeAll()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(M(e)&&!this.view.ready)return void V.getLogger(this.declaredClass).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const t=this.activeTool;this._set("activeTool",e),M(t)&&t.deactivate(),M(e)&&e.activate(),this._removeIncompleteTools(e);for(const s of this.tools){this._updateToolEditableFlag(s);const n=pn(s);!F(this.activeTool)&&n||this._manipulatorState.clearPointers(s,this._manipulatorStateEventArgs,!n)}this._updateCursor()}get updating(){var e;return this.updatingHandles.updating||this.tools.some(t=>t.updating)||(((e=this.textures)==null?void 0:e.updating)??!1)}attach(){var e;this.view.type==="3d"?(this._set("textures",new bi(this.view._stage,this.view.resourceController.scheduler)),this.handles.add([y(()=>{const{state:t}=this.view;return"camera"in t&&t.camera},()=>this._forEachManipulator(t=>t.onViewChange())),(e=this.view.elevationProvider)==null?void 0:e.on("elevation-change",t=>this._forEachManipulator(s=>s.onElevationChange(t))),Rr(()=>this._set("textures",re(this.textures)))],nr)):this.handles.add(y(()=>this.view.extent,()=>this._forEachManipulator(t=>t.onViewChange())))}detach(){M(this.activeTool)&&(this.activeTool=null),this.tools.removeAll(),this.handles.remove(nr)}_forEachManipulator(e){this._forEachTool(t=>{t.manipulators&&t.manipulators.forEach(({manipulator:s})=>e(s,t))})}_handleInputEvent(e){let t=!1;const s={...e,stopPropagation:()=>{t=!0,e.stopPropagation()}};M(this.activeTool)?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(s):this._forEachTool(n=>{!t&&n.visible&&n.handleInputEvent(s)}),!t&&e.type==="key-down"&&e.key==="Escape"&&this.activeTool&&(e.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(s,this._manipulatorStateEventArgs),!t&&M(this.activeTool)&&this.activeTool.handleInputEventAfter(s),this._manipulatorState.handleHoverEvent(s,this._forEachTool),this._updateCursor()}_refreshToolWatchers(){this.handles.remove(Ws),this._forEachTool(e=>{if(e instanceof D){const t=y(()=>[e.cursor,e.visible,e.editable],()=>{pn(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()});this.handles.add(t,Ws)}e.manipulators&&this.handles.add([e.manipulators.on("after-remove",t=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,t.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})],Ws)}),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){var t;(t=e.setEditableFlag)==null||t.call(e,Fi.MANAGER,F(this.activeTool)||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;F(e)&&this._forEachTool(t=>!(!M(t.cursor)||!t.visible)&&(e=t.cursor,!0)),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter(t=>(F(e)||t!==e)&&!t.created&&t.removeIncompleteOnCancel).forEach(t=>{this.tools.remove(t)})}};a([c({constructOnly:!0,nonNullable:!0})],He.prototype,"view",void 0),a([c({readOnly:!0,nonNullable:!0})],He.prototype,"textures",void 0),a([c({value:null})],He.prototype,"activeTool",null),a([c({readOnly:!0,type:W})],He.prototype,"tools",void 0),a([c({readOnly:!0})],He.prototype,"cursor",void 0),a([c({readOnly:!0})],He.prototype,"updating",null),He=a([I("esri.views.ToolViewManager")],He);const Hh=He;let Gt=class extends D{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":jh.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return Gh[this.deviceType]}};a([c({nonNullable:!0,readOnly:!0})],Gt.prototype,"nativeIndex",void 0),a([c({type:String,readOnly:!0})],Gt.prototype,"deviceType",null),a([c({type:Number,readOnly:!0})],Gt.prototype,"axisThreshold",null),Gt=a([I("esri.views.input.gamepad.GamepadInputDevice")],Gt);const jh=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),Gh={standard:.15,spacemouse:.025,unknown:0},Un=Gt;let Mi=class extends D{constructor(...e){super(...e),this.devices=new W,this.enabledFocusMode="document"}};a([c({type:W.ofType(Un),readOnly:!0})],Mi.prototype,"devices",void 0),a([c({type:["document","view","none"]})],Mi.prototype,"enabledFocusMode",void 0),Mi=a([I("esri.views.input.gamepad.GamepadSettings")],Mi);const Wh=Mi;let Xi=class extends D{constructor(){super(...arguments),this.gamepad=new Wh}};a([c({readOnly:!0})],Xi.prototype,"gamepad",void 0),Xi=a([I("esri.views.input.Input")],Xi);const Zh=Xi;let at=class extends D{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};a([c({type:Boolean,nonNullable:!0})],at.prototype,"enabled",void 0),a([c({type:Un})],at.prototype,"device",void 0),a([c({type:["pan","zoom"],nonNullable:!0})],at.prototype,"mode",void 0),a([c({type:["forward-down","forward-up"],nonNullable:!0})],at.prototype,"tiltDirection",void 0),a([c({type:Number,nonNullable:!0})],at.prototype,"velocityFactor",void 0),at=a([I("esri.views.navigation.gamepad.GamepadSettings")],at);const Ia=at;let bt=class extends D{constructor(e){super(e),this.browserTouchPanEnabled=!0,this.gamepad=new Ia,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0}};a([c({type:Boolean})],bt.prototype,"browserTouchPanEnabled",void 0),a([c({type:Ia,nonNullable:!0})],bt.prototype,"gamepad",void 0),a([c({type:Boolean})],bt.prototype,"momentumEnabled",void 0),a([c({type:Boolean})],bt.prototype,"mouseWheelZoomEnabled",void 0),bt=a([I("esri.views.navigation.Navigation")],bt);const Ca=bt;var or;function Kh(i){var s;const e=i.url?Ol(i.url):void 0;return!(((s=i.spatialReference)==null?void 0:s.vcsWkid)==null&&M(e)&&e.serverType==="ImageServer")&&Ta(i)&&i.heightModelInfo?i.heightModelInfo:Qh(i)?kn.deriveUnitFromSR(Xh,i.spatialReference):null}function Ta(i){return"heightModelInfo"in i}function xa(i){if(i.type==="unknown"||!("capabilities"in i))return!1;switch(i.type){case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function Qh(i){return xa(i)?!!(i.capabilities&&i.capabilities.data&&i.capabilities.data.supportsZ):Ea(i)}function Yh(i){return i.layers!=null||Ea(i)||xa(i)||Ta(i)}function Ea(i){switch(i.type){case"building-scene":case"elevation":case"integrated-mesh":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(i){i[i.Ok=0]="Ok",i[i.Units=1]="Units",i[i.HeightModel=2]="HeightModel",i[i.CRS=3]="CRS",i[i.Unsupported=4]="Unsupported"})(or||(or={}));const Xh=new kn({heightModel:"gravity-related-height"});let mn,Zs=null;async function Jh(i){Zs||(Zs=w(()=>import("./geometryServiceUtils-8e5e78da.js"),["assets/geometryServiceUtils-8e5e78da.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/project-f9f3947a.js","assets/utils-3b5f5c5a.js"]).then(e=>mn=e)),await Zs,ti(i)}async function ka(i,e,t,s){if(!i)return null;const n=i.spatialReference;return $i()||fs(n,e)?Li(i,e):mn?mn.projectGeometry(i,e,t,s):(await Promise.race([Jh(s),_s(s)]),ka(i,e,t,s))}let B=class extends D{constructor(e){super(e),this.required={tileInfo:!1,heightModelInfo:!1,extent:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=on(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return M(this.userSpatialReference)?this.userSpatialReference:be(this._spatialReferenceTask.spatialReference)}get extent(){return be(this._extentTask.extent)}get heightModelInfo(){return be(this._heightModelInfoTask.heightModelInfo)}get vcsWkid(){return be(this._heightModelInfoTask.vcsWkid)}get latestVcsWkid(){return be(this._heightModelInfoTask.latestVcsWkid)}get viewingMode(){return F(this.userSpatialReference)||this.userSpatialReference.equals(be(this._spatialReferenceTask.spatialReference))?be(this._spatialReferenceTask.viewingMode):null}get tileInfo(){return be(this._tileInfoTask.tileInfo)}get mapCollections(){var s,n,o,r;const e=(s=this.map)==null?void 0:s.call(this),t=[];return M(this.priorityCollection)&&t.push(this.priorityCollection),t.push({parent:e==null?void 0:e.basemap,layers:(n=e==null?void 0:e.basemap)==null?void 0:n.baseLayers},{layers:e==null?void 0:e.layers},{parent:e==null?void 0:e.ground,layers:(o=e==null?void 0:e.ground)==null?void 0:o.layers},{parent:e==null?void 0:e.basemap,layers:(r=e==null?void 0:e.basemap)==null?void 0:r.referenceLayers}),t}get _allLayers(){return this._collectLayers(this.mapCollections)}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};const{layers:e,updating:t}=this._allLayers;let s=null;for(const o of e){const r=this._getSupportedSpatialReferences(o);if(r.length>0){const l=this._narrowDownSpatialReferenceCandidates(s,r);M(l)&&(s=l)}if(M(s)&&s.length===1)break}if(t&&(F(s)||s.length!==1))return{updating:!0};const n=this._pickSpatialReferenceCandidate(s);return{spatialReference:M(n)?n.spatialReference:null,viewingMode:M(n)?n.viewingMode:null,updating:!1}}get _tileInfoTask(){var s,n,o,r,l,d,h;if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const{layers:e,updating:t}=this._collectLayers([{parent:(n=(s=this.map)==null?void 0:s.call(this))==null?void 0:n.basemap,layers:(l=(r=(o=this.map)==null?void 0:o.call(this))==null?void 0:r.basemap)==null?void 0:l.baseLayers},{layers:(h=(d=this.map)==null?void 0:d.call(this))==null?void 0:h.layers}]);if(e&&e.length>0&&"tileInfo"in e[0]){const u=e[0].tileInfo;return{tileInfo:u&&u.spatialReference.equals(this.spatialReference)?u:null,updating:!1}}return{updating:t}}get _heightModelInfoTask(){var s,n,o;if(!this.required.heightModelInfo||this.suspended&&((s=this._get("_heightModelInfoTask"))!=null&&s.heightModelInfo))return this._get("_heightModelInfoTask")??{updating:!1};const{layers:e,updating:t}=this._allLayers;for(const r of e)if(Yh(r)){const l=Kh(r);if(l)return{heightModelInfo:l,vcsWkid:(n=r.spatialReference)==null?void 0:n.vcsWkid,latestVcsWkid:(o=r.spatialReference)==null?void 0:o.latestVcsWkid,updating:!1}}return{updating:t}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=this._allLayers,t=e.updating,s=[];for(const n of e.layers){const o="fullExtents"in n&&n.fullExtents||(M(n.fullExtent)?[n.fullExtent]:[]),r=this.requiresExtentInSpatialReference?null:o[0],l=o.find(d=>d.spatialReference.equals(this.spatialReference))??r;if(l)return{candidates:[{extent:l,layer:n}],updating:!1};if(this._getSupportedSpatialReferences(n).length>0)for(const d of o)s.push({extent:d,layer:n})}return{candidates:s,updating:t}}get _extentTask(){const{candidates:e,updating:t}=this._extentCandidatesTask;if(t)return{updating:t};if(F(e)||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const s=this._pickExtentCandidate(e),n=this.spatialReference;return s.extent.equals(this._projectExtentTask.input)&&n.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:M(this._projectExtentTask.task)&&!this._projectExtentTask.task.finished}:(M(this._projectExtentTask.task)&&(this._projectExtentTask.task=on(this._projectExtentTask.task)),this._projectExtentTask={input:s.extent.clone(),output:null,spatialReference:n.clone(),task:Lr(async o=>{try{const r=await ka(s.extent,n,s.layer.portalItem,o);this._projectExtentTask={...this._projectExtentTask,task:null,output:r}}catch{if(Vl(o))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,t){if(F(e))return t;const s=[],n=(o,r)=>M(o)?M(r)?o===r&&o:o:r;for(const o of e)for(const r of t){if(!o.spatialReference.equals(r.spatialReference))continue;const l=n(o.viewingMode,r.viewingMode);if(l!==!1){s.push({spatialReference:o.spatialReference,viewingMode:l});break}}return s.length>0?s:null}_pickSpatialReferenceCandidate(e){const t=this.defaultSpatialReference;return F(e)||e.length<1?M(t)?{spatialReference:t,viewingMode:null}:null:(M(t)&&e.length>1&&e.some(({spatialReference:s})=>s.equals(t))&&(e=e.filter(({spatialReference:s})=>s.equals(t))),e.length>1&&e.some(({viewingMode:s})=>s!==po.Local)&&(e=e.filter(({viewingMode:s})=>s!==po.Local)),e[0])}_getSupportedSpatialReferences(e){const t="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(t.length===0)return[];const s=[];for(const n of t){const o=this.getSpatialReferenceSupport({spatialReference:n,layer:e});if(M(o)){const r=M(o.constraints)?o.constraints:[{spatialReference:n,viewingMode:null}];for(const{spatialReference:l,viewingMode:d}of r)(!this.requiresExtentInSpatialReference||F(this.userSpatialReference)||l.equals(this.userSpatialReference))&&s.push({spatialReference:l,viewingMode:d})}}return s}_pickExtentCandidate(e){const t=this.spatialReference;return e.find(({extent:s})=>t.equals(s.spatialReference))||e[0]}_collectLayers(e){var s;if(this._loadMaybe((s=this.map)==null?void 0:s.call(this))!=="loaded")return{layers:[],updating:!0};const t={layers:[],preloading:-1,updating:!1};for(const n of e)if(this._collectCollection(n,t),t.preloading===this.sourcePreloadCount)break;return{layers:t.layers,updating:t.updating}}_collectCollection(e,t){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return t.updating=!0,void++t.preloading;case"failed":return}for(const s of e.layers){switch(this._loadMaybe(s)){case"failed":continue;case"loading":t.updating=!0,++t.preloading;break;case"loaded":t.updating||t.layers.push(s),"layers"in s&&this._collectCollection({layers:s.layers},t)}if(t.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e&&e.loadStatus!=null?e.loadStatus==="not-loaded"?(e.load().catch(()=>{}),"loading"):e.loadStatus:"loaded"}};a([c()],B.prototype,"required",void 0),a([c({constructOnly:!0})],B.prototype,"map",void 0),a([c({constructOnly:!0})],B.prototype,"getSpatialReferenceSupport",void 0),a([c()],B.prototype,"defaultSpatialReference",void 0),a([c()],B.prototype,"userSpatialReference",void 0),a([c()],B.prototype,"sourcePreloadCount",void 0),a([c()],B.prototype,"priorityCollection",void 0),a([c()],B.prototype,"requiresExtentInSpatialReference",void 0),a([c()],B.prototype,"suspended",void 0),a([c({readOnly:!0})],B.prototype,"ready",null),a([c({readOnly:!0})],B.prototype,"heightModelInfoReady",null),a([c({readOnly:!0})],B.prototype,"spatialReference",null),a([c({readOnly:!0})],B.prototype,"extent",null),a([c({readOnly:!0})],B.prototype,"heightModelInfo",null),a([c({readOnly:!0})],B.prototype,"vcsWkid",null),a([c({readOnly:!0})],B.prototype,"latestVcsWkid",null),a([c({readOnly:!0})],B.prototype,"viewingMode",null),a([c({readOnly:!0})],B.prototype,"tileInfo",null),a([c({readOnly:!0})],B.prototype,"mapCollections",null),a([c({readOnly:!0})],B.prototype,"_allLayers",null),a([c({readOnly:!0})],B.prototype,"_spatialReferenceTask",null),a([c({readOnly:!0})],B.prototype,"_tileInfoTask",null),a([c({readOnly:!0})],B.prototype,"_heightModelInfoTask",null),a([c({readOnly:!0})],B.prototype,"_extentCandidatesTask",null),a([c()],B.prototype,"_extentTask",null),a([c()],B.prototype,"_projectExtentTask",void 0),B=a([I("esri.views.support.DefaultsFromMap")],B);var Ji;let E=Ji=class extends ms(xn.EventedMixin(Nl(D))){constructor(i){super(i),this._userSpatialReference=null,this._cursor=null,this.allLayerViews=new zr({getCollections:()=>{var e,t,s;return[(e=this.basemapView)==null?void 0:e.baseLayerViews,(t=this.groundView)==null?void 0:t.layerViews,this.layerViews,(s=this.basemapView)==null?void 0:s.referenceLayerViews]},getChildrenFunction:e=>e.layerViews}),this.groundView=null,this.basemapView=null,this.fatalError=null,this.graphics=new jr,this.analyses=new ps,this.typeSpecificPreconditionsReady=!0,this.layerViews=new W,this.magnifier=new ya,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.timeReference=new Sr,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new Zh,this.navigation=new Ca,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new Nh(this),this.persistableViewModels=new W,this._isValid=!1,this._readyCycleForced=!1,this._currentSpatialReference=null,this.handles.add(y(()=>this.preconditionsReady,e=>{var t,s;e?(this._currentSpatialReference=this.spatialReference,Ji.views.add(this)):(this._currentSpatialReference=null,Ji.views.remove(this)),this.notifyChange("spatialReference"),!e&&this.ready?((t=this.toolViewManager)==null||t.detach(),M(this.analysisViewManager)&&this.analysisViewManager.detach(),(s=this.layerViewManager)==null||s.clear(),this._teardown()):e&&!this.ready&&(this._startup(),M(this.analysisViewManager)&&this.analysisViewManager.attach(),this.toolViewManager.attach())},ki))}initialize(){this.addResolvingPromise(this.validate().then(()=>(this._isValid=!0,En(()=>this.ready)))),this.basemapView=new rt({view:this}),this.layerViewManager=new Dh({view:this,layerViewImporter:{importLayerView:i=>this.importLayerView(i),hasLayerViewModule:i=>this.hasLayerViewModule(i)},supportsGround:this.supportsGround}),this.toolViewManager=new Hh({view:this}),this._setupSpatialReferenceLogger(),this.handles.add([y(()=>this.initialExtentRequired,i=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:i},{sync:!0,initial:!0}),y(()=>this.ready,i=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=i,this.defaultsFromMap.userSpatialReference=i?this.spatialReference:this._userSpatialReference)},{sync:!0}),y(()=>this._userSpatialReference,i=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=i)},{sync:!0,initial:!0})])}_setupSpatialReferenceLogger(){let i=null;this.handles.add([y(()=>{var e;return(e=this.defaultsFromMap)==null?void 0:e.ready},e=>{var s;const t=((s=this.map)==null?void 0:s.allLayers.length)>0;if(e&&!this.spatialReference&&t){if(M(i))return;const n=Rr(()=>i=on(i));i=Lr(async o=>{try{await Tn(this.spatialReferenceWarningDelay,null,o)}catch{return}finally{i=null}V.getLogger(this.declaredClass).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),this.handles.add(n,"spatial-reference-logger-task")}else this.handles.remove("spatial-reference-logger-task")},{sync:!0})])}destroy(){if(this.destroyed)return;this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=re(this.graphics),this.analyses=re(this.analyses),this.handles.remove("defaultsFromMap"),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),re(this.analysisViewManager),this.toolViewManager=re(this.toolViewManager),this.layerViewManager=re(this.layerViewManager),this.basemapView=re(this.basemapView),this.invalidate(),this._emitter.clear(),this.handles.removeAll();const i=this.map;this.map=null,i==null||i.destroy()}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return V.getLogger(this.declaredClass).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){var i;return(i=this.toolViewManager)==null?void 0:i.activeTool}set activeTool(i){this.toolViewManager&&(this.toolViewManager.activeTool=i)}get animation(){return this._get("animation")}set animation(i){this._set("animation",i)}get center(){return null}get _defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new B({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:i=>this.getSpatialReferenceSupport(i),...this._defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(i){this._set("extent",i)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){var i;return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||io.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._currentSpatialReference&&!((i=this.defaultsFromMap)!=null&&i.ready)||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(i){i!==this._get("map")&&(i!=null&&i.destroyed&&(V.getLogger(this.declaredClass).warn("#map","The provided map is already destroyed",{map:i}),i=null),io.isLoadable(i)&&i.load().catch(()=>{}),this.constructed&&(this.forceReadyCycle(),this._currentSpatialReference=null),this._set("map",i))}get spatialReference(){var e,t;let i=this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null;return i&&((t=(e=this.defaultsFromMap)==null?void 0:e.required)!=null&&t.heightModelInfo)&&(i=i.clone(),i.vcsWkid=this.defaultsFromMap.vcsWkid,i.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),i}set spatialReference(i){const e=!ys(i,this._get("spatialReference"));this._set("_userSpatialReference",i),e&&(this._set("spatialReference",i),this._spatialReferenceChanged(i))}_spatialReferenceChanged(i){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get tools(){var i;return(i=this.toolViewManager)==null?void 0:i.tools}get initialExtent(){var i;return(i=this.defaultsFromMap)==null?void 0:i.extent}get cursor(){const i=this.toolViewManager?this.toolViewManager.cursor:null;return M(i)?i:this._cursor||"default"}set cursor(i){this._cursor=i,this.notifyChange("cursor")}get size(){return[this.width,this.height]}whenLayerView(i){return this.layerViewManager.whenLayerView(i)}getDefaultSpatialReference(){var i;return(i=this.defaultsFromMap)==null?void 0:i.spatialReference}getDefaultHeightModelInfo(){var i;return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??((i=this.defaultsFromMap)==null?void 0:i.heightModelInfo)??null}importLayerView(i){throw new k("importLayerView() not implemented")}hasLayerViewModule(i){return!1}async validate(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(i){return M(this.getSpatialReferenceSupport({spatialReference:i}))}when(i,e){return this.isResolved()&&!this.ready&&V.getLogger(this.declaredClass).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(i,e)}forceReadyCycle(){this.ready&&(Qe(()=>this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(i){this.toolViewManager.tools.add(i),this.activeTool=i}tryFatalErrorRecovery(){this.fatalError=null}};E.views=new W,a([c()],E.prototype,"_userSpatialReference",void 0),a([c()],E.prototype,"activeTool",null),a([c({readOnly:!0})],E.prototype,"allLayerViews",void 0),a([c()],E.prototype,"groundView",void 0),a([c()],E.prototype,"animation",null),a([c()],E.prototype,"basemapView",void 0),a([c()],E.prototype,"center",null),a([c({readOnly:!0})],E.prototype,"_defaultsFromMapSettings",null),a([c()],E.prototype,"defaultsFromMap",null),a([c()],E.prototype,"fatalError",void 0),a([c({type:oi})],E.prototype,"extent",null),a([c(uo(jr,"graphics"))],E.prototype,"graphics",void 0),a([c(uo(ps,"analyses"))],E.prototype,"analyses",void 0),a([c({readOnly:!0,type:kn})],E.prototype,"heightModelInfo",null),a([c({readOnly:!0})],E.prototype,"interacting",null),a([c({readOnly:!0})],E.prototype,"navigating",null),a([c({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_currentSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],E.prototype,"preconditionsReady",null),a([c({readOnly:!0})],E.prototype,"typeSpecificPreconditionsReady",void 0),a([c({type:W,readOnly:!0})],E.prototype,"layerViews",void 0),a([c()],E.prototype,"resolution",null),a([c({type:ya})],E.prototype,"magnifier",void 0),a([c({value:null,type:mc})],E.prototype,"map",null),a([c()],E.prototype,"padding",void 0),a([c({readOnly:!0})],E.prototype,"ready",void 0),a([c({type:$n})],E.prototype,"spatialReference",null),a([c()],E.prototype,"spatialReferenceWarningDelay",void 0),a([c()],E.prototype,"stationary",null),a([c({readOnly:!0})],E.prototype,"supportsGround",void 0),a([c({type:zl})],E.prototype,"timeExtent",void 0),a([c({type:Sr,nonNullable:!0})],E.prototype,"timeReference",void 0),a([c()],E.prototype,"tools",null),a([c()],E.prototype,"toolViewManager",void 0),a([c({readOnly:!0})],E.prototype,"type",void 0),a([c({type:Number})],E.prototype,"scale",void 0),a([c({readOnly:!0})],E.prototype,"updating",void 0),a([c({readOnly:!0})],E.prototype,"initialExtentRequired",void 0),a([c({readOnly:!0})],E.prototype,"initialExtent",null),a([c()],E.prototype,"cursor",null),a([c({readOnly:!0})],E.prototype,"input",void 0),a([c({type:Ca,nonNullable:!0})],E.prototype,"navigation",void 0),a([c()],E.prototype,"layerViewManager",void 0),a([c()],E.prototype,"analysisViewManager",void 0),a([c()],E.prototype,"width",void 0),a([c()],E.prototype,"height",void 0),a([c({readOnly:!0})],E.prototype,"resizing",void 0),a([c({value:null,readOnly:!0})],E.prototype,"size",null),a([c({readOnly:!0})],E.prototype,"suspended",void 0),a([c({readOnly:!0})],E.prototype,"viewEvents",void 0),a([c({readOnly:!0})],E.prototype,"persistableViewModels",void 0),a([c()],E.prototype,"_isValid",void 0),a([c()],E.prototype,"_readyCycleForced",void 0),a([c()],E.prototype,"_currentSpatialReference",void 0),E=Ji=a([I("esri.views.View")],E);const eu=E;let lt=class extends Bl{constructor(e){super(e),this.state="running",this.target=null,this._dfd=null}initialize(){this.addResolvingPromise(new Promise((e,t)=>this._dfd={resolve:e,reject:t}))}get done(){return this.state==="finished"||this.state==="stopped"}stop(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),(e=this._dfd)==null||e.reject(new k("ViewAnimation stopped")))}finish(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),(e=this._dfd)==null||e.resolve())}update(e,t){t||(t=ql(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",t)}};a([c({readOnly:!0})],lt.prototype,"done",null),a([c({readOnly:!0,type:String})],lt.prototype,"state",void 0),a([c()],lt.prototype,"target",void 0),lt=a([I("esri.views.ViewAnimation")],lt),function(i){i.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(lt||(lt={}));const gn=lt;function mt(){return[1,0,0,1,0,0]}function tu(i){return[i[0],i[1],i[2],i[3],i[4],i[5]]}function iu(i,e,t,s,n,o){return[i,e,t,s,n,o]}function su(i,e){return new Float64Array(i,e,6)}Object.freeze(Object.defineProperty({__proto__:null,clone:tu,create:mt,createView:su,fromValues:iu},Symbol.toStringTag,{value:"Module"}));const $a=96,Pa=39.37,nu=180/Math.PI;function Aa(i){return i.wkid?i:i.spatialReference||$n.WGS84}function Hn(i,e){return e.type?ne(i,e.x,e.y):cs(i,e)}function Fa(i){return Ul(i)}function Ei(i,e){const t=Math.max(1,e[0]),s=Math.max(1,e[1]);return Math.max(i.width/t,i.height/s)*pu(i.spatialReference)}async function Ii(i,e,t,s){let n,o;if(!i||Array.isArray(i)&&!i.length)return null;if(W.isCollection(i)&&(i=i.toArray()),Array.isArray(i)&&i.length&&typeof i[0]=="object"){const l=i.every(u=>"attributes"in u),d=i.some(u=>!u.geometry);let h=i;if(l&&d&&e&&e.allLayerViews){const u=new Map;for(const b of i){const C=b.layer,P=u.get(C)||[],A=b.attributes[C.objectIdField];A!=null&&P.push(A),u.set(C,P)}const p=[];u.forEach((b,C)=>{const P=e.allLayerViews.find(A=>A.layer.id===C.id);if(P&&"queryFeatures"in P){const A=C.createQuery();A.objectIds=b,A.returnGeometry=!0,p.push(P.queryFeatures(A))}});const g=await Promise.all(p),f=[];for(const b of g)if(b&&b.features&&b.features.length)for(const C of b.features)M(C.geometry)&&f.push(C.geometry);h=f}for(const u of h)s=await Ii(u,e,t,s);return s}if(Array.isArray(i)&&i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number")n=new se(i);else if(i instanceof Hl)n=i;else if("geometry"in i){if(i.geometry)n=i.geometry;else if(i.layer){const l=i.layer,d=e.allLayerViews.find(h=>h.layer.id===l.id);if(d&&"queryFeatures"in d){const h=l.createQuery();h.objectIds=[i.attributes[l.objectIdField]],h.returnGeometry=!0;const u=await d.queryFeatures(h);n=jl(u,"features",0,"geometry")}}}if(F(n)||(o=n.type==="point"?new oi({xmin:n.x,ymin:n.y,xmax:n.x,ymax:n.y,spatialReference:n.spatialReference}):n.extent,!o))return null;$i()||fs(o.spatialReference,t)||await _s();const r=Li(o,t);return r?s=s?s.union(r):r:null}function ou(i){if(i&&(!Array.isArray(i)||typeof i[0]!="number")&&(typeof i=="object"||Array.isArray(i)&&typeof i[0]=="object")){if("layer"in i&&i.layer&&i.layer.minScale&&i.layer.maxScale){const e=i.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(i)&&i.length&&i.every(e=>"layer"in e)){let e=0,t=0;for(const s of i){const n=s.layer;n&&n.minScale&&n.maxScale&&(e=n.minScale<e?n.minScale:e,t=n.maxScale>t?n.maxScale:t)}return e&&t?{min:e,max:t}:null}}}function Ks(i,e){return ys(Aa(i),e)?i:Li(i,e)}async function ru(i,e){if(!i||!e)return new Oe({targetGeometry:new se,scale:0,rotation:0});let t=e.spatialReference;const{constraints:s,padding:n,viewpoint:o,size:r}=e,l=[n?r[0]-n.left-n.right:r[0],n?r[1]-n.top-n.bottom:r[1]];let d=null;i instanceof Oe?d=i:i.viewpoint?d=i.viewpoint:i.target&&i.target.declaredClass==="esri.Viewpoint"&&(d=i.target);let h=null;d&&d.targetGeometry?h=d.targetGeometry:i instanceof oi?h=i:(i||i&&("center"in i||"extent"in i||"target"in i))&&(h=await Ii(i.center,e,t)||await Ii(i.extent,e,t)||await Ii(i.target,e,t)||await Ii(i,e,t)),!h&&o&&o.targetGeometry?h=o.targetGeometry:!h&&e.extent&&(h=e.extent),t||(t=Aa(e.spatialReference||e.extent||h)),$i()||ys(h.spatialReference,t)||fs(h,t)||await _s();const u=Ks(h.center?h.center:h,t);let p=0;if(d&&M(d.targetGeometry)&&d.targetGeometry.type==="point")p=d.scale;else if("scale"in i&&i.scale)p=i.scale;else if("zoom"in i&&i.zoom!==-1&&s&&s.effectiveLODs)p=s.zoomToScale(i.zoom);else if(Array.isArray(h)||h.type==="point"||h.type==="extent"&&h.width===0&&h.height===0){const C=Ks(e.extent,t);p=M(C)?Ei(C,l):e.extent?Ei(e.extent,l):o.scale}else p=Ei(Ks(h.extent,t),l);const g=ou(i);g&&(g.min&&g.min>p?p=g.min:g.max&&g.max<p&&(p=g.max));let f=0;d?f=d.rotation:i.hasOwnProperty("rotation")?f=i.rotation:o&&(f=o.rotation);let b=new Oe({targetGeometry:u,scale:p,rotation:f});return s&&(b=s.fit(b),s.constrainByGeometry(b),s.rotationEnabled||(b.rotation=f)),b}function Ee(i,e){const t=i.targetGeometry,s=e.targetGeometry;return t.x=s.x,t.y=s.y,t.spatialReference=s.spatialReference,i.scale=e.scale,i.rotation=e.rotation,i}function au(i,e,t){return t?ne(i,.5*(e[0]-t.right+t.left),.5*(e[1]-t.bottom+t.top)):ws(i,e,.5)}const lu=function(){const i=J();return function(e,t,s){const n=t.targetGeometry;Hn(i,n);const o=.5*ri(t);return e.xmin=i[0]-o*s[0],e.ymin=i[1]-o*s[1],e.xmax=i[0]+o*s[0],e.ymax=i[1]+o*s[1],e.spatialReference=n.spatialReference,e}}();function cu(i,e,t,s,n){return fn(i,e,t.center),i.scale=Ei(t,s),n&&n.constraints&&n.constraints.constrain(i),i}function du(i,e,t,s){return Wn(i,e,t,s),Zr(i,i)}const Ra=function(){const i=J();return function(e,t,s){return Kr(e,mu(e,t),au(i,t,s))}}(),hu=function(){const i=mt(),e=J();return function(t,s,n,o){const r=ri(s),l=jn(s);return ne(e,r,r),yc(i,e),Fn(i,i,l),ls(i,i,Ra(e,n,o)),ls(i,i,[0,o.top-o.bottom]),ne(t,i[4],i[5])}}();function ri(i){return i.scale*uu(i.targetGeometry)}function uu(i){return M(i)&&Dr(i.spatialReference)?1/(Fa(i.spatialReference)*Pa*$a):1}function jn(i){return Or(i.rotation)||0}function pu(i){return Dr(i)?Fa(i)*Pa*$a:1}function mu(i,e){return ws(i,e,.5)}const Gn=function(){const i=J(),e=J(),t=J();return function(s,n,o,r,l,d){return Mc(i,n),ws(e,o,.5*d),ne(t,1/r*d,-1/r*d),Wr(s,e),l&&Fn(s,s,l),Gr(s,s,t),ls(s,s,i),s}}(),Wn=function(){const i=J();return function(e,t,s,n){const o=ri(t),r=jn(t);return Hn(i,t.targetGeometry),Gn(e,i,s,o,r,n)}}(),gu=function(){const i=J();return function(e,t,s,n){const o=ri(t);return Hn(i,t.targetGeometry),Gn(e,i,s,o,0,n)}}();function fu(i){const e=Gl(i);return e?e.valid[1]-e.valid[0]:0}function _u(i,e){return Math.round(fu(i)/e)}const yu=function(){const i=J(),e=J(),t=[0,0,0];return function(s,n,o){ln(i,s,n),mo(i,i),ln(e,s,o),mo(e,e),wc(t,i,e);let r=Math.acos(bc(i,e)/(go(i)*go(e)))*nu;return t[2]<0&&(r=-r),isNaN(r)&&(r=0),r}}(),vu=function(){const i=J();return function(e,t,s,n){const o=e.targetGeometry;return Ee(e,t),hu(i,t,s,n),o.x+=i[0],o.y+=i[1],e}}(),fn=function(i,e,t){Ee(i,e);const s=i.targetGeometry;return s.x=t.x,s.y=t.y,s.spatialReference=t.spatialReference,i},wu=function(){const i=J();return function(e,t,s,n,o){o||(o="center"),Kr(i,s,n),ws(i,i,.5);const r=i[0],l=i[1];switch(o){case"center":ne(i,0,0);break;case"left":ne(i,-r,0);break;case"top":ne(i,0,l);break;case"right":ne(i,r,0);break;case"bottom":ne(i,0,-l);break;case"top-left":ne(i,-r,l);break;case"bottom-left":ne(i,-r,-l);break;case"top-right":ne(i,r,l);break;case"bottom-right":ne(i,r,-l)}return Ts(e,t,i),e}}();function wg(i,e,t){return Ee(i,e),i.rotation+=t,i}function bu(i,e,t){return Ee(i,e),i.rotation=t,i}const Mu=function(){const i=J();return function(e,t,s,n,o){return Ee(e,t),isNaN(s)||s===0||(Sa(i,n,t,o),e.scale=t.scale*s,Da(i,i,e,o),Ts(e,e,ne(i,i[0]-n[0],n[1]-i[1]))),e}}();function rr(i,e,t){return Ee(i,e),i.scale=t,i}const La=function(){const i=J();return function(e,t,s,n,o,r){return Ee(e,t),isNaN(s)||s===0||(Sa(i,o,t,r),e.scale=t.scale*s,e.rotation+=n,Da(i,i,e,r),Ts(e,e,ne(i,i[0]-o[0],o[1]-i[1]))),e}}(),bg=function(){const i=J(),e=J();return function(t,s,n,o,r,l,d){return Ra(e,l,d),Ic(i,r,e),o?La(t,s,n,o,i,l):Mu(t,s,n,i,l)}}(),Sa=function(){const i=mt();return function(e,t,s,n){return We(e,t,du(i,s,n,1))}}(),Da=function(){const i=mt();return function(e,t,s,n){return We(e,t,Wn(i,s,n,1))}}(),Ts=function(){const i=J(),e=mt();return function(t,s,n){Ee(t,s);const o=ri(s),r=t.targetGeometry;return _c(e,jn(s)),Gr(e,e,Tc(o,o)),We(i,n,e),r.x+=i[0],r.y+=i[1],t}}();let Iu=class{constructor(e,t,s,n){const o=e.targetGeometry,r=t.targetGeometry;n?typeof n=="string"&&(n=fc(n)||an.ease):n=an.ease,this.easing=n,this.duration=s,this.sCenterX=o.x,this.sCenterY=o.y,this.sScale=e.scale,this.sRotation=e.rotation,this.tCenterX=r.x,this.tCenterY=r.y,this.tScale=t.scale,this.tRotation=t.rotation,this.dCenterX=this.tCenterX-this.sCenterX,this.dCenterY=this.tCenterY-this.sCenterY,this.dScale=this.tScale-this.sScale,this.dRotation=this.tRotation-this.sRotation,this.dRotation>180?this.dRotation-=360:this.dRotation<-180&&(this.dRotation+=360)}applyRatio(e,t){const s=this.easing(t);let n,o,r,l;t>=1?(n=this.tCenterX,o=this.tCenterY,r=this.tRotation,l=this.tScale):(n=this.sCenterX+s*this.dCenterX,o=this.sCenterY+s*this.dCenterY,r=this.sRotation+s*this.dRotation,l=this.sScale+s*this.dScale),e.targetGeometry.x=n,e.targetGeometry.y=o,e.scale=l,e.rotation=r}},je=class extends D{constructor(e){super(e),this.updateFunction=null,this.animation=null,this.duration=200,this.transition=null,this.easing=an.ease,this.view=null,this.viewpoint=new Oe({targetGeometry:new se,scale:0,rotation:0}),this._updateTask=ni({postRender:this._postRender.bind(this)}),this._updateTask.pause()}destroy(){this._updateTask=Ye(this._updateTask)}animate(e,t,s){this.stop();const n=this.viewpoint;Ee(n,t),this.transition=new Iu(this.viewpoint,e.target,s&&s.duration||this.duration,s&&s.easing||this.easing);const o=()=>{var r,l;this.animation===e&&this._updateTask&&(e.state==="finished"&&((r=this.transition)==null||r.applyRatio(this.viewpoint,1),(l=this.view)!=null&&l.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(o,o),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinous(e,t){this.stop(),this.updateFunction=t,this.viewpoint=e;const s=new gn({target:e.clone()}),n=()=>{this.animation===s&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return s.when(n,n),this._startTime=performance.now(),this._updateTask.resume(),this.animation=s,s}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){var s,n;const t=this.animation;if(t&&t.state!==gn.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime);else{const o=this.transition,r=(performance.now()-this._startTime)/o.duration,l=r>=1;o.applyRatio(this.viewpoint,r),l&&((s=this.animation)==null||s.finish())}(n=this.view)!=null&&n.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};a([c()],je.prototype,"animation",void 0),a([c()],je.prototype,"duration",void 0),a([c()],je.prototype,"transition",void 0),a([c()],je.prototype,"easing",void 0),a([c()],je.prototype,"view",void 0),a([c()],je.prototype,"viewpoint",void 0),je=a([I("esri.views.2d.AnimationManager")],je);const Cu=je;let Tu=class{constructor(e){this.view=e,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this.stationary=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions)},this.update=()=>{var l;this._updateRequested=!1;const{basemapView:t,graphicsView:s,labelManager:n,layerViews:o,state:{id:r}}=this.view;t==null||t.baseLayerViews.forEach(this._updateLayerView,this),o.forEach(this._updateLayerView,this),t==null||t.referenceLayerViews.forEach(this._updateLayerView,this),M(n)&&(n.lastUpdateId!==r&&(n.viewChange(),n.lastUpdateId=r),n.updateRequested&&n.processUpdate(this._updateParameters)),M(s)&&(s.lastUpdateId!==r&&(s.viewChange(),s.lastUpdateId=r),s.updateRequested&&s.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.animationInProgress||this._updateRequested||((l=this._frameTaskHandle)==null||l.pause())}}destroy(){this.stop()}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=y(()=>e.stationary,t=>{this.stationary=t,this.requestFrame()}),this._frameTaskHandle=ni(this),this.requestUpdate()}stop(){var e;this._frameTaskHandle&&(this._updateRequested=!1,(e=this._stationaryHandle)==null||e.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){if(!e.attached)return void this.requestUpdate();const t=this.view.state,s=e.lastUpdateId;s!=null&&(this.stationary||e.moving)||(e.moving=!0,e.moveStart()),s!==t.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=t.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews.forEach(this._updateLayerView,this)}};function K(){return Promise.all([w(()=>import("./webglDeps-e5251b5b.js"),["assets/webglDeps-e5251b5b.js","assets/VertexArrayObject-07c1da56.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/enums-64ab819c.js","assets/ProgramTemplate-9f1c124b.js","assets/programUtils-8e54bcd5.js","assets/NestedMap-1b5db22e.js"]),w(()=>import("./mapViewDeps-6c8c863b.js"),["assets/mapViewDeps-6c8c863b.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/CIMResourceManager-5e539063.js","assets/Rasterizer-7c00bea5.js","assets/_commonjsHelpers-2f3e7994.js","assets/cimAnalyzer-02b56dc2.js","assets/fontUtils-afce1abc.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-5c57438c.js","assets/GeometryUtils-fea59923.js","assets/enums-55085e26.js","assets/utils-bd924f31.js","assets/alignmentUtils-ae955d28.js","assets/definitions-f329b961.js","assets/mat2d-e11be45e.js","assets/vec2-bbd3449a.js","assets/TileStrategy-1967197e.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/TileKey-b1f5cdb9.js","assets/number-b10bd8f5.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-193e54d0.js","assets/floatRGBA-4f7fa53a.js","assets/rasterizingUtils-74cec9f6.js","assets/imageutils-b0a7b4c6.js","assets/Container-72cba08e.js","assets/EffectView-a1fb6514.js","assets/enums-64ab819c.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/BufferPool-34e9b674.js","assets/color-6aec3839.js","assets/VertexElementDescriptor-2925c6af.js","assets/WGLContainer-e2488f5a.js","assets/VertexArrayObject-07c1da56.js","assets/ProgramTemplate-9f1c124b.js","assets/MaterialKey-5b247dd4.js","assets/utils-7263c34f.js","assets/StyleDefinition-fbc907c2.js","assets/config-1337d16e.js","assets/GeometryUtils-dd03fc25.js","assets/earcut-61f7b102.js","assets/vec2f64-22afc56f.js","assets/featureConversionUtils-c00360ef.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/enums-fb086c25.js","assets/programUtils-8e54bcd5.js","assets/NestedMap-1b5db22e.js","assets/MagnifierPrograms-65f59e80.js","assets/pbf-f46def03.js","assets/Matcher-10c827e6.js","assets/visualVariablesUtils-50880e5a.js","assets/visualVariablesUtils-7dbd5d40.js","assets/tileUtils-c2f19f52.js","assets/TurboLine-0c6b5b1e.js","assets/ExpandedCIM-2a6dd26b.js","assets/devEnvironmentUtils-5002a058.js","assets/CircularArray-3a8652cf.js","assets/webgl-debug-b1f7a2c5.js","assets/ComputedAttributeStorage-b555102a.js","assets/arcadeTimeUtils-ef4a84e4.js","assets/executionError-fb3f283a.js","assets/centroid-335ed93e.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/RenderingContext-b944f363.js","assets/OrderIndependentTransparency-e1b3a745.js","assets/basicInterfaces-b7051eb1.js","assets/doublePrecisionUtils-e3c3d0d8.js","assets/mat3-21bcfd83.js","assets/imageUtils-c2d0d1ae.js","assets/GraphicsView2D-734762b1.js","assets/normalizeUtilsSync-f1c7dfdb.js","assets/normalizeUtilsCommon-258cba9f.js","assets/projectionSupport-60e6d2f8.js","assets/json-48e3ea08.js","assets/AttributeStoreView-bcdc844b.js","assets/TiledDisplayObject-accbee08.js","assets/schemaUtils-9a6e7dda.js","assets/createSymbolSchema-21e81f0c.js","assets/util-e5019f71.js","assets/normalizeUtils-703059af.js","assets/utils-3b5f5c5a.js","assets/GraphicContainer-c8c09d12.js","assets/BaseGraphicContainer-862908ea.js","assets/FeatureContainer-86576b95.js","assets/TileContainer-842f76b1.js","assets/vec3f32-ad1dc57f.js","assets/requestImageUtils-4fdc8d80.js","assets/CollectionFlattener-459cb615.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/colorUtils-c0f43caf.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/executeQueryJSON-ca6c73e1.js","assets/query-d95b3dd5.js","assets/pbfQueryUtils-06c77b54.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/GraphicsCollection-b80722b0.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js"])])}const pi=()=>K().then(()=>w(()=>import("./TileLayerView2D-a4a57439.js"),["assets/TileLayerView2D-a4a57439.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/GraphicsCollection-b80722b0.js","assets/Rasterizer-7c00bea5.js","assets/_commonjsHelpers-2f3e7994.js","assets/cimAnalyzer-02b56dc2.js","assets/fontUtils-afce1abc.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-5c57438c.js","assets/GeometryUtils-fea59923.js","assets/enums-55085e26.js","assets/utils-bd924f31.js","assets/alignmentUtils-ae955d28.js","assets/definitions-f329b961.js","assets/mat2d-e11be45e.js","assets/vec2-bbd3449a.js","assets/TileStrategy-1967197e.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/TileKey-b1f5cdb9.js","assets/number-b10bd8f5.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-193e54d0.js","assets/floatRGBA-4f7fa53a.js","assets/rasterizingUtils-74cec9f6.js","assets/EffectView-a1fb6514.js","assets/Container-72cba08e.js","assets/enums-64ab819c.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/BufferPool-34e9b674.js","assets/color-6aec3839.js","assets/VertexElementDescriptor-2925c6af.js","assets/WGLContainer-e2488f5a.js","assets/VertexArrayObject-07c1da56.js","assets/ProgramTemplate-9f1c124b.js","assets/MaterialKey-5b247dd4.js","assets/utils-7263c34f.js","assets/StyleDefinition-fbc907c2.js","assets/config-1337d16e.js","assets/GeometryUtils-dd03fc25.js","assets/earcut-61f7b102.js","assets/vec2f64-22afc56f.js","assets/featureConversionUtils-c00360ef.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/enums-fb086c25.js","assets/MagnifierPrograms-65f59e80.js","assets/pbf-f46def03.js","assets/imageutils-b0a7b4c6.js","assets/Matcher-10c827e6.js","assets/visualVariablesUtils-50880e5a.js","assets/visualVariablesUtils-7dbd5d40.js","assets/tileUtils-c2f19f52.js","assets/TurboLine-0c6b5b1e.js","assets/ExpandedCIM-2a6dd26b.js","assets/devEnvironmentUtils-5002a058.js","assets/CircularArray-3a8652cf.js","assets/webgl-debug-b1f7a2c5.js","assets/ComputedAttributeStorage-b555102a.js","assets/arcadeTimeUtils-ef4a84e4.js","assets/executionError-fb3f283a.js","assets/centroid-335ed93e.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/OrderIndependentTransparency-e1b3a745.js","assets/basicInterfaces-b7051eb1.js","assets/GraphicsView2D-734762b1.js","assets/normalizeUtilsSync-f1c7dfdb.js","assets/normalizeUtilsCommon-258cba9f.js","assets/projectionSupport-60e6d2f8.js","assets/json-48e3ea08.js","assets/AttributeStoreView-bcdc844b.js","assets/mat3-21bcfd83.js","assets/TiledDisplayObject-accbee08.js","assets/schemaUtils-9a6e7dda.js","assets/createSymbolSchema-21e81f0c.js","assets/util-e5019f71.js","assets/normalizeUtils-703059af.js","assets/utils-3b5f5c5a.js","assets/vec3f32-ad1dc57f.js","assets/imageUtils-46b75651.js","assets/BitmapTileContainer-2b06fdfb.js","assets/Bitmap-b4ca4b09.js","assets/TileContainer-842f76b1.js","assets/LayerView-968a0443.js","assets/HighlightGraphicContainer-d2d9607c.js","assets/BaseGraphicContainer-862908ea.js","assets/FeatureContainer-86576b95.js","assets/RefreshableLayerView-22763354.js","assets/drapedUtils-921690e1.js","assets/scaleUtils-33b708da.js","assets/floorFilterUtils-080a7cd2.js","assets/sublayerUtils-08cbbcae.js","assets/popupUtils-591ed28b.js","assets/CollectionFlattener-459cb615.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/colorUtils-c0f43caf.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/executeQueryJSON-ca6c73e1.js","assets/query-d95b3dd5.js","assets/pbfQueryUtils-06c77b54.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js"])),zt=()=>K().then(()=>w(()=>import("./FeatureLayerView2D-f77eb40b.js"),["assets/FeatureLayerView2D-f77eb40b.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/EffectView-a1fb6514.js","assets/definitions-f329b961.js","assets/LayerView-968a0443.js","assets/Container-72cba08e.js","assets/enums-64ab819c.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/schemaUtils-9a6e7dda.js","assets/color-6aec3839.js","assets/enums-55085e26.js","assets/VertexElementDescriptor-2925c6af.js","assets/number-b10bd8f5.js","assets/utils-7263c34f.js","assets/MaterialKey-5b247dd4.js","assets/alignmentUtils-ae955d28.js","assets/visualVariablesUtils-7dbd5d40.js","assets/createSymbolSchema-21e81f0c.js","assets/cimAnalyzer-02b56dc2.js","assets/fontUtils-afce1abc.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-5c57438c.js","assets/GeometryUtils-fea59923.js","assets/utils-bd924f31.js","assets/mat2d-e11be45e.js","assets/vec2-bbd3449a.js","assets/TileStrategy-1967197e.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/TileKey-b1f5cdb9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-193e54d0.js","assets/floatRGBA-4f7fa53a.js","assets/ExpandedCIM-2a6dd26b.js","assets/util-e5019f71.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-591ed28b.js","assets/RefreshableLayerView-22763354.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/CollectionFlattener-459cb615.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/colorUtils-c0f43caf.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/devEnvironmentUtils-5002a058.js","assets/executeQueryJSON-ca6c73e1.js","assets/utils-3b5f5c5a.js","assets/query-d95b3dd5.js","assets/normalizeUtils-703059af.js","assets/normalizeUtilsCommon-258cba9f.js","assets/pbfQueryUtils-06c77b54.js","assets/pbf-f46def03.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/featureConversionUtils-c00360ef.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/GraphicsCollection-b80722b0.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js","assets/vec2f64-22afc56f.js","assets/mat3-21bcfd83.js"])),ar={"base-dynamic":()=>K().then(()=>w(()=>import("./BaseDynamicLayerView2D-da7aa788.js"),["assets/BaseDynamicLayerView2D-da7aa788.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/BitmapContainer-c2c49ee7.js","assets/WGLContainer-e2488f5a.js","assets/definitions-f329b961.js","assets/VertexArrayObject-07c1da56.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/color-6aec3839.js","assets/enums-55085e26.js","assets/number-b10bd8f5.js","assets/ProgramTemplate-9f1c124b.js","assets/MaterialKey-5b247dd4.js","assets/alignmentUtils-ae955d28.js","assets/utils-7263c34f.js","assets/StyleDefinition-fbc907c2.js","assets/TileStrategy-1967197e.js","assets/vec2-bbd3449a.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/aaBoundingRect-5c57438c.js","assets/TileKey-b1f5cdb9.js","assets/config-1337d16e.js","assets/GeometryUtils-dd03fc25.js","assets/Container-72cba08e.js","assets/EffectView-a1fb6514.js","assets/earcut-61f7b102.js","assets/vec2f64-22afc56f.js","assets/featureConversionUtils-c00360ef.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-968a0443.js","assets/ExportStrategy-9ab69efa.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/Bitmap-b4ca4b09.js","assets/mat3-21bcfd83.js","assets/RefreshableLayerView-22763354.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/CollectionFlattener-459cb615.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/utils-bd924f31.js","assets/colorUtils-c0f43caf.js","assets/mat2d-e11be45e.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/devEnvironmentUtils-5002a058.js","assets/executeQueryJSON-ca6c73e1.js","assets/utils-3b5f5c5a.js","assets/query-d95b3dd5.js","assets/normalizeUtils-703059af.js","assets/normalizeUtilsCommon-258cba9f.js","assets/pbfQueryUtils-06c77b54.js","assets/pbf-f46def03.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/GraphicsCollection-b80722b0.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js"])),"base-tile":pi,"bing-maps":pi,csv:zt,"geo-rss":()=>K().then(()=>w(()=>import("./GeoRSSLayerView2D-0e351043.js"),["assets/GeoRSSLayerView2D-0e351043.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/LayerView-968a0443.js","assets/Container-72cba08e.js","assets/EffectView-a1fb6514.js","assets/definitions-f329b961.js","assets/enums-64ab819c.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/GraphicContainer-c8c09d12.js","assets/color-6aec3839.js","assets/enums-55085e26.js","assets/VertexElementDescriptor-2925c6af.js","assets/number-b10bd8f5.js","assets/BaseGraphicContainer-862908ea.js","assets/FeatureContainer-86576b95.js","assets/AttributeStoreView-bcdc844b.js","assets/mat2d-e11be45e.js","assets/mat3-21bcfd83.js","assets/TiledDisplayObject-accbee08.js","assets/TileKey-b1f5cdb9.js","assets/visualVariablesUtils-50880e5a.js","assets/visualVariablesUtils-7dbd5d40.js","assets/VertexArrayObject-07c1da56.js","assets/TileContainer-842f76b1.js","assets/WGLContainer-e2488f5a.js","assets/ProgramTemplate-9f1c124b.js","assets/MaterialKey-5b247dd4.js","assets/alignmentUtils-ae955d28.js","assets/utils-7263c34f.js","assets/StyleDefinition-fbc907c2.js","assets/TileStrategy-1967197e.js","assets/vec2-bbd3449a.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/aaBoundingRect-5c57438c.js","assets/config-1337d16e.js","assets/GeometryUtils-dd03fc25.js","assets/earcut-61f7b102.js","assets/vec2f64-22afc56f.js","assets/featureConversionUtils-c00360ef.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/vec3f32-ad1dc57f.js","assets/normalizeUtils-703059af.js","assets/normalizeUtilsCommon-258cba9f.js","assets/utils-3b5f5c5a.js","assets/GraphicsView2D-734762b1.js","assets/cimAnalyzer-02b56dc2.js","assets/fontUtils-afce1abc.js","assets/BidiEngine-836b7ef6.js","assets/GeometryUtils-fea59923.js","assets/utils-bd924f31.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-193e54d0.js","assets/floatRGBA-4f7fa53a.js","assets/normalizeUtilsSync-f1c7dfdb.js","assets/projectionSupport-60e6d2f8.js","assets/json-48e3ea08.js","assets/Matcher-10c827e6.js","assets/tileUtils-c2f19f52.js","assets/TurboLine-0c6b5b1e.js","assets/ExpandedCIM-2a6dd26b.js","assets/devEnvironmentUtils-5002a058.js","assets/schemaUtils-9a6e7dda.js","assets/createSymbolSchema-21e81f0c.js","assets/util-e5019f71.js","assets/ComputedAttributeStorage-b555102a.js","assets/arcadeTimeUtils-ef4a84e4.js","assets/executionError-fb3f283a.js","assets/centroid-335ed93e.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/CollectionFlattener-459cb615.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/colorUtils-c0f43caf.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/executeQueryJSON-ca6c73e1.js","assets/query-d95b3dd5.js","assets/pbfQueryUtils-06c77b54.js","assets/pbf-f46def03.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/GraphicsCollection-b80722b0.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js"])),feature:zt,geojson:zt,graphics:()=>K().then(()=>w(()=>import("./GraphicsLayerView2D-c1d0678d.js"),["assets/GraphicsLayerView2D-c1d0678d.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/LayerView-968a0443.js","assets/Container-72cba08e.js","assets/EffectView-a1fb6514.js","assets/definitions-f329b961.js","assets/enums-64ab819c.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/GraphicContainer-c8c09d12.js","assets/color-6aec3839.js","assets/enums-55085e26.js","assets/VertexElementDescriptor-2925c6af.js","assets/number-b10bd8f5.js","assets/BaseGraphicContainer-862908ea.js","assets/FeatureContainer-86576b95.js","assets/AttributeStoreView-bcdc844b.js","assets/mat2d-e11be45e.js","assets/mat3-21bcfd83.js","assets/TiledDisplayObject-accbee08.js","assets/TileKey-b1f5cdb9.js","assets/visualVariablesUtils-50880e5a.js","assets/visualVariablesUtils-7dbd5d40.js","assets/VertexArrayObject-07c1da56.js","assets/TileContainer-842f76b1.js","assets/WGLContainer-e2488f5a.js","assets/ProgramTemplate-9f1c124b.js","assets/MaterialKey-5b247dd4.js","assets/alignmentUtils-ae955d28.js","assets/utils-7263c34f.js","assets/StyleDefinition-fbc907c2.js","assets/TileStrategy-1967197e.js","assets/vec2-bbd3449a.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/aaBoundingRect-5c57438c.js","assets/config-1337d16e.js","assets/GeometryUtils-dd03fc25.js","assets/earcut-61f7b102.js","assets/vec2f64-22afc56f.js","assets/featureConversionUtils-c00360ef.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/vec3f32-ad1dc57f.js","assets/normalizeUtils-703059af.js","assets/normalizeUtilsCommon-258cba9f.js","assets/utils-3b5f5c5a.js","assets/GraphicsView2D-734762b1.js","assets/cimAnalyzer-02b56dc2.js","assets/fontUtils-afce1abc.js","assets/BidiEngine-836b7ef6.js","assets/GeometryUtils-fea59923.js","assets/utils-bd924f31.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-193e54d0.js","assets/floatRGBA-4f7fa53a.js","assets/normalizeUtilsSync-f1c7dfdb.js","assets/projectionSupport-60e6d2f8.js","assets/json-48e3ea08.js","assets/Matcher-10c827e6.js","assets/tileUtils-c2f19f52.js","assets/TurboLine-0c6b5b1e.js","assets/ExpandedCIM-2a6dd26b.js","assets/devEnvironmentUtils-5002a058.js","assets/schemaUtils-9a6e7dda.js","assets/createSymbolSchema-21e81f0c.js","assets/util-e5019f71.js","assets/ComputedAttributeStorage-b555102a.js","assets/arcadeTimeUtils-ef4a84e4.js","assets/executionError-fb3f283a.js","assets/centroid-335ed93e.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/CollectionFlattener-459cb615.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/colorUtils-c0f43caf.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/executeQueryJSON-ca6c73e1.js","assets/query-d95b3dd5.js","assets/pbfQueryUtils-06c77b54.js","assets/pbf-f46def03.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/GraphicsCollection-b80722b0.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js"])),group:()=>K().then(()=>w(()=>import("./GroupLayerView2D-18926976.js"),["assets/GroupLayerView2D-18926976.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/GroupContainer-e5e671e2.js","assets/WGLContainer-e2488f5a.js","assets/definitions-f329b961.js","assets/VertexArrayObject-07c1da56.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/color-6aec3839.js","assets/enums-55085e26.js","assets/number-b10bd8f5.js","assets/ProgramTemplate-9f1c124b.js","assets/MaterialKey-5b247dd4.js","assets/alignmentUtils-ae955d28.js","assets/utils-7263c34f.js","assets/StyleDefinition-fbc907c2.js","assets/TileStrategy-1967197e.js","assets/vec2-bbd3449a.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/aaBoundingRect-5c57438c.js","assets/TileKey-b1f5cdb9.js","assets/config-1337d16e.js","assets/GeometryUtils-dd03fc25.js","assets/Container-72cba08e.js","assets/EffectView-a1fb6514.js","assets/earcut-61f7b102.js","assets/vec2f64-22afc56f.js","assets/featureConversionUtils-c00360ef.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-968a0443.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/CollectionFlattener-459cb615.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/utils-bd924f31.js","assets/colorUtils-c0f43caf.js","assets/mat2d-e11be45e.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/devEnvironmentUtils-5002a058.js","assets/executeQueryJSON-ca6c73e1.js","assets/utils-3b5f5c5a.js","assets/query-d95b3dd5.js","assets/normalizeUtils-703059af.js","assets/normalizeUtilsCommon-258cba9f.js","assets/pbfQueryUtils-06c77b54.js","assets/pbf-f46def03.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/GraphicsCollection-b80722b0.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js","assets/mat3-21bcfd83.js"])),imagery:()=>K().then(()=>w(()=>import("./ImageryLayerView2D-4aff3b63.js"),["assets/ImageryLayerView2D-4aff3b63.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/GraphicsCollection-b80722b0.js","assets/RasterVFDisplayObject-b2a927ce.js","assets/VertexArrayObject-07c1da56.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/dataUtils-911b749e.js","assets/pixelRangeUtils-03719dd8.js","assets/WGLContainer-e2488f5a.js","assets/definitions-f329b961.js","assets/color-6aec3839.js","assets/enums-55085e26.js","assets/number-b10bd8f5.js","assets/ProgramTemplate-9f1c124b.js","assets/MaterialKey-5b247dd4.js","assets/alignmentUtils-ae955d28.js","assets/utils-7263c34f.js","assets/StyleDefinition-fbc907c2.js","assets/TileStrategy-1967197e.js","assets/vec2-bbd3449a.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/aaBoundingRect-5c57438c.js","assets/TileKey-b1f5cdb9.js","assets/config-1337d16e.js","assets/GeometryUtils-dd03fc25.js","assets/Container-72cba08e.js","assets/EffectView-a1fb6514.js","assets/earcut-61f7b102.js","assets/vec2f64-22afc56f.js","assets/featureConversionUtils-c00360ef.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/mat3-21bcfd83.js","assets/LayerView-968a0443.js","assets/GraphicsView2D-734762b1.js","assets/cimAnalyzer-02b56dc2.js","assets/fontUtils-afce1abc.js","assets/BidiEngine-836b7ef6.js","assets/GeometryUtils-fea59923.js","assets/utils-bd924f31.js","assets/mat2d-e11be45e.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-193e54d0.js","assets/floatRGBA-4f7fa53a.js","assets/normalizeUtilsSync-f1c7dfdb.js","assets/normalizeUtilsCommon-258cba9f.js","assets/projectionSupport-60e6d2f8.js","assets/json-48e3ea08.js","assets/AttributeStoreView-bcdc844b.js","assets/TiledDisplayObject-accbee08.js","assets/visualVariablesUtils-50880e5a.js","assets/visualVariablesUtils-7dbd5d40.js","assets/Matcher-10c827e6.js","assets/tileUtils-c2f19f52.js","assets/TurboLine-0c6b5b1e.js","assets/ExpandedCIM-2a6dd26b.js","assets/devEnvironmentUtils-5002a058.js","assets/schemaUtils-9a6e7dda.js","assets/createSymbolSchema-21e81f0c.js","assets/util-e5019f71.js","assets/ComputedAttributeStorage-b555102a.js","assets/arcadeTimeUtils-ef4a84e4.js","assets/executionError-fb3f283a.js","assets/centroid-335ed93e.js","assets/normalizeUtils-703059af.js","assets/utils-3b5f5c5a.js","assets/HighlightGraphicContainer-d2d9607c.js","assets/BaseGraphicContainer-862908ea.js","assets/FeatureContainer-86576b95.js","assets/TileContainer-842f76b1.js","assets/vec3f32-ad1dc57f.js","assets/BitmapContainer-c2c49ee7.js","assets/Bitmap-b4ca4b09.js","assets/ExportStrategy-9ab69efa.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/rasterProjectionHelper-56d2ab5a.js","assets/popupUtils-591ed28b.js","assets/RefreshableLayerView-22763354.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/CollectionFlattener-459cb615.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/colorUtils-c0f43caf.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/executeQueryJSON-ca6c73e1.js","assets/query-d95b3dd5.js","assets/pbfQueryUtils-06c77b54.js","assets/pbf-f46def03.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js"])),"imagery-tile":()=>K().then(()=>w(()=>import("./ImageryTileLayerView2D-85e0691d.js"),["assets/ImageryTileLayerView2D-85e0691d.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/multidimensionalUtils-8b85fc0a.js","assets/RasterVFDisplayObject-b2a927ce.js","assets/VertexArrayObject-07c1da56.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/dataUtils-911b749e.js","assets/pixelRangeUtils-03719dd8.js","assets/WGLContainer-e2488f5a.js","assets/definitions-f329b961.js","assets/color-6aec3839.js","assets/enums-55085e26.js","assets/number-b10bd8f5.js","assets/ProgramTemplate-9f1c124b.js","assets/MaterialKey-5b247dd4.js","assets/alignmentUtils-ae955d28.js","assets/utils-7263c34f.js","assets/StyleDefinition-fbc907c2.js","assets/TileStrategy-1967197e.js","assets/vec2-bbd3449a.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/aaBoundingRect-5c57438c.js","assets/TileKey-b1f5cdb9.js","assets/config-1337d16e.js","assets/GeometryUtils-dd03fc25.js","assets/Container-72cba08e.js","assets/EffectView-a1fb6514.js","assets/earcut-61f7b102.js","assets/vec2f64-22afc56f.js","assets/featureConversionUtils-c00360ef.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/mat3-21bcfd83.js","assets/LayerView-968a0443.js","assets/rasterUtils-aeb78c01.js","assets/TiledDisplayObject-accbee08.js","assets/TileContainer-842f76b1.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/RawBlockCache-7f27ebdd.js","assets/rasterProjectionHelper-56d2ab5a.js","assets/util-e5019f71.js","assets/popupUtils-591ed28b.js","assets/RefreshableLayerView-22763354.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/CollectionFlattener-459cb615.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/utils-bd924f31.js","assets/colorUtils-c0f43caf.js","assets/mat2d-e11be45e.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/devEnvironmentUtils-5002a058.js","assets/executeQueryJSON-ca6c73e1.js","assets/utils-3b5f5c5a.js","assets/query-d95b3dd5.js","assets/normalizeUtils-703059af.js","assets/normalizeUtilsCommon-258cba9f.js","assets/pbfQueryUtils-06c77b54.js","assets/pbf-f46def03.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/GraphicsCollection-b80722b0.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js"])),kml:()=>K().then(()=>w(()=>import("./KMLLayerView2D-6d89880f.js"),["assets/KMLLayerView2D-6d89880f.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/kmlUtils-62cde1d7.js","assets/utils-3b5f5c5a.js","assets/GraphicsCollection-b80722b0.js","assets/Bitmap-b4ca4b09.js","assets/mat3-21bcfd83.js","assets/TileStrategy-1967197e.js","assets/vec2-bbd3449a.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/aaBoundingRect-5c57438c.js","assets/TileKey-b1f5cdb9.js","assets/Container-72cba08e.js","assets/EffectView-a1fb6514.js","assets/definitions-f329b961.js","assets/enums-64ab819c.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/BitmapContainer-c2c49ee7.js","assets/WGLContainer-e2488f5a.js","assets/VertexArrayObject-07c1da56.js","assets/VertexElementDescriptor-2925c6af.js","assets/color-6aec3839.js","assets/enums-55085e26.js","assets/number-b10bd8f5.js","assets/ProgramTemplate-9f1c124b.js","assets/MaterialKey-5b247dd4.js","assets/alignmentUtils-ae955d28.js","assets/utils-7263c34f.js","assets/StyleDefinition-fbc907c2.js","assets/config-1337d16e.js","assets/GeometryUtils-dd03fc25.js","assets/earcut-61f7b102.js","assets/vec2f64-22afc56f.js","assets/featureConversionUtils-c00360ef.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-968a0443.js","assets/GraphicContainer-c8c09d12.js","assets/BaseGraphicContainer-862908ea.js","assets/FeatureContainer-86576b95.js","assets/AttributeStoreView-bcdc844b.js","assets/mat2d-e11be45e.js","assets/TiledDisplayObject-accbee08.js","assets/visualVariablesUtils-50880e5a.js","assets/visualVariablesUtils-7dbd5d40.js","assets/TileContainer-842f76b1.js","assets/vec3f32-ad1dc57f.js","assets/normalizeUtils-703059af.js","assets/normalizeUtilsCommon-258cba9f.js","assets/GraphicsView2D-734762b1.js","assets/cimAnalyzer-02b56dc2.js","assets/fontUtils-afce1abc.js","assets/BidiEngine-836b7ef6.js","assets/GeometryUtils-fea59923.js","assets/utils-bd924f31.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-193e54d0.js","assets/floatRGBA-4f7fa53a.js","assets/normalizeUtilsSync-f1c7dfdb.js","assets/projectionSupport-60e6d2f8.js","assets/json-48e3ea08.js","assets/Matcher-10c827e6.js","assets/tileUtils-c2f19f52.js","assets/TurboLine-0c6b5b1e.js","assets/ExpandedCIM-2a6dd26b.js","assets/devEnvironmentUtils-5002a058.js","assets/schemaUtils-9a6e7dda.js","assets/createSymbolSchema-21e81f0c.js","assets/util-e5019f71.js","assets/ComputedAttributeStorage-b555102a.js","assets/arcadeTimeUtils-ef4a84e4.js","assets/executionError-fb3f283a.js","assets/centroid-335ed93e.js","assets/rasterProjectionHelper-56d2ab5a.js","assets/RenderingContext-b944f363.js","assets/programUtils-8e54bcd5.js","assets/NestedMap-1b5db22e.js","assets/OrderIndependentTransparency-e1b3a745.js","assets/basicInterfaces-b7051eb1.js","assets/doublePrecisionUtils-e3c3d0d8.js","assets/webgl-debug-b1f7a2c5.js","assets/rasterUtils-aeb78c01.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/CollectionFlattener-459cb615.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/colorUtils-c0f43caf.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/executeQueryJSON-ca6c73e1.js","assets/query-d95b3dd5.js","assets/pbfQueryUtils-06c77b54.js","assets/pbf-f46def03.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js"])),"knowledge-graph":()=>K().then(()=>w(()=>import("./KnowledgeGraphLayerView2D-0279f5ae.js"),["assets/KnowledgeGraphLayerView2D-0279f5ae.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/LayerView-968a0443.js","assets/Container-72cba08e.js","assets/EffectView-a1fb6514.js","assets/definitions-f329b961.js","assets/enums-64ab819c.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/CollectionFlattener-459cb615.js","assets/TileInfo-2589d4ff.js","assets/aaBoundingRect-5c57438c.js","assets/TileKey-b87e0dc5.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/utils-bd924f31.js","assets/colorUtils-c0f43caf.js","assets/mat2d-e11be45e.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/devEnvironmentUtils-5002a058.js","assets/executeQueryJSON-ca6c73e1.js","assets/utils-3b5f5c5a.js","assets/query-d95b3dd5.js","assets/normalizeUtils-703059af.js","assets/normalizeUtilsCommon-258cba9f.js","assets/pbfQueryUtils-06c77b54.js","assets/pbf-f46def03.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/featureConversionUtils-c00360ef.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/GraphicsCollection-b80722b0.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js","assets/vec2-bbd3449a.js","assets/vec2f64-22afc56f.js","assets/mat3-21bcfd83.js","assets/TileStrategy-1967197e.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/TileKey-b1f5cdb9.js"])),"link-chart":()=>K().then(()=>w(()=>import("./KnowledgeGraphLayerView2D-0279f5ae.js"),["assets/KnowledgeGraphLayerView2D-0279f5ae.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/LayerView-968a0443.js","assets/Container-72cba08e.js","assets/EffectView-a1fb6514.js","assets/definitions-f329b961.js","assets/enums-64ab819c.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/CollectionFlattener-459cb615.js","assets/TileInfo-2589d4ff.js","assets/aaBoundingRect-5c57438c.js","assets/TileKey-b87e0dc5.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/utils-bd924f31.js","assets/colorUtils-c0f43caf.js","assets/mat2d-e11be45e.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/devEnvironmentUtils-5002a058.js","assets/executeQueryJSON-ca6c73e1.js","assets/utils-3b5f5c5a.js","assets/query-d95b3dd5.js","assets/normalizeUtils-703059af.js","assets/normalizeUtilsCommon-258cba9f.js","assets/pbfQueryUtils-06c77b54.js","assets/pbf-f46def03.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/featureConversionUtils-c00360ef.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/GraphicsCollection-b80722b0.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js","assets/vec2-bbd3449a.js","assets/vec2f64-22afc56f.js","assets/mat3-21bcfd83.js","assets/TileStrategy-1967197e.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/TileKey-b1f5cdb9.js"])),"knowledge-graph-sublayer":zt,"map-image":()=>K().then(()=>w(()=>import("./MapImageLayerView2D-676af5f4.js"),["assets/MapImageLayerView2D-676af5f4.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/GraphicsCollection-b80722b0.js","assets/BitmapContainer-c2c49ee7.js","assets/WGLContainer-e2488f5a.js","assets/definitions-f329b961.js","assets/VertexArrayObject-07c1da56.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/color-6aec3839.js","assets/enums-55085e26.js","assets/number-b10bd8f5.js","assets/ProgramTemplate-9f1c124b.js","assets/MaterialKey-5b247dd4.js","assets/alignmentUtils-ae955d28.js","assets/utils-7263c34f.js","assets/StyleDefinition-fbc907c2.js","assets/TileStrategy-1967197e.js","assets/vec2-bbd3449a.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/aaBoundingRect-5c57438c.js","assets/TileKey-b1f5cdb9.js","assets/config-1337d16e.js","assets/GeometryUtils-dd03fc25.js","assets/Container-72cba08e.js","assets/EffectView-a1fb6514.js","assets/earcut-61f7b102.js","assets/vec2f64-22afc56f.js","assets/featureConversionUtils-c00360ef.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-968a0443.js","assets/GraphicsView2D-734762b1.js","assets/cimAnalyzer-02b56dc2.js","assets/fontUtils-afce1abc.js","assets/BidiEngine-836b7ef6.js","assets/GeometryUtils-fea59923.js","assets/utils-bd924f31.js","assets/mat2d-e11be45e.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-193e54d0.js","assets/floatRGBA-4f7fa53a.js","assets/normalizeUtilsSync-f1c7dfdb.js","assets/normalizeUtilsCommon-258cba9f.js","assets/projectionSupport-60e6d2f8.js","assets/json-48e3ea08.js","assets/AttributeStoreView-bcdc844b.js","assets/mat3-21bcfd83.js","assets/TiledDisplayObject-accbee08.js","assets/visualVariablesUtils-50880e5a.js","assets/visualVariablesUtils-7dbd5d40.js","assets/Matcher-10c827e6.js","assets/tileUtils-c2f19f52.js","assets/TurboLine-0c6b5b1e.js","assets/ExpandedCIM-2a6dd26b.js","assets/devEnvironmentUtils-5002a058.js","assets/schemaUtils-9a6e7dda.js","assets/createSymbolSchema-21e81f0c.js","assets/util-e5019f71.js","assets/ComputedAttributeStorage-b555102a.js","assets/arcadeTimeUtils-ef4a84e4.js","assets/executionError-fb3f283a.js","assets/centroid-335ed93e.js","assets/normalizeUtils-703059af.js","assets/utils-3b5f5c5a.js","assets/HighlightGraphicContainer-d2d9607c.js","assets/BaseGraphicContainer-862908ea.js","assets/FeatureContainer-86576b95.js","assets/TileContainer-842f76b1.js","assets/vec3f32-ad1dc57f.js","assets/ExportStrategy-9ab69efa.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/Bitmap-b4ca4b09.js","assets/ExportImageParameters-07dc0717.js","assets/floorFilterUtils-080a7cd2.js","assets/sublayerUtils-08cbbcae.js","assets/RefreshableLayerView-22763354.js","assets/drapedUtils-921690e1.js","assets/scaleUtils-33b708da.js","assets/popupUtils-591ed28b.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/CollectionFlattener-459cb615.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/colorUtils-c0f43caf.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/executeQueryJSON-ca6c73e1.js","assets/query-d95b3dd5.js","assets/pbfQueryUtils-06c77b54.js","assets/pbf-f46def03.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js"])),"map-notes":()=>K().then(()=>w(()=>import("./MapNotesLayerView2D-f42101f1.js"),["assets/MapNotesLayerView2D-f42101f1.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/Container-72cba08e.js","assets/EffectView-a1fb6514.js","assets/definitions-f329b961.js","assets/enums-64ab819c.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/GroupContainer-e5e671e2.js","assets/WGLContainer-e2488f5a.js","assets/VertexArrayObject-07c1da56.js","assets/VertexElementDescriptor-2925c6af.js","assets/color-6aec3839.js","assets/enums-55085e26.js","assets/number-b10bd8f5.js","assets/ProgramTemplate-9f1c124b.js","assets/MaterialKey-5b247dd4.js","assets/alignmentUtils-ae955d28.js","assets/utils-7263c34f.js","assets/StyleDefinition-fbc907c2.js","assets/TileStrategy-1967197e.js","assets/vec2-bbd3449a.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/aaBoundingRect-5c57438c.js","assets/TileKey-b1f5cdb9.js","assets/config-1337d16e.js","assets/GeometryUtils-dd03fc25.js","assets/earcut-61f7b102.js","assets/vec2f64-22afc56f.js","assets/featureConversionUtils-c00360ef.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-968a0443.js","assets/GraphicContainer-c8c09d12.js","assets/BaseGraphicContainer-862908ea.js","assets/FeatureContainer-86576b95.js","assets/AttributeStoreView-bcdc844b.js","assets/mat2d-e11be45e.js","assets/mat3-21bcfd83.js","assets/TiledDisplayObject-accbee08.js","assets/visualVariablesUtils-50880e5a.js","assets/visualVariablesUtils-7dbd5d40.js","assets/TileContainer-842f76b1.js","assets/vec3f32-ad1dc57f.js","assets/normalizeUtils-703059af.js","assets/normalizeUtilsCommon-258cba9f.js","assets/utils-3b5f5c5a.js","assets/GraphicsView2D-734762b1.js","assets/cimAnalyzer-02b56dc2.js","assets/fontUtils-afce1abc.js","assets/BidiEngine-836b7ef6.js","assets/GeometryUtils-fea59923.js","assets/utils-bd924f31.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-193e54d0.js","assets/floatRGBA-4f7fa53a.js","assets/normalizeUtilsSync-f1c7dfdb.js","assets/projectionSupport-60e6d2f8.js","assets/json-48e3ea08.js","assets/Matcher-10c827e6.js","assets/tileUtils-c2f19f52.js","assets/TurboLine-0c6b5b1e.js","assets/ExpandedCIM-2a6dd26b.js","assets/devEnvironmentUtils-5002a058.js","assets/schemaUtils-9a6e7dda.js","assets/createSymbolSchema-21e81f0c.js","assets/util-e5019f71.js","assets/ComputedAttributeStorage-b555102a.js","assets/arcadeTimeUtils-ef4a84e4.js","assets/executionError-fb3f283a.js","assets/centroid-335ed93e.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/CollectionFlattener-459cb615.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/colorUtils-c0f43caf.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/executeQueryJSON-ca6c73e1.js","assets/query-d95b3dd5.js","assets/pbfQueryUtils-06c77b54.js","assets/pbf-f46def03.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/GraphicsCollection-b80722b0.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js"])),media:()=>K().then(()=>w(()=>import("./MediaLayerView2D-95c4a517.js"),["assets/MediaLayerView2D-95c4a517.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/aaBoundingRect-5c57438c.js","assets/MediaElementView-a154bc90.js","assets/mat3-21bcfd83.js","assets/mat3f64-221ce671.js","assets/vec2-bbd3449a.js","assets/normalizeUtilsSync-f1c7dfdb.js","assets/normalizeUtilsCommon-258cba9f.js","assets/Rasterizer-7c00bea5.js","assets/_commonjsHelpers-2f3e7994.js","assets/cimAnalyzer-02b56dc2.js","assets/fontUtils-afce1abc.js","assets/BidiEngine-836b7ef6.js","assets/GeometryUtils-fea59923.js","assets/enums-55085e26.js","assets/utils-bd924f31.js","assets/alignmentUtils-ae955d28.js","assets/definitions-f329b961.js","assets/mat2d-e11be45e.js","assets/TileStrategy-1967197e.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/TileKey-b1f5cdb9.js","assets/number-b10bd8f5.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-193e54d0.js","assets/floatRGBA-4f7fa53a.js","assets/rasterizingUtils-74cec9f6.js","assets/EffectView-a1fb6514.js","assets/Container-72cba08e.js","assets/enums-64ab819c.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/BufferPool-34e9b674.js","assets/color-6aec3839.js","assets/VertexElementDescriptor-2925c6af.js","assets/WGLContainer-e2488f5a.js","assets/VertexArrayObject-07c1da56.js","assets/ProgramTemplate-9f1c124b.js","assets/MaterialKey-5b247dd4.js","assets/utils-7263c34f.js","assets/StyleDefinition-fbc907c2.js","assets/config-1337d16e.js","assets/GeometryUtils-dd03fc25.js","assets/earcut-61f7b102.js","assets/vec2f64-22afc56f.js","assets/featureConversionUtils-c00360ef.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/enums-fb086c25.js","assets/MagnifierPrograms-65f59e80.js","assets/pbf-f46def03.js","assets/imageutils-b0a7b4c6.js","assets/Matcher-10c827e6.js","assets/visualVariablesUtils-50880e5a.js","assets/visualVariablesUtils-7dbd5d40.js","assets/tileUtils-c2f19f52.js","assets/TurboLine-0c6b5b1e.js","assets/ExpandedCIM-2a6dd26b.js","assets/devEnvironmentUtils-5002a058.js","assets/CircularArray-3a8652cf.js","assets/webgl-debug-b1f7a2c5.js","assets/ComputedAttributeStorage-b555102a.js","assets/arcadeTimeUtils-ef4a84e4.js","assets/executionError-fb3f283a.js","assets/centroid-335ed93e.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/OrderIndependentTransparency-e1b3a745.js","assets/basicInterfaces-b7051eb1.js","assets/GraphicsView2D-734762b1.js","assets/projectionSupport-60e6d2f8.js","assets/json-48e3ea08.js","assets/AttributeStoreView-bcdc844b.js","assets/TiledDisplayObject-accbee08.js","assets/schemaUtils-9a6e7dda.js","assets/createSymbolSchema-21e81f0c.js","assets/util-e5019f71.js","assets/normalizeUtils-703059af.js","assets/utils-3b5f5c5a.js","assets/vec3f32-ad1dc57f.js","assets/LayerView-968a0443.js","assets/CollectionFlattener-459cb615.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/colorUtils-c0f43caf.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/executeQueryJSON-ca6c73e1.js","assets/query-d95b3dd5.js","assets/pbfQueryUtils-06c77b54.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/GraphicsCollection-b80722b0.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js"])),"ogc-feature":()=>K().then(()=>w(()=>import("./OGCFeatureLayerView2D-9ab63b07.js"),["assets/OGCFeatureLayerView2D-9ab63b07.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/FeatureLayerView2D-f77eb40b.js","assets/EffectView-a1fb6514.js","assets/definitions-f329b961.js","assets/LayerView-968a0443.js","assets/Container-72cba08e.js","assets/enums-64ab819c.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/schemaUtils-9a6e7dda.js","assets/color-6aec3839.js","assets/enums-55085e26.js","assets/VertexElementDescriptor-2925c6af.js","assets/number-b10bd8f5.js","assets/utils-7263c34f.js","assets/MaterialKey-5b247dd4.js","assets/alignmentUtils-ae955d28.js","assets/visualVariablesUtils-7dbd5d40.js","assets/createSymbolSchema-21e81f0c.js","assets/cimAnalyzer-02b56dc2.js","assets/fontUtils-afce1abc.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-5c57438c.js","assets/GeometryUtils-fea59923.js","assets/utils-bd924f31.js","assets/mat2d-e11be45e.js","assets/vec2-bbd3449a.js","assets/TileStrategy-1967197e.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/TileKey-b1f5cdb9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-193e54d0.js","assets/floatRGBA-4f7fa53a.js","assets/ExpandedCIM-2a6dd26b.js","assets/util-e5019f71.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-591ed28b.js","assets/RefreshableLayerView-22763354.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/CollectionFlattener-459cb615.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/colorUtils-c0f43caf.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/devEnvironmentUtils-5002a058.js","assets/executeQueryJSON-ca6c73e1.js","assets/utils-3b5f5c5a.js","assets/query-d95b3dd5.js","assets/normalizeUtils-703059af.js","assets/normalizeUtilsCommon-258cba9f.js","assets/pbfQueryUtils-06c77b54.js","assets/pbf-f46def03.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/featureConversionUtils-c00360ef.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/GraphicsCollection-b80722b0.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js","assets/vec2f64-22afc56f.js","assets/mat3-21bcfd83.js"])),"open-street-map":pi,"oriented-imagery":zt,route:()=>K().then(()=>w(()=>import("./RouteLayerView2D-7356d3ed.js"),["assets/RouteLayerView2D-7356d3ed.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/CollectionFlattener-459cb615.js","assets/Stop-1565e28a.js","assets/LayerView-968a0443.js","assets/Container-72cba08e.js","assets/EffectView-a1fb6514.js","assets/definitions-f329b961.js","assets/enums-64ab819c.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/GraphicContainer-c8c09d12.js","assets/color-6aec3839.js","assets/enums-55085e26.js","assets/VertexElementDescriptor-2925c6af.js","assets/number-b10bd8f5.js","assets/BaseGraphicContainer-862908ea.js","assets/FeatureContainer-86576b95.js","assets/AttributeStoreView-bcdc844b.js","assets/mat2d-e11be45e.js","assets/mat3-21bcfd83.js","assets/TiledDisplayObject-accbee08.js","assets/TileKey-b1f5cdb9.js","assets/visualVariablesUtils-50880e5a.js","assets/visualVariablesUtils-7dbd5d40.js","assets/VertexArrayObject-07c1da56.js","assets/TileContainer-842f76b1.js","assets/WGLContainer-e2488f5a.js","assets/ProgramTemplate-9f1c124b.js","assets/MaterialKey-5b247dd4.js","assets/alignmentUtils-ae955d28.js","assets/utils-7263c34f.js","assets/StyleDefinition-fbc907c2.js","assets/TileStrategy-1967197e.js","assets/vec2-bbd3449a.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/aaBoundingRect-5c57438c.js","assets/config-1337d16e.js","assets/GeometryUtils-dd03fc25.js","assets/earcut-61f7b102.js","assets/vec2f64-22afc56f.js","assets/featureConversionUtils-c00360ef.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/vec3f32-ad1dc57f.js","assets/normalizeUtils-703059af.js","assets/normalizeUtilsCommon-258cba9f.js","assets/utils-3b5f5c5a.js","assets/GraphicsView2D-734762b1.js","assets/cimAnalyzer-02b56dc2.js","assets/fontUtils-afce1abc.js","assets/BidiEngine-836b7ef6.js","assets/GeometryUtils-fea59923.js","assets/utils-bd924f31.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-193e54d0.js","assets/floatRGBA-4f7fa53a.js","assets/normalizeUtilsSync-f1c7dfdb.js","assets/projectionSupport-60e6d2f8.js","assets/json-48e3ea08.js","assets/Matcher-10c827e6.js","assets/tileUtils-c2f19f52.js","assets/TurboLine-0c6b5b1e.js","assets/ExpandedCIM-2a6dd26b.js","assets/devEnvironmentUtils-5002a058.js","assets/schemaUtils-9a6e7dda.js","assets/createSymbolSchema-21e81f0c.js","assets/util-e5019f71.js","assets/ComputedAttributeStorage-b555102a.js","assets/arcadeTimeUtils-ef4a84e4.js","assets/executionError-fb3f283a.js","assets/centroid-335ed93e.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/colorUtils-c0f43caf.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/executeQueryJSON-ca6c73e1.js","assets/query-d95b3dd5.js","assets/pbfQueryUtils-06c77b54.js","assets/pbf-f46def03.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/GraphicsCollection-b80722b0.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js"])),stream:()=>K().then(()=>w(()=>import("./StreamLayerView2D-22e231e6.js"),["assets/StreamLayerView2D-22e231e6.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/FeatureLayerView2D-f77eb40b.js","assets/EffectView-a1fb6514.js","assets/definitions-f329b961.js","assets/LayerView-968a0443.js","assets/Container-72cba08e.js","assets/enums-64ab819c.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/schemaUtils-9a6e7dda.js","assets/color-6aec3839.js","assets/enums-55085e26.js","assets/VertexElementDescriptor-2925c6af.js","assets/number-b10bd8f5.js","assets/utils-7263c34f.js","assets/MaterialKey-5b247dd4.js","assets/alignmentUtils-ae955d28.js","assets/visualVariablesUtils-7dbd5d40.js","assets/createSymbolSchema-21e81f0c.js","assets/cimAnalyzer-02b56dc2.js","assets/fontUtils-afce1abc.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-5c57438c.js","assets/GeometryUtils-fea59923.js","assets/utils-bd924f31.js","assets/mat2d-e11be45e.js","assets/vec2-bbd3449a.js","assets/TileStrategy-1967197e.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/TileKey-b1f5cdb9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-193e54d0.js","assets/floatRGBA-4f7fa53a.js","assets/ExpandedCIM-2a6dd26b.js","assets/util-e5019f71.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-591ed28b.js","assets/RefreshableLayerView-22763354.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/CollectionFlattener-459cb615.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/colorUtils-c0f43caf.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/devEnvironmentUtils-5002a058.js","assets/executeQueryJSON-ca6c73e1.js","assets/utils-3b5f5c5a.js","assets/query-d95b3dd5.js","assets/normalizeUtils-703059af.js","assets/normalizeUtilsCommon-258cba9f.js","assets/pbfQueryUtils-06c77b54.js","assets/pbf-f46def03.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/featureConversionUtils-c00360ef.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/GraphicsCollection-b80722b0.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js","assets/vec2f64-22afc56f.js","assets/mat3-21bcfd83.js"])),"subtype-group":()=>K().then(()=>w(()=>import("./SubtypeGroupLayerView2D-71e91bf8.js"),["assets/SubtypeGroupLayerView2D-71e91bf8.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/FeatureLayerView2D-f77eb40b.js","assets/EffectView-a1fb6514.js","assets/definitions-f329b961.js","assets/LayerView-968a0443.js","assets/Container-72cba08e.js","assets/enums-64ab819c.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/schemaUtils-9a6e7dda.js","assets/color-6aec3839.js","assets/enums-55085e26.js","assets/VertexElementDescriptor-2925c6af.js","assets/number-b10bd8f5.js","assets/utils-7263c34f.js","assets/MaterialKey-5b247dd4.js","assets/alignmentUtils-ae955d28.js","assets/visualVariablesUtils-7dbd5d40.js","assets/createSymbolSchema-21e81f0c.js","assets/cimAnalyzer-02b56dc2.js","assets/fontUtils-afce1abc.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-5c57438c.js","assets/GeometryUtils-fea59923.js","assets/utils-bd924f31.js","assets/mat2d-e11be45e.js","assets/vec2-bbd3449a.js","assets/TileStrategy-1967197e.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/TileKey-b1f5cdb9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-193e54d0.js","assets/floatRGBA-4f7fa53a.js","assets/ExpandedCIM-2a6dd26b.js","assets/util-e5019f71.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-591ed28b.js","assets/RefreshableLayerView-22763354.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/CollectionFlattener-459cb615.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/colorUtils-c0f43caf.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/devEnvironmentUtils-5002a058.js","assets/executeQueryJSON-ca6c73e1.js","assets/utils-3b5f5c5a.js","assets/query-d95b3dd5.js","assets/normalizeUtils-703059af.js","assets/normalizeUtilsCommon-258cba9f.js","assets/pbfQueryUtils-06c77b54.js","assets/pbf-f46def03.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/featureConversionUtils-c00360ef.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/GraphicsCollection-b80722b0.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js","assets/vec2f64-22afc56f.js","assets/mat3-21bcfd83.js"])),tile:pi,"vector-tile":()=>K().then(()=>w(()=>import("./VectorTileLayerView2D-3550f471.js"),["assets/VectorTileLayerView2D-3550f471.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/aaBoundingRect-5c57438c.js","assets/enums-fb086c25.js","assets/Rect-ea14f53a.js","assets/enums-64ab819c.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/pbf-f46def03.js","assets/rasterizingUtils-74cec9f6.js","assets/floatRGBA-4f7fa53a.js","assets/TileKey-b1f5cdb9.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/mat3-21bcfd83.js","assets/VertexArrayObject-07c1da56.js","assets/config-1337d16e.js","assets/TiledDisplayObject-accbee08.js","assets/Container-72cba08e.js","assets/EffectView-a1fb6514.js","assets/definitions-f329b961.js","assets/StyleDefinition-fbc907c2.js","assets/enums-55085e26.js","assets/color-6aec3839.js","assets/VertexElementDescriptor-2925c6af.js","assets/number-b10bd8f5.js","assets/TileContainer-842f76b1.js","assets/WGLContainer-e2488f5a.js","assets/ProgramTemplate-9f1c124b.js","assets/MaterialKey-5b247dd4.js","assets/alignmentUtils-ae955d28.js","assets/utils-7263c34f.js","assets/TileStrategy-1967197e.js","assets/vec2-bbd3449a.js","assets/GeometryUtils-dd03fc25.js","assets/earcut-61f7b102.js","assets/vec2f64-22afc56f.js","assets/featureConversionUtils-c00360ef.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/StyleRepository-349ae90d.js","assets/colorUtils-c0f43caf.js","assets/GeometryUtils-fea59923.js","assets/unitBezier-881ac1eb.js","assets/LayerView-968a0443.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/CollectionFlattener-459cb615.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/utils-bd924f31.js","assets/mat2d-e11be45e.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/devEnvironmentUtils-5002a058.js","assets/executeQueryJSON-ca6c73e1.js","assets/utils-3b5f5c5a.js","assets/query-d95b3dd5.js","assets/normalizeUtils-703059af.js","assets/normalizeUtilsCommon-258cba9f.js","assets/pbfQueryUtils-06c77b54.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/GraphicsCollection-b80722b0.js","assets/ViewingMode-915d19cb.js"])),wcs:()=>K().then(()=>w(()=>import("./ImageryTileLayerView2D-85e0691d.js"),["assets/ImageryTileLayerView2D-85e0691d.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/multidimensionalUtils-8b85fc0a.js","assets/RasterVFDisplayObject-b2a927ce.js","assets/VertexArrayObject-07c1da56.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/dataUtils-911b749e.js","assets/pixelRangeUtils-03719dd8.js","assets/WGLContainer-e2488f5a.js","assets/definitions-f329b961.js","assets/color-6aec3839.js","assets/enums-55085e26.js","assets/number-b10bd8f5.js","assets/ProgramTemplate-9f1c124b.js","assets/MaterialKey-5b247dd4.js","assets/alignmentUtils-ae955d28.js","assets/utils-7263c34f.js","assets/StyleDefinition-fbc907c2.js","assets/TileStrategy-1967197e.js","assets/vec2-bbd3449a.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/aaBoundingRect-5c57438c.js","assets/TileKey-b1f5cdb9.js","assets/config-1337d16e.js","assets/GeometryUtils-dd03fc25.js","assets/Container-72cba08e.js","assets/EffectView-a1fb6514.js","assets/earcut-61f7b102.js","assets/vec2f64-22afc56f.js","assets/featureConversionUtils-c00360ef.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/mat3-21bcfd83.js","assets/LayerView-968a0443.js","assets/rasterUtils-aeb78c01.js","assets/TiledDisplayObject-accbee08.js","assets/TileContainer-842f76b1.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/RawBlockCache-7f27ebdd.js","assets/rasterProjectionHelper-56d2ab5a.js","assets/util-e5019f71.js","assets/popupUtils-591ed28b.js","assets/RefreshableLayerView-22763354.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/CollectionFlattener-459cb615.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/utils-bd924f31.js","assets/colorUtils-c0f43caf.js","assets/mat2d-e11be45e.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/devEnvironmentUtils-5002a058.js","assets/executeQueryJSON-ca6c73e1.js","assets/utils-3b5f5c5a.js","assets/query-d95b3dd5.js","assets/normalizeUtils-703059af.js","assets/normalizeUtilsCommon-258cba9f.js","assets/pbfQueryUtils-06c77b54.js","assets/pbf-f46def03.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/GraphicsCollection-b80722b0.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js"])),"web-tile":pi,wfs:zt,wms:()=>K().then(()=>w(()=>import("./WMSLayerView2D-94323bb1.js"),["assets/WMSLayerView2D-94323bb1.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/BitmapContainer-c2c49ee7.js","assets/WGLContainer-e2488f5a.js","assets/definitions-f329b961.js","assets/VertexArrayObject-07c1da56.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/color-6aec3839.js","assets/enums-55085e26.js","assets/number-b10bd8f5.js","assets/ProgramTemplate-9f1c124b.js","assets/MaterialKey-5b247dd4.js","assets/alignmentUtils-ae955d28.js","assets/utils-7263c34f.js","assets/StyleDefinition-fbc907c2.js","assets/TileStrategy-1967197e.js","assets/vec2-bbd3449a.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/aaBoundingRect-5c57438c.js","assets/TileKey-b1f5cdb9.js","assets/config-1337d16e.js","assets/GeometryUtils-dd03fc25.js","assets/Container-72cba08e.js","assets/EffectView-a1fb6514.js","assets/earcut-61f7b102.js","assets/vec2f64-22afc56f.js","assets/featureConversionUtils-c00360ef.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-968a0443.js","assets/ExportStrategy-9ab69efa.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/Bitmap-b4ca4b09.js","assets/mat3-21bcfd83.js","assets/RefreshableLayerView-22763354.js","assets/ExportWMSImageParameters-b3c16301.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/CollectionFlattener-459cb615.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/utils-bd924f31.js","assets/colorUtils-c0f43caf.js","assets/mat2d-e11be45e.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/devEnvironmentUtils-5002a058.js","assets/executeQueryJSON-ca6c73e1.js","assets/utils-3b5f5c5a.js","assets/query-d95b3dd5.js","assets/normalizeUtils-703059af.js","assets/normalizeUtilsCommon-258cba9f.js","assets/pbfQueryUtils-06c77b54.js","assets/pbf-f46def03.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/GraphicsCollection-b80722b0.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js"])),wmts:()=>K().then(()=>w(()=>import("./WMTSLayerView2D-69b7383a.js"),["assets/WMTSLayerView2D-69b7383a.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/imageUtils-46b75651.js","assets/BitmapTileContainer-2b06fdfb.js","assets/aaBoundingRect-5c57438c.js","assets/Bitmap-b4ca4b09.js","assets/mat3-21bcfd83.js","assets/TileStrategy-1967197e.js","assets/vec2-bbd3449a.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/TileKey-b1f5cdb9.js","assets/Container-72cba08e.js","assets/EffectView-a1fb6514.js","assets/definitions-f329b961.js","assets/enums-64ab819c.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/TiledDisplayObject-accbee08.js","assets/WGLContainer-e2488f5a.js","assets/VertexArrayObject-07c1da56.js","assets/VertexElementDescriptor-2925c6af.js","assets/color-6aec3839.js","assets/enums-55085e26.js","assets/number-b10bd8f5.js","assets/ProgramTemplate-9f1c124b.js","assets/MaterialKey-5b247dd4.js","assets/alignmentUtils-ae955d28.js","assets/utils-7263c34f.js","assets/StyleDefinition-fbc907c2.js","assets/config-1337d16e.js","assets/GeometryUtils-dd03fc25.js","assets/earcut-61f7b102.js","assets/vec2f64-22afc56f.js","assets/featureConversionUtils-c00360ef.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/TileContainer-842f76b1.js","assets/LayerView-968a0443.js","assets/RefreshableLayerView-22763354.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/CollectionFlattener-459cb615.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/utils-bd924f31.js","assets/colorUtils-c0f43caf.js","assets/mat2d-e11be45e.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/devEnvironmentUtils-5002a058.js","assets/executeQueryJSON-ca6c73e1.js","assets/utils-3b5f5c5a.js","assets/query-d95b3dd5.js","assets/normalizeUtils-703059af.js","assets/normalizeUtilsCommon-258cba9f.js","assets/pbfQueryUtils-06c77b54.js","assets/pbf-f46def03.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/GraphicsCollection-b80722b0.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js"])),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"point-cloud":null,voxel:null,scene:null,unknown:null,unsupported:null};function xu(i){const e=i.declaredClass?i.declaredClass.slice(i.declaredClass.lastIndexOf(".")+1):"Unknown",t=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new k(`${t}:view-not-supported`,`${e} is not supported in 2D`)}const lr={hasLayerViewModule:i=>M(ar[i.type]),importLayerView:i=>{const e=ar[i.type];if(F(e))throw xu(i);return e(i)}};function Eu(i,e){const{spatialReference:t}=e,s=[e.x,e.y];let n=Number.POSITIVE_INFINITY,o=0,r=0;const l=[0,0],d=i.type==="extent"?[[[i.xmin,i.ymin],[i.xmin,i.ymax],[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin]]]:i.rings;for(const h of d)for(let u=0;u<h.length-1;u++){Wl(l,s,h,u);const p=Cc(s,l);p<n&&(n=p,o=l[0],r=l[1])}return{coordinate:new se({x:o,y:r,spatialReference:t}),distance:n}}var _n;let kt=_n=class extends Pn(D){constructor(i){super(i),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(F(this.geometry)||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return Li(this.geometry,this.spatialReference)}catch(i){return V.getLogger(this.declaredClass).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:i}),null}return this.geometry}constrain(i,e){if(F(this.normalizedGeometry))return i;const t=i.targetGeometry;if(this.normalizedGeometry.type==="extent"?Vr(this.normalizedGeometry,t):Zl(this.normalizedGeometry,t))return i;const{coordinate:s}=Eu(this.normalizedGeometry,t);return s&&(i.targetGeometry=s),i}clone(){var i,e;return new _n({geometry:(i=this.geometry)==null?void 0:i.clone(),spatialReference:(e=this.spatialReference)==null?void 0:e.clone()})}};a([c({constructOnly:!0})],kt.prototype,"geometry",void 0),a([c({readOnly:!0})],kt.prototype,"normalizedGeometry",null),a([c({constructOnly:!0})],kt.prototype,"spatialReference",void 0),kt=_n=a([I("esri.views.2d.constraints.GeometryConstraint")],kt);var yn;let Ci=yn=class extends Pn(D){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(i,e){return this.enabled&&e&&(this.rotationEnabled||(i.rotation=e.rotation)),i}clone(){return new yn({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};a([c()],Ci.prototype,"enabled",void 0),a([c()],Ci.prototype,"rotationEnabled",void 0),Ci=yn=a([I("esri.views.2d.constraints.RotationConstraint")],Ci);const Oa=Ci;var vn;let fe=vn=class extends Pn(D){constructor(i){super(i),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let i,{lods:e,minScale:t,maxScale:s,minZoom:n,maxZoom:o}=this,r=-1,l=-1,d=!1,h=!1;if(t!==0&&s!==0&&t<s&&([t,s]=[s,t]),!e||!e.length)return this._set("effectiveMinScale",t),void this._set("effectiveMaxScale",s);e=e.map(u=>u.clone()),e.sort((u,p)=>p.scale-u.scale),e.forEach((u,p)=>u.level=p);for(const u of e)!d&&t>0&&t>=u.scale&&(r=u.level,d=!0),!h&&s>0&&s>=u.scale&&(l=i?i.level:-1,h=!0),i=u;n===-1&&(n=t===0?0:r),o===-1&&(o=s===0?e.length-1:l),n=Math.max(n,0),n=Math.min(n,e.length-1),o=Math.max(o,0),o=Math.min(o,e.length-1),n>o&&([n,o]=[o,n]),t=e[n].scale,s=e[o].scale,e.splice(0,n),e.splice(o-n+1,e.length),e.forEach((u,p)=>{this._lodByScale[u.scale]=u,this._scales[p]=u.scale}),this._set("effectiveLODs",e),this._set("effectiveMinZoom",n),this._set("effectiveMaxZoom",o),this._set("effectiveMinScale",t),this._set("effectiveMaxScale",s)}constrain(i,e){if(e&&i.scale===e.scale)return i;const t=this.effectiveMinScale,s=this.effectiveMaxScale,n=i.targetGeometry,o=e&&e.targetGeometry,r=s!==0&&i.scale<s,l=t!==0&&i.scale>t;if(r||l){const d=l?t:s;if(e&&o){const h=(d-e.scale)/(i.scale-e.scale);n.x=o.x+(n.x-o.x)*h,n.y=o.y+(n.y-o.y)*h}i.scale=d}return this.snapToZoom&&this.effectiveLODs&&(i.scale=this._getClosestScale(i.scale)),i}fit(i){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(i,null);const e=this.scaleToZoom(i.scale),t=Math.abs(e-Math.floor(e));return i.scale=this.zoomToScale(t>.99?Math.round(e):Math.floor(e)),i}zoomToScale(i){if(!this.effectiveLODs)return 0;i-=this.effectiveMinZoom,i=Math.max(0,i);const e=this._scales;if(i<=0)return e[0];if(i>=e.length)return e[e.length-1];const t=Math.round(i-.5),s=Math.round(i);return e[s]+(s-i)*(e[t]-e[s])}scaleToZoom(i){if(!this.effectiveLODs)return-1;const e=this._scales;let t,s;if(i>=e[0])return this.effectiveMinZoom;if(i<=e[e.length-1])return this.effectiveMaxZoom;for(let n=0;n<e.length-1;n++){if(t=e[n],s=e[n+1],s===i)return n+this.effectiveMinZoom+1;if(t>i&&s<i)return n+this.effectiveMinZoom+1-(i-s)/(t-s)}return-1}snapToClosestScale(i){if(!this.effectiveLODs)return i;const e=this.scaleToZoom(i);return this.zoomToScale(Math.round(e))}snapToNextScale(i,e=.5){if(!this.effectiveLODs)return i*e;const t=Math.round(this.scaleToZoom(i));return this.zoomToScale(t+1)}snapToPreviousScale(i,e=2){if(!this.effectiveLODs)return i*e;const t=Math.round(this.scaleToZoom(i));return this.zoomToScale(t-1)}clone(){return new vn({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(i){return this._lodByScale[i]||(i=this._scales.reduce((e,t)=>Math.abs(t-i)<=Math.abs(e-i)?t:e,this._scales[0])),this._lodByScale[i].scale}};a([c({readOnly:!0})],fe.prototype,"effectiveLODs",void 0),a([c({readOnly:!0})],fe.prototype,"effectiveMinZoom",void 0),a([c({readOnly:!0})],fe.prototype,"effectiveMaxZoom",void 0),a([c({readOnly:!0})],fe.prototype,"effectiveMinScale",void 0),a([c({readOnly:!0})],fe.prototype,"effectiveMaxScale",void 0),a([c()],fe.prototype,"lods",void 0),a([c()],fe.prototype,"minZoom",void 0),a([c()],fe.prototype,"maxZoom",void 0),a([c()],fe.prototype,"minScale",void 0),a([c()],fe.prototype,"maxScale",void 0),a([c()],fe.prototype,"snapToZoom",void 0),fe=vn=a([I("esri.views.2d.constraints.ZoomConstraint")],fe);const Va=fe,ku={base:null,key:"type",typeMap:{extent:oi,polygon:Kl}};let Z=class extends D{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){var e,t,s;return`${(e=this._zoom)==null?void 0:e.uid}/${(t=this._rotation)==null?void 0:t.uid}/${(s=this._geometry)==null?void 0:s.uid}`}get _defaultLODs(){var s,n,o;const e=(n=(s=this.view)==null?void 0:s.defaultsFromMap)==null?void 0:n.tileInfo,t=(o=this.view)==null?void 0:o.spatialReference;return e&&t&&e.spatialReference.equals(t)?e.lods:null}get _geometry(){var e;return new kt({geometry:this.geometry,spatialReference:(e=this.view)==null?void 0:e.spatialReference})}get _rotation(){return new Oa({rotationEnabled:this.rotationEnabled})}get _zoom(){const e=this._get("_zoom"),t=this.lods||this._defaultLODs,s=this.minZoom,n=this.maxZoom,o=this.minScale,r=this.maxScale,l=this.snapToZoom;return e&&e.lods===t&&e.minZoom===s&&e.maxZoom===n&&e.minScale===o&&e.maxScale===r&&e.snapToZoom===l?e:new Va({lods:t,minZoom:s,maxZoom:n,minScale:o,maxScale:r,snapToZoom:l})}canZoomInTo(e){const t=this.effectiveMaxScale;return t===0||e>=t}canZoomOutTo(e){const t=this.effectiveMinScale;return t===0||e<=t}constrain(e,t){return this._zoom.constrain(e,t),this._rotation.constrain(e,t),this._geometry.constrain(e,t),e}constrainByGeometry(e){return this._geometry.constrain(e)}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};a([c({readOnly:!0})],Z.prototype,"effectiveLODs",null),a([c({readOnly:!0})],Z.prototype,"effectiveMinScale",null),a([c({readOnly:!0})],Z.prototype,"effectiveMaxScale",null),a([c({readOnly:!0})],Z.prototype,"effectiveMinZoom",null),a([c({readOnly:!0})],Z.prototype,"effectiveMaxZoom",null),a([c({types:ku,value:null})],Z.prototype,"geometry",null),a([c({type:[ic]})],Z.prototype,"lods",void 0),a([c()],Z.prototype,"minScale",void 0),a([c()],Z.prototype,"maxScale",void 0),a([c()],Z.prototype,"minZoom",void 0),a([c()],Z.prototype,"maxZoom",void 0),a([c()],Z.prototype,"rotationEnabled",void 0),a([c()],Z.prototype,"snapToZoom",void 0),a([c()],Z.prototype,"view",void 0),a([c({readOnly:!0})],Z.prototype,"version",null),a([c()],Z.prototype,"_defaultLODs",null),a([c({type:kt})],Z.prototype,"_geometry",null),a([c({type:Oa})],Z.prototype,"_rotation",null),a([c({readOnly:!0,type:Va})],Z.prototype,"_zoom",null),Z=a([I("esri.views.2d.MapViewConstraints")],Z);const Na=Z;function es(){const i=new Float32Array(9);return i[0]=1,i[4]=1,i[8]=1,i}function $u(i){const e=new Float32Array(9);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e}function Pu(i,e,t,s,n,o,r,l,d){const h=new Float32Array(9);return h[0]=i,h[1]=e,h[2]=t,h[3]=s,h[4]=n,h[5]=o,h[6]=r,h[7]=l,h[8]=d,h}function Au(i,e){return new Float32Array(i,e,9)}Object.freeze(Object.defineProperty({__proto__:null,clone:$u,create:es,createView:Au,fromValues:Pu},Symbol.toStringTag,{value:"Module"}));function Fu(i){return i instanceof Float32Array&&i.length>=2}function Ru(i){return Array.isArray(i)&&i.length>=2}function Qs(i){return Fu(i)||Ru(i)}var wn;const Be=[0,0];let ct=wn=class extends Nr{constructor(i){super(i),this._viewpoint2D={center:J(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new oi,this.id=0,this.inverseTransform=mt(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=mt(),this.transformNoRotation=mt(),this.displayMat3=es(),this.displayViewMat3=es(),this.viewMat3=es(),this.viewMat2d=vc(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(i){this._set("pixelRatio",i),this._update()}set size(i){this._set("size",i),this._update()}set viewpoint(i){if(i){const e=this._viewpoint2D,t=i.targetGeometry;e.center[0]=t.x,e.center[1]=t.y,e.rotation=i.rotation,e.scale=i.scale,e.spatialReference=t.spatialReference}this._update()}copy(i){const e=this.size,t=this.viewpoint;return t&&e?(this.viewpoint=Ee(t,i.viewpoint),this._set("size",cs(e,i.size))):(this.viewpoint=i.viewpoint.clone(),this._set("size",[i.size[0],i.size[1]])),this._set("pixelRatio",i.pixelRatio),this}clone(){return new wn({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(i,e,t){return Qs(e)?We(i,e,this.inverseTransform):(Be[0]=e,Be[1]=t,We(i,Be,this.inverseTransform))}toScreen(i,e,t){return Qs(e)?We(i,e,this.transform):(Be[0]=e,Be[1]=t,We(i,Be,this.transform))}toScreenNoRotation(i,e,t){return Qs(e)?We(i,e,this.transformNoRotation):(Be[0]=e,Be[1]=t,We(i,Be,this.transformNoRotation))}getScreenTransform(i,e){const{center:t}=this._viewpoint2D,s=this._get("pixelRatio")||1,n=this._get("size");return Gn(i,t,n,e,0,s),i}_update(){const{center:i,spatialReference:e,scale:t,rotation:s}=this._viewpoint2D,n=this._get("pixelRatio")||1,o=this._get("size"),r=new Oe({targetGeometry:new se(i[0],i[1],e),scale:t,rotation:s});if(this._set("viewpoint",r),!o||!e||!t)return;this.resolution=ri(r),this.rotation=s,this.scale=t,this.spatialReference=e,cs(this.center,i);const l=o[0]!==0?2/o[0]:0,d=o[1]!==0?-2/o[1]:0;xc(this.displayMat3,l,0,0,0,d,0,-1,1,1);const h=Ec(this.viewMat3),u=_o(o[0]/2,o[1]/2),p=_o(-o[0]/2,-o[1]/2),g=Or(s);fo(h,h,u),kc(h,h,g),fo(h,h,p),$c(this.displayViewMat3,this.displayMat3,h);const f=Wr(this.viewMat2d,u);return Fn(f,f,g),ls(f,f,p),lu(this.extent,r,o),Wn(this.transform,r,o,n),Zr(this.inverseTransform,this.transform),gu(this.transformNoRotation,r,o,n),this.worldScreenWidth=_u(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};a([c({readOnly:!0})],ct.prototype,"id",void 0),a([c({value:1,json:{write:!0}})],ct.prototype,"pixelRatio",null),a([c({json:{write:!0}})],ct.prototype,"size",null),a([c()],ct.prototype,"spatialReference",void 0),a([c({type:Oe,json:{write:!0}})],ct.prototype,"viewpoint",null),ct=wn=a([I("esri.views.2d.ViewState")],ct);const cr=ct;var bn,Mn;let Ze=bn=class extends D{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new bn({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};a([c()],Ze.prototype,"left",void 0),a([c()],Ze.prototype,"top",void 0),a([c()],Ze.prototype,"right",void 0),a([c()],Ze.prototype,"bottom",void 0),Ze=bn=a([I("esri.views.2d.PaddedViewState.Padding")],Ze);let Wt=Mn=class extends cr{constructor(...i){super(...i),this.paddedViewState=new cr,this._updateContent=(()=>{const e=J();return()=>{const t=this._get("size"),s=this._get("padding");if(!t||!s)return;const n=this.paddedViewState;ne(e,s.left+s.right,s.top+s.bottom),ln(e,t,e),cs(n.size,e);const o=n.viewpoint;o&&(this.viewpoint=o)}})(),this.addHandles(y(()=>[this.size,this.padding],()=>this._updateContent(),ki)),this.padding=new Ze,this.size=[0,0]}set padding(i){this._set("padding",i||new Ze)}set viewpoint(i){if(i){const e=i.clone();this.paddedViewState.viewpoint=i,vu(e,i,this._get("size"),this._get("padding"));const t=this._viewpoint2D,s=e.targetGeometry;t.center[0]=s.x,t.center[1]=s.y,t.rotation=e.rotation,t.scale=e.scale,t.spatialReference=s.spatialReference,this._update()}}clone(){return new Mn({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};a([c()],Wt.prototype,"paddedViewState",void 0),a([c({type:Ze})],Wt.prototype,"padding",null),a([c()],Wt.prototype,"viewpoint",null),Wt=Mn=a([I("esri.views.2d.PaddedViewState")],Wt);const Lu=Wt;function Zn(i,e){switch(e){case"primary":return i.pointerType==="touch"||i.button===0;case"secondary":return i.pointerType!=="touch"&&i.button===2;case"tertiary":return i.pointerType!=="touch"&&i.button===1}}let dr=class extends ee{constructor(e,t){super(!0),this._view=e,this.registerIncoming("double-click",t,s=>this._handleDoubleClick(s,t))}_handleDoubleClick(e,t){Zn(e.data,"primary")&&(e.stopPropagation(),t?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},Su=class extends ee{constructor(e,t,s){super(!0),this.view=e,this.pointerType=t,this.registerIncoming("double-tap-drag",s,n=>this._handleDoubleTapDrag(n))}_handleDoubleTapDrag(e){const{data:t}=e,{pointerType:s}=t;if(s!==this.pointerType)return;e.stopPropagation();const{action:n,delta:o}=t,{view:r}=this,{mapViewNavigation:l}=r;switch(n){case"begin":{const{scale:d}=r;this._startScale=d,this._currentScale=d,this._previousDelta=o,l.begin();break}case"update":{if(this._previousDelta.y===o.y)return;this._previousDelta=o;const d=1.015**o.y,h=this._startScale*d,u=h/this._currentScale;l.setViewpointImmediate(u),this._currentScale=h;break}case"end":{const{constraints:d}=r,{effectiveLODs:h,snapToZoom:u}=d;if(!u||!h)return void l.end();const p=d.snapScale(this._currentScale),g=(o.y>0?Math.max(p,d.snapToPreviousScale(this._startScale)):Math.min(p,d.snapToNextScale(this._startScale)))/this._currentScale;l.zoom(g);break}}}},xs=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const t=e.data,s=t.pointers.size;switch(t.action){case"start":this._currentCount=s,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=s,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=s,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){var t,s;this._startEvent=e,(s=(t=this._callbacks).condition)!=null&&s.call(t,this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){var t,s;(s=(t=this._callbacks).condition)!=null&&s.call(t,this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){var t,s;(s=(t=this._callbacks).condition)!=null&&s.call(t,this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},Du=class extends ee{constructor(e,t,s){super(!0),this.view=e,this.pointerAction=t,this.registerIncoming("drag",s,n=>this._handleDrag(n)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(e){super.onInstall(e),this._dragEventSeparator=new xs({start:(t,s)=>{this.view.mapViewNavigation.pan.begin(this.view,s.data),s.stopPropagation()},update:(t,s)=>{this.view.mapViewNavigation.pan.update(this.view,s.data),s.stopPropagation()},end:(t,s)=>{this.view.mapViewNavigation.pan.end(this.view,s.data),s.stopPropagation()},condition:(t,s)=>t===1&&Zn(s.data,this.pointerAction)})}_handleDrag(e){const t=this.view.mapViewNavigation;t.pinch.zoomMomentum||t.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},Ou=class extends ee{constructor(e,t,s){super(!0),this._view=e,this.pointerAction=t;const n=this._view.mapViewNavigation;this._dragEventSeparator=new xs({start:(o,r)=>{n.rotate.begin(this._view,r.data),r.stopPropagation()},update:(o,r)=>{n.rotate.update(this._view,r.data),r.stopPropagation()},end:(o,r)=>{n.rotate.end(),r.stopPropagation()},condition:(o,r)=>o===1&&Zn(r.data,this.pointerAction)}),this.registerIncoming("drag",s,o=>this._dragEventSeparator.handle(o))}};function Ce(i){let e=i*i;return i<0&&(e*=-1),e}function Vu(i){return i.translation[0]=0,i.translation[1]=0,i.translation[2]=0,i.heading=0,i.tilt=0,i}function Nu(i,e,t){const s=t,n=i.state,o=i.device,r=e.tiltDirection==="forward-down"?1:-1,l=1;return o.deviceType==="standard"?(s.translation[0]=Ce(n.axes[0]),s.translation[1]=Ce(n.axes[1]),s.translation[2]=Ce(n.buttons[7])-Ce(n.buttons[6]),s.heading=Ce(n.axes[2]),s.tilt=Ce(n.axes[3])):o.deviceType==="spacemouse"&&(s.translation[0]=1.2*Ce(n.axes[0]),s.translation[1]=1.2*Ce(n.axes[1]),s.translation[2]=2*-Ce(n.axes[2]),s.heading=1.2*Ce(n.axes[5]),s.tilt=1.2*Ce(n.axes[3])),s.tilt*=r,Ql(s.translation,s.translation,l),s}function zu(i){return i.translation[0]===0&&i.translation[1]===0&&i.translation[2]===0&&i.heading===0&&i.tilt===0&&i.zoom===0}let Bu=class extends ee{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new gt,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",t=>this._handleGamePadEvent(t)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([y(()=>{var t;return(t=this._view.navigation.gamepad)==null?void 0:t.enabled},t=>{t?(this._handle.resume(),this._frameTask||(this._frameTask=ni({update:s=>this._frameUpdate(s.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},O)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const t=this._view.navigation.gamepad.device;t&&e.data.device!==t||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,Vu(this._transformation)):(this._currentDevice=e.data.device,Nu(e.data,this._view.navigation.gamepad,this._transformation)))}_frameUpdate(e){const t=this._transformation;if(zu(t))return;const s=this._view.viewpoint.clone(),n=this._view.navigation.gamepad.velocityFactor,o=Uu*n*e;Ts(s,s,[t.translation[0]*o,-t.translation[1]*o]);const r=1+t.translation[2]*Hu*e,l=this._view.constraints.rotationEnabled?-t.heading*qu*e:0,d=this._view.size,h=[d[0]/2,d[1]];La(s,s,r,l,h,d);const u=this._view.constraints.constrain(s,this._view.viewpoint);this._view.viewpoint=u}};const qu=.06,Uu=.7,Hu=6e-4;let ju=class extends ee{constructor(e,t,s){super(!0),this.view=e,this.keys=t,this._pressed=!1,this._keyMap={[t.left]:"left",[t.right]:"right",[t.up]:"up",[t.down]:"down"},this.registerIncoming("key-down",s,n=>this._handleKeyDown(n)),this.registerIncoming("key-up",s,n=>this._handleKeyUp(n)),this.registerIncoming("blur",s,()=>this._handleBlur())}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,t){const s=this._keyMap[e.data.key];if(this._pressed=s!=null,this._pressed){if(t)switch(this.view.mapViewNavigation.begin(),s){case"left":this.view.mapViewNavigation.continousPanLeft();break;case"right":this.view.mapViewNavigation.continousPanRight();break;case"up":this.view.mapViewNavigation.continousPanUp();break;case"down":this.view.mapViewNavigation.continousPanDown()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}},Gu=class extends ee{constructor(e,t,s){super(!0),this.view=e,this.keys=t,this._pressed=!1,this._keyToDirection={[t.clockwiseOption1]:"clockwise",[t.clockwiseOption2]:"clockwise",[t.counterClockwiseOption1]:"counterClockwise",[t.counterClockwiseOption2]:"counterClockwise",[t.resetOption1]:"reset",[t.resetOption2]:"reset"},this.registerIncoming("key-down",s,n=>this._handleKeyDown(n)),this.registerIncoming("key-up",s,n=>this._handleKeyUp(n)),this.registerIncoming("blur",s,()=>this._handleBlur())}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,t){const s=e.modifiers;if(s.size>0&&!s.has("Shift")||!this.view.constraints.rotationEnabled)return;const n=this._keyToDirection[e.data.key];if(this._pressed=n!=null,this._pressed){if(t)switch(this.view.mapViewNavigation.begin(),n){case"clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}};var ei;(function(i){i[i.IN=0]="IN",i[i.OUT=1]="OUT"})(ei||(ei={}));let Wu=class extends ee{constructor(e,t,s){super(!0),this.view=e,this.keys=t,this._keysToZoomAction={},this.registerIncoming("key-down",s,n=>this._handleKeyDown(n)),t.zoomIn.forEach(n=>this._keysToZoomAction[n]=ei.IN),t.zoomOut.forEach(n=>this._keysToZoomAction[n]=ei.OUT)}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const t=e.modifiers;if(t.size>0&&!t.has("Shift"))return;const{key:s}=e.data;if(!(s in this._keysToZoomAction))return;const n=this._keysToZoomAction[s],{mapViewNavigation:o}=this.view;let r=null;switch(n){case ei.IN:r=o.zoomIn();break;case ei.OUT:r=o.zoomOut();break;default:return}o.begin(),r.then(()=>o.end()),e.stopPropagation()}};const Zu=.6;let Ku=class extends ee{constructor(e,t){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",t,s=>this._handleMouseWheel(s))}_handleMouseWheel(e){if(!this._view.navigation.mouseWheelZoomEnabled||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const t=this._view.mapViewNavigation,{x:s,y:n,deltaY:o}=e.data,r=1/Zu**(1/60*o),l=t.zoom(r,[s,n]);l&&(this._canZoom=!1,l.catch(()=>{}).then(()=>{this._canZoom=!0,t.end()}))}},Qu=class extends ee{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",s=>this._handleDrag(s)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const t=this.view.mapViewNavigation;this._dragEventSeparator=new xs({start:(s,n)=>{t.pinch.begin(this.view,n.data),n.stopPropagation()},update:(s,n)=>{t.pinch.update(this.view,n.data),n.stopPropagation()},end:(s,n)=>{t.pinch.end(this.view),n.stopPropagation()},condition:s=>s>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function hr(i){const e=i.native;return e?{buttons:e.buttons.map(t=>t.pressed?t.value?t.value:1:0),axes:e.axes.map(t=>Ju(t,i.axisThreshold))}:{buttons:[],axes:[]}}function Yu(i,e){if(i.axes.length!==e.axes.length||i.buttons.length!==e.buttons.length)return!1;for(let t=0;t<i.axes.length;t++)if(i.axes[t]!==e.axes[t])return!1;for(let t=0;t<i.buttons.length;t++)if(i.buttons[t]!==e.buttons[t])return!1;return!0}function Xu(i){for(let e=0;e<i.axes.length;e++)if(i.axes[e]!==0)return!1;for(let e=0;e<i.buttons.length;e++)if(i.buttons[e]!==0)return!1;return!0}function Ju(i,e){const t=Math.abs(i);return t<e?0:Math.sign(i)*(t-e)/(1-e)}let ep=class{constructor(e,t){this._element=e,this._input=t,this._hasEventListeners=!1,this._onConnectGamepad=o=>{this._connectGamepad(o.gamepad)},this._onDisconnectGamepad=o=>{const r=o.gamepad,l=r.index,d=this._inputDevices[l];d&&(this._emitGamepadEvent(r,hr(d),!1),this._inputDevices.splice(l,1),this._latestUpdate.splice(l,1),this._input.gamepad.devices.remove(d),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const s="getGamepads"in window.navigator,n=window.isSecureContext;this.supported=s&&n,this.supported&&(this._forEachGamepad(o=>this._connectGamepad(o)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const t=new Un(e);t.deviceType!=="unknown"&&(this._inputDevices[e.index]=t,this._input.gamepad.devices.add(t)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=ni({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),t=this._element.contains(document.activeElement),s=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!t;this._forEachGamepad(n=>{const o=this._inputDevices[n.index];if(!o)return;const r=this._latestUpdate[n.index],l=hr(o),d=s||Xu(l);r&&(r.timestamp===n.timestamp||!r.active&&d||Yu(r.state,l))||this._emitGamepadEvent(n,l,!d)})}_forEachGamepad(e){const t=window.navigator.getGamepads();for(let s=0;s<t.length;s++){const n=t[s];this._validate(n)&&e(n)}}_emitGamepadEvent(e,t,s){const n=this._latestUpdate[e.index],o=n&&n.active;if(!o&&!s)return;const r=!o&&s?"start":o&&s?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:t,active:s},this._callback&&this._callback({device:this._inputDevices[e.index],state:t,action:r})}_validate(e){if(!e||!e.connected)return!1;for(let t=0;t<e.axes.length;t++)if(isNaN(e.axes[t]))return!1;return!0}};const ur=Se("edge"),tp=Se("chrome"),ip=Se("ff"),sp=Se("safari"),pr="esri-view-surface",Bt={touchNone:`${pr}--touch-none`,touchPan:`${pr}--touch-pan`};let za=class Ba{constructor(e,t){this._input=t,this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new ep(e,this._input),this._gamepadSource.onEvent=s=>this._callback("gamepad",s)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach(e=>{this._releasePointerCaptureSafe(e)}),this._gamepadSource=re(this._gamepadSource),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const t in this._active)if(!e||!e.has(t)){const s=this._active[t];this._element.removeEventListener(Ys[t],s),delete this._active[t]}e&&e.forEach(t=>{if(!this._active[t]&&Ys[t]){const s=(this._eventHandlers[t]||this._handleDefault).bind(this,t);this._element.addEventListener(Ys[t],s),this._active[t]=s}}),this._gamepadSource.hasEventListeners=(e==null?void 0:e.has("gamepad"))??!1}setPointerCapture(e,t){t?(this._element.setPointerCapture(e.pointerId),this._activePointerCaptures.add(e.pointerId)):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?Bt.touchNone:Bt.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?Bt.touchPan:Bt.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(Bt.touchNone),this._element.classList.remove(Bt.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,t){const s=Ma(this._element,e);return Ba.test.disableSubpixelCoordinates&&(s.x=Math.round(s.x),s.y=Math.round(s.y)),t.x=s.x,t.y=s.y,t}_handleKey(e,t){const s=gh(t);s&&e==="key-up"&&this._keyDownState.delete(s);const n={native:t,key:s,repeat:!!s&&this._keyDownState.has(s)};s&&e==="key-down"&&this._keyDownState.add(n.key),this._callback(e,n)}_handlePointer(e,t){const s=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});this._callback(e,s)}_handlePointerPreventDefault(e,t){const s=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});t.preventDefault(),this._callback(e,s)}_handleMouseWheel(e,t){let s=t.deltaY;switch(t.deltaMode){case 0:ur&&(s=s/document.documentElement.clientHeight*600);break;case 1:s*=30;break;case 2:s*=900}ur?s*=.7:tp||sp?s*=.6:ip&&(s*=1.375);const n=100,o=Math.abs(s);o>n&&(s=s/o*200/(1+Math.exp(-.02*(o-n))));const r=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,deltaY:s});this._callback(e,r)}_handlePointerCaptureLost(e,t){this._activePointerCaptures.delete(t.pointerId),this._handleDefault(e,t)}_handleDefault(e,t){const s={native:t};t.preventDefault(),this._callback(e,s)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}};za.test={disableSubpixelCoordinates:!1};const Ys={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let np=class extends ee{constructor(){super(!0),this.registerIncoming("context-menu",e=>{e.data.native.preventDefault()})}};function Kn(i,e){return Math.abs(e.x-i.x)+Math.abs(e.y-i.y)}function op(i,e){const t=e.x-i.x,s=e.y-i.y;return Math.sqrt(t*t+s*s)}function rp(i,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:pe()},i.length===0)return e;if(i.length===1)return e.center.x=i[0].x,e.center.y=i[0].y,e;if(i.length===2){const[L,H]=i,[Y,te]=[H.x-L.x,H.y-L.y];return e.radius=Math.sqrt(Y*Y+te*te)/2,e.center.x=(L.x+H.x)/2,e.center.y=(L.y+H.y)/2,e}let t=0,s=0;for(let L=0;L<i.length;L++)t+=i[L].x,s+=i[L].y;t/=i.length,s/=i.length;const n=i.map(L=>L.x-t),o=i.map(L=>L.y-s);let r=0,l=0,d=0,h=0,u=0,p=0,g=0;for(let L=0;L<n.length;L++){const H=n[L],Y=o[L],te=H*H,q=Y*Y;r+=te,l+=q,d+=H*Y,h+=te*H,u+=q*Y,p+=H*q,g+=Y*te}const f=.5*(h+p),b=.5*(u+g),C=r*l-d*d,P=(f*l-b*d)/C,A=(r*b-d*f)/C,N=pe(P+t,A+s);return{radius:Math.sqrt(P*P+A*A+(r+l)/i.length),center:N}}function Ft(i){const{native:e}=i,{pointerId:t,button:s,pointerType:n}=e;return n==="mouse"?`${t}:${s}`:`${n}`}const Ie={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};let ap=class extends ee{constructor(e=Ie.maximumDoubleClickDelay,t=Ie.maximumDoubleClickDistance,s=Ie.maximumDoubleTouchDelay,n=Ie.maximumDoubleTouchDistance,o=vs){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=s,this._maximumDoubleTouchDistance=n,this._clock=o,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=Ye(e.doubleClickTimer))}get hasPendingInputs(){return gs(this._pointerState,e=>e.doubleClickTimer!=null)}_clearDoubleClickTimer(e,t){const s=this._pointerState.get(e);s&&(s.doubleClickTimer=Ye(s.doubleClickTimer),t&&this._click.emit(s.event.data,void 0,s.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const t=this._pointerState.get(e);t.pointerDownCount===1&&this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_getPointerId(e){const{pointerId:t,pointerType:s,button:n}=e.native;return s==="mouse"?`${t}:${n}`:`${s}`}_handleImmediateClick(e){const t=e.data,{pointerType:s}=t.native,n=this._getPointerId(t);if(!this._pointerState.has(n))return void this._startClick(e);const o=this._pointerState.get(n),{data:r,modifiers:l}=o.event,d=s==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;Kn(r,t)>d?(this._clearDoubleClickTimer(n,!0),this._startClick(e)):(this._clearDoubleClickTimer(n,!1),o.pointerDownCount===2&&this._doubleClick.emit(r,void 0,l))}_handlePointerDown(e){const t=Ft(e.data),s=this._pointerState.get(t);s&&(s.pointerDownCount+=1)}_startClick(e){const{data:t}=e,{native:{pointerType:s}}=t,n=Ft(t),o=s==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,r=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(n),o),l=1;this._pointerState.set(n,{event:e,doubleClickTimer:r,pointerDownCount:l}),this.refreshHasPendingInputs()}},lp=class extends ee{constructor(e=Ie.maximumDoubleClickDelay,t=Ie.maximumDoubleClickDistance,s=Ie.maximumDoubleTouchDelay,n=Ie.maximumDoubleTouchDistance,o=vs){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=s,this._maximumDoubleTouchDistance=n,this._clock=o,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=pe(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new xs({start:(r,l)=>this._dragStart(r,l),update:(r,l)=>this._dragUpdate(l),end:(r,l)=>this._dragEnd(l)}),this.registerIncoming("drag",r=>this._dragEventSeparator.handle(r)),this.registerIncoming("pointer-down",r=>this._handlePointerDown(r)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(e=>{e.doubleTapTimeout=Ye(e.doubleTapTimeout)})}get hasPendingInputs(){return gs(this._pointerState,e=>e.doubleTapTimeout!=null)}_clearPointerDown(e){const t=this._pointerState.get(e);t&&(t.doubleTapTimeout=Ye(t.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_createDoubleTapDragData(e,t,s){const{button:n,buttons:o,pointer:r,pointers:l,pointerType:d,timestamp:h}=s;return{action:e,delta:t,button:n,buttons:o,pointer:r,pointers:l,pointerType:d,timestamp:h}}_dragStart(e,t){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:s,modifiers:n}=t,{center:o}=s;this._dragStartCenter=o;const r=this._createDoubleTapDragData("begin",pe(0,0),s);this._doubleTapDrag.emit(r,void 0,n),t.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:s}=e,{center:n}=t,o=pe(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),r=this._createDoubleTapDragData("update",o,t);this._doubleTapDrag.emit(r,void 0,s),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:s}=e,{center:n}=t,o=pe(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),r=this._createDoubleTapDragData("end",o,t);this._doubleTapDrag.emit(r,void 0,s),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:t}=e,s=Ft(t),n=this._pointerState.get(s),{pointerType:o}=t.native;if(n){const r=o==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(s),Kn(n.event.data,t)>r?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:t}=e,{pointerType:s}=t.native,n=Ft(t),o=s==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,r=this._clock.setTimeout(()=>this._clearPointerDown(n),o);this._pointerState.set(n,{event:e,doubleTapTimeout:r}),this.refreshHasPendingInputs()}},cp=class extends ee{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,t,s,n){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:t.buttons,timestamp:n,pointers:dp(this._activePointerMap),pointer:t,angle:s.angle,radius:s.radius,center:s.center}}_addPointer(e){const t=e.native.pointerId,s=Ui(this._activePointerMap).angle,n={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(t,n);const o=ts(n,qa(this._activePointerMap));n.initialAngle=o,n.lastAngle=o,this._updatePointerAngles(s)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const t=e.native.pointerId,s=this._activePointerMap.get(t);s?s.event=e:this._addPointer(e)}_removePointer(e){const t=Ui(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(t)}_updatePointerAngles(e){const t=Ui(this._activePointerMap);this._activePointerMap.forEach(s=>{s.initialAngle=ts(s,t)-e,s.lastAngle=ts(s,t)-e})}_emitEvent(e,t,s){const n=Ui(this._activePointerMap);this._drag.emit(this._createPayload(e,t,n,s),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const t=e.data.native.pointerId,s=$s(e.timestamp);this._activePointerMap.get(t)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,s),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(t)):(this._removePointer(t),this._emitEvent("removed",e.data,$s(e.timestamp))))}_handlePointerDrag(e){const t=e.data,s=t.currentEvent,n=$s(e.timestamp);switch(t.action){case"start":case"update":this._isDragging?this._activePointerMap.has(s.native.pointerId)?(this._updatePointer(s),!this._isCurrentDragSuppressed&&this._emitEvent("update",s,n)):(this._addPointer(s),this._emitEvent("added",s,n),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(s),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",s,n))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function qa(i){const e=[];return i.forEach(t=>{e.push(pe(t.event.x,t.event.y))}),rp(e)}function Ui(i){const e=qa(i);let t=0;return i.forEach(s=>{let n=ts(s,e),o=n-s.lastAngle;for(;o>Math.PI;)o-=2*Math.PI;for(;o<-Math.PI;)o+=2*Math.PI;n=s.lastAngle+o,s.lastAngle=n;const r=n-s.initialAngle;t+=r}),t/=i.size||1,{angle:t,radius:e.radius,center:e.center}}function dp(i){const e=new Map;return i.forEach((t,s)=>e.set(s,t.event)),e}function ts(i,e){const t=i.event,s=t.x-e.center.x,n=t.y-e.center.y;return Math.atan2(n,s)}var mr;(function(i){i[i.Left=0]="Left",i[i.Middle=1]="Middle",i[i.Right=2]="Right",i[i.Back=3]="Back",i[i.Forward=4]="Forward",i[i.Undefined=-1]="Undefined"})(mr||(mr={}));let hp=class extends ee{constructor(e=Ie.maximumDoubleClickDelay,t=Ie.maximumDoubleClickDistance,s=Ie.maximumDoubleTouchDelay,n=Ie.maximumDoubleTouchDistance,o=vs){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=s,this._maximumDoubleTouchDistance=n,this._clock=o,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const t=e.data,s=Ft(t);if(!this._pointerState.has(s)){const n={downButton:t.native.button,immediateDoubleClick:null};this._pointerState.set(s,n),this.startCapturingPointer(t.native)}}_handlePointerUp(e){const t=e.data,s=Ft(t),n=this._pointerState.get(s);if(n&&n.downButton===t.native.button){const o=n.immediateDoubleClick;if(o){o.timeoutHandle.remove();const r=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;Kn(o,e.data)>r?this._startImmediateDoubleClick(e,n):(this._immediateDoubleClick.emit(e.data,void 0,o.modifiers),this._removeState(t))}else this._startImmediateDoubleClick(e,n)}}_startImmediateDoubleClick(e,t){const s=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;t.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),s)}}_removeState(e){const t=Ft(e);this._pointerState.delete(t),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}};const mi={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500};let up=class extends ee{constructor(e=mi.maximumClickDelay,t=mi.movementUntilMouseDrag,s=mi.movementUntilPenDrag,n=mi.movementUntilTouchDrag,o=mi.holdDelay,r=vs){super(!1),this._maximumClickDelay=e,this._movementUntilMouseDrag=t,this._movementUntilPenDrag=s,this._movementUntilTouchDrag=n,this._holdDelay=o,this._clock=r,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",l=>{this._handlePointerLoss(l,"pointer-up")}),this.registerIncoming("pointer-capture-lost",l=>{this._handlePointerLoss(l,"pointer-capture-lost")}),this.registerIncoming("pointer-cancel",l=>{this._handlePointerLoss(l,"pointer-cancel")}),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=Ye(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const t=e.data,s=t.native.pointerId;let n=null;this._pointerState.size===0&&(n=this._clock.setTimeout(()=>{const r=this._pointerState.get(s);if(r){if(!r.isDragging){const l=r.previousEvent;this._pointerHold.emit(l,void 0,e.modifiers),r.holdEmitted=!0}r.holdTimeout=null}},this._holdDelay));const o={startEvent:t,previousEvent:t,startTimestamp:e.timestamp,isDragging:!1,downButton:t.native.button,holdTimeout:n,modifiers:new Set};this._pointerState.set(s,o),this.startCapturingPointer(t.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_createPointerDragData(e,t,s){return{action:e,startEvent:t.startEvent,previousEvent:t.previousEvent,currentEvent:s}}_handlePointerMove(e){const t=e.data,s=t.native.pointerId,n=this._pointerState.get(s);n&&(n.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",n,t),void 0,n.modifiers):op(t,n.startEvent)>this._getDragThreshold(t.native.pointerType)&&this._startDragging(e),n.previousEvent=t)}_getDragThreshold(e){switch(e){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(e){const t=e.data,s=t.native.pointerId;this._pointerState.forEach(n=>{n.holdTimeout!=null&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging||(n.modifiers=e.modifiers,n.isDragging=!0,s===n.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",n,t)):this._pointerDrag.emit(this._createPointerDragData("start",n,n.previousEvent),e.timestamp))})}_handlePointerLoss(e,t){const s=e.data,n=s.native.pointerId,o=this._pointerState.get(n);o&&(o.holdTimeout!=null&&(o.holdTimeout.remove(),o.holdTimeout=null),o.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",o,t==="pointer-up"?s:o.previousEvent),void 0,o.modifiers):t==="pointer-up"&&o.downButton===s.native.button&&e.timestamp-o.startTimestamp<=this._maximumClickDelay&&!o.holdEmitted&&this._immediateClick.emit(s),this._pointerState.delete(n),this.stopCapturingPointer(s.native),this._pointerState.size===0&&this._moveHandle.pause())}};const Hi={counter:"Ctrl",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}};let Mt=class extends D{constructor(){super(...arguments),this._handles=new gt}initialize(){const e=()=>{var t;return(t=this.view)==null?void 0:t.ready};this._handles.add([Qe(()=>!e(),()=>this._disconnect()),Qe(e,()=>this._connect())])}destroy(){this._handles=re(this._handles),this._disconnect()}get latestPointerType(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerType}get latestPointerLocation(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerLocation}get multiTouchActive(){var e;return((e=this._inputManager)==null?void 0:e.multiTouchActive)??!1}_disconnect(){this.view.viewEvents.disconnect(),this._inputManager=re(this._inputManager)}_connect(){const e=this.view.surface,t=new za(e,this.view.input),s=[new hp,new up,new ap,new cp(this.view.navigation),new lp],n=new $e({eventSource:t,recognizers:s});n.installHandlers("prevent-context-menu",[new np],pt.INTERNAL),n.installHandlers("navigation",[new Qu(this.view),new Bu(this.view),new Ku(this.view),new dr(this.view),new dr(this.view,[Hi.counter]),new Du(this.view,"primary"),new ju(this.view,Hi.pan),new Wu(this.view,Hi.zoom),new Gu(this.view,Hi.rotate),new Ou(this.view,"secondary"),new Su(this.view,"touch")],pt.INTERNAL),this.view.viewEvents.connect(n),this._source=t,this._inputManager=n,y(()=>{var o,r;return(r=(o=this.view)==null?void 0:o.navigation)==null?void 0:r.browserTouchPanEnabled},o=>{this._source&&(this._source.browserTouchPanningEnabled=!o)},O)}get test(){return{inputManager:this._inputManager}}};a([c()],Mt.prototype,"view",void 0),a([c()],Mt.prototype,"latestPointerType",null),a([c()],Mt.prototype,"latestPointerLocation",null),a([c()],Mt.prototype,"multiTouchActive",null),Mt=a([I("esri.views.2d.input.MapViewInputManager")],Mt);const pp=Mt;let It=class extends D{constructor(){super(...arguments),this.color=new Pi([0,255,255]),this.haloOpacity=1,this.fillOpacity=.25}equals(e){return this.color.equals(e.color)&&(this.haloColor||this.color).equals(e.haloColor||e.color)&&this.haloOpacity===e.haloOpacity&&this.fillOpacity===e.fillOpacity}};a([c({type:Pi})],It.prototype,"color",void 0),a([c({type:Pi})],It.prototype,"haloColor",void 0),a([c()],It.prototype,"haloOpacity",void 0),a([c()],It.prototype,"fillOpacity",void 0),It=a([I("esri.views.2d.support.HighlightOptions")],It);const Ua=It,mp=i=>i.includes("Brush");let Ha=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),mp(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}};function gp(i,e,t,s,n,o,r,l){i.ignorePadding&&(s={left:0,right:0,top:0,bottom:0});let d=null;i.width!=null&&i.height!=null?d=[i.width,i.height]:i.width==null&&i.height!=null?d=[i.height,i.height]:i.width!=null&&i.height==null?d=[i.width,i.width]:i.width==null&&i.height==null&&(d=null);const h=t[0]-(s.left+s.right),u=t[1]-(s.top+s.bottom);let p,g,f=i.area||{x:0,y:0,width:h,height:u};if(d){const b=h/u,C=d[0]/d[1];if(C>b){const P=f.width/C;f={x:f.x,y:Math.round(f.y+(f.height-P)/2),width:f.width,height:Math.round(P)}}else{const P=f.height*C;f={x:Math.round(f.x+(f.width-P)/2),y:f.y,width:Math.round(P),height:f.height}}}else d=[f.width,f.height];return d[0]>f.width?(p=Math.min(d[0]/f.width,e),g=d[0]/f.width/p):(p=1,g=d[0]/f.width),{resolutionScale:p,cropArea:{x:Math.round((f.x+s.left)*p),y:Math.round((f.y+s.top)*p),width:Math.round(f.width*p),height:Math.round(f.height*p)},outputScale:g,format:n,quality:o,children:r,rotation:l}}function fp(i,e,t){const{ctx:s,canvas:n}=ja(i,t),o=s.getImageData(0,0,i.width,i.height),r=vp(n,e);return Ga(n),{dataUrl:r,data:o}}function _p(i,e){const{ctx:t,canvas:s}=ja(i,e),n=t.getImageData(0,0,i.width,i.height);return Ga(s),n}function ja(i,e){const t=yp();e.premultipliedAlpha&&Cp(i),t.width=i.width,t.height=i.height;const s=t.getContext("2d",{willReadFrequently:!0});return s.putImageData(i,0,0),e.flipY&&Ip(s),{ctx:s,canvas:t}}function Ga(i){i.width=0,i.height=0}function yp(){return F(Xs)&&(Xs=document.createElement("canvas")),Xs}let Xs=null;function vp(i,e){const t=Tp[e.format],s=e.quality/100;return i.toDataURL(t,s)}function wp(i,e){const t=Mp(i),s=Ep[t];return{format:t,quality:rs(e??s,0,100)}}function bp(i,e){return e/Math.max(i[0],i[1])}function Wg(i,e,t,s=0,n=0,o=i.width-s,r=i.height-n,l=!1){const{data:d}=i,{width:h,height:u,data:p}=e,g=o/h,f=r/u,b=Math.ceil(g/2),C=Math.ceil(f/2),P=i.width;for(let A=0;A<u;A++)for(let N=0;N<h;N++){const L=4*(N+(l?u-A-1:A)*h);let H=0,Y=0,te=0,q=0,St=0,Di=0;const ai=(A+.5)*f;for(let Dt=Math.floor(A*f);Dt<(A+1)*f;Dt++){const Oi=Math.abs(ai-(Dt+.5))/C,ol=(N+.5)*g,rl=Oi*Oi;for(let Vi=Math.floor(N*g);Vi<(N+1)*g;Vi++){const Qn=Math.abs(ol-(Vi+.5))/b,Ot=Math.sqrt(rl+Qn*Qn);if(Ot>=1)continue;let Je=2*Ot*Ot*Ot-3*Ot*Ot+1;const Vt=4*(s+Vi+(n+Dt)*P);Di+=Je*d[Vt+3],Y+=Je,!t&&d[Vt+3]<255&&(Je=Je*d[Vt+3]/255),te+=Je*d[Vt],q+=Je*d[Vt+1],St+=Je*d[Vt+2],H+=Je}}p[L]=te/H,p[L+1]=q/H,p[L+2]=St/H,p[L+3]=Di/Y}return e}function Mp(i){switch(i){case"png":case"jpg":case"jpeg":return i;default:return xp}}function Ip(i){i.save(),i.globalCompositeOperation="copy",i.scale(1,-1),i.translate(0,-i.canvas.height),i.drawImage(i.canvas,0,0),i.restore()}function Cp(i){const e=i.data,t=e.length;for(let s=0;s<t;s+=4){const n=e[s+3];if(n!==255&&n>0){const o=255/n;e[s+0]=e[s+0]*o,e[s+1]=e[s+1]*o,e[s+2]=e[s+2]*o}}}const Tp={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},gr=98,xp="png",Ep={png:100,jpg:gr,jpeg:gr};function kp(i){const e=Fc(i);if(!e.available)return new k("webgl:required","WebGL is required but not supported.");if(i==="3d"&&e.majorPerformanceCaveat)return new k("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.");if(!e.supportsHighPrecisionFragment)return new k("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported.");if(!e.supportsVertexShaderSamplers)return new k("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported.");if(e.type===Rc.WEBGL1){if(!e.supportsElementIndexUint)return new k("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported.");if(!e.supportsStandardDerivatives)return new k("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported.");if(!e.supportsInstancedArrays)return new k("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported.")}return null}function $p(i){return i&&"nodeType"in i}function Pp(i){return i&&typeof i.render=="function"}const fr={component:"esri-component"};let Ct=class extends D{constructor(){super(...arguments),this.widget=null}destroy(){this.widget&&this.widget.destroy(),this.node=null}get id(){return this.get("widget.id")||this.get("node.id")}set node(e){const t=this._get("node");e!==t&&(e&&e.classList.add(fr.component),t&&t.classList.remove(fr.component),this._set("node",e))}castNode(e){return e?typeof e=="string"||$p(e)?(this._set("widget",null),qr(e)):(Pp(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};a([c({dependsOn:[]})],Ct.prototype,"id",null),a([c()],Ct.prototype,"node",null),a([Xe("node")],Ct.prototype,"castNode",null),a([c({readOnly:!0})],Ct.prototype,"widget",void 0),Ct=a([I("esri.views.ui.Component")],Ct);const is=Ct,Ap={left:0,top:0,bottom:0,right:0},Wa={bottom:30,top:15,right:15,left:15},Js="manual",qe="esri-ui",de={ui:qe,corner:`${qe}-corner`,innerContainer:`${qe}-inner-container`,manualContainer:`${qe}-manual-container`,cornerContainer:`${qe}-corner-container`,topLeft:`${qe}-top-left`,topRight:`${qe}-top-right`,bottomLeft:`${qe}-bottom-left`,bottomRight:`${qe}-bottom-right`};function Fp(i){return i&&!i._started&&typeof i.postMixInProperties=="function"&&typeof i.buildRendering=="function"&&typeof i.postCreate=="function"&&typeof i.startup=="function"}function en(i){const e=i,t=typeof e=="object"&&e!==null&&Object.getPrototypeOf(e);return(t===null||t===Object.prototype)&&("component"in e||"index"in e||"position"in e)?i:null}function tn(i,{top:e,bottom:t,left:s,right:n}){i.style.top=e,i.style.bottom=t,i.style.left=s,i.style.right=n}let Ae=class extends xn.EventedAccessor{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentToKey=new Map,this._locale=Tr(),this.view=null,this._applyViewPadding=()=>{const t=this.container;t&&tn(t,this._toPxPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const t=this._innerContainer;t&&tn(t,this._toPxPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([y(()=>{var e;return[(e=this.view)==null?void 0:e.padding,this.container]},this._applyViewPadding,O),y(()=>this.padding,this._applyUIPadding,O),y(()=>[this.container,this._locale],([e,t])=>{e&&e.setAttribute("lang",t)},O),Yl(e=>{this._locale=e})])}destroy(){this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._componentToKey.clear()}set container(e){const t=this._get("container");e!==t&&(e&&(e.classList.add(de.ui),cc(e),this._attachContainers(e)),t&&(t.classList.remove(de.ui),tn(t,{top:"",bottom:"",left:"",right:""}),Ur(t)),this._set("container",e))}get height(){const e=this.get("view.height")||0;if(e===0)return e;const t=this._getViewPadding(),s=t.top+t.bottom;return Math.max(e-s,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return typeof e=="number"?{bottom:e,top:e,right:e,left:e}:{...Wa,...e}}get width(){const e=this.get("view.width")||0;if(e===0)return e;const t=this._getViewPadding(),s=t.left+t.right;return Math.max(e-s,0)}add(e,t){let s,n;if(Array.isArray(e))return void e.forEach(r=>this.add(r,t));const o=en(e);o&&({index:s,position:t,component:e,key:n}=o),t&&typeof t=="object"&&({index:s,key:n,position:t}=t),!e||t&&!this._isValidPosition(t)||this._add(e,t,s,n)}remove(e,t){if(!e)return;if(Array.isArray(e))return e.map(n=>this.remove(n,t));const s=this._find(e);if(s){const n=this._componentToKey;if(n.has(e)&&n.get(e)!==t)return;const o=this._components.indexOf(s);return s.node.parentNode&&s.node.parentNode.removeChild(s.node),this._componentToKey.delete(e),this._components.splice(o,1)[0]}}empty(e){return Array.isArray(e)?e.map(t=>this.empty(t)).reduce((t,s)=>t.concat(s)):(e=e||Js)===Js?Array.prototype.slice.call(this._manualContainer.children).filter(t=>!t.classList.contains(de.corner)).map(t=>this.remove(t)):this._isValidPosition(e)?Array.prototype.slice.call(this._cornerNameToContainerLookup[e].children).map(this.remove,this):null}move(e,t){if(Array.isArray(e)&&e.forEach(r=>this.move(r,t)),!e)return;let s;const n=en(e)||en(t);if(n&&(s=n.index,t=n.position,e=n.component||e),t&&!this._isValidPosition(t))return;const o=this.remove(e);o&&this.add(o,{position:t,index:s})}find(e){if(!e)return null;const t=this._findById(e);return t&&(t.widget||t.node)}getPosition(e){for(const t in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[t].contains(e))return t;return null}_add(e,t,s,n){e instanceof is||(e=new is({node:e})),this._place({component:e,position:t,index:s}),this._components.push(e),n&&this._componentToKey.set(e,n)}_find(e){return e?e instanceof is?this._findByComponent(e):typeof e=="string"?this._findById(e):this._findByNode(e.domNode||e):null}_getViewPadding(){return this.get("view.padding")||Ap}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(de.innerContainer),e.classList.add(de.cornerContainer);const t=document.createElement("div");t.classList.add(de.innerContainer),t.classList.add(de.manualContainer);const s=document.createElement("div");s.classList.add(de.topLeft),s.classList.add(de.corner),e.appendChild(s);const n=document.createElement("div");n.classList.add(de.topRight),n.classList.add(de.corner),e.appendChild(n);const o=document.createElement("div");o.classList.add(de.bottomLeft),o.classList.add(de.corner),e.appendChild(o);const r=document.createElement("div");r.classList.add(de.bottomRight),r.classList.add(de.corner),e.appendChild(r),this._innerContainer=e,this._manualContainer=t;const l=De();this._cornerNameToContainerLookup={"top-left":s,"top-right":n,"bottom-left":o,"bottom-right":r,"top-leading":l?n:s,"top-trailing":l?s:n,"bottom-leading":l?r:o,"bottom-trailing":l?o:r},this._positionNameToContainerLookup={manual:t,...this._cornerNameToContainerLookup}}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){const t=e.component,s=e.position||Js,n=e.index,o=this._positionNameToContainerLookup[s],r=n!=null&&n>-1;if(Fp(t.widget)&&t.widget.startup(),!r)return void o.appendChild(t.node);const l=Array.prototype.slice.call(o.children);if(n===0)return void(o.firstChild?lo(t.node,o.firstChild):o.appendChild(t.node));n>=l.length?o.appendChild(t.node):lo(t.node,l[n])}_toPxPosition(e){return{top:this._toPxUnit(e.top),left:this._toPxUnit(e.left),right:this._toPxUnit(e.right),bottom:this._toPxUnit(e.bottom)}}_toPxUnit(e){return e===0?"0":e+"px"}_findByComponent(e){let t,s=null;return this._components.some(n=>(t=n===e,t&&(s=n),t)),s}_findById(e){let t,s=null;return this._components.some(n=>(t=n.id===e,t&&(s=n),t)),s}_findByNode(e){let t,s=null;return this._components.some(n=>(t=n.node===e,t&&(s=n),t)),s}};a([c()],Ae.prototype,"_locale",void 0),a([c()],Ae.prototype,"container",null),a([c()],Ae.prototype,"height",null),a([c({value:Wa})],Ae.prototype,"padding",null),a([Xe("padding")],Ae.prototype,"castPadding",null),a([c()],Ae.prototype,"view",void 0),a([c()],Ae.prototype,"width",null),Ae=a([I("esri.views.ui.UI")],Ae);const Rp=Ae;function _r(i,e){return i&&"copyright"in i&&(!e||typeof i.originOf=="function"&&i.originOf("copyright")==="user")}function Lp(i,e){return i.length!==e.length||i.some((t,s)=>t.text!==e[s].text)}function ji(i,e,t){!t||!e||i.find(s=>s.layerView===e&&s.text===t)||i.push({text:t,layerView:e})}function Sp(i){return i.type==="bing-maps"}const tt=[];let Zt=class extends Fr{constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.handles.remove("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new W,this.view=null,this._allLayerViewsChange=t=>{this.handles.remove("suspension");const s=this.get("view.allLayerViews");s&&this.handles.add(s.map(n=>y(()=>{var o;return[n.suspended,(o=n.layer)==null?void 0:o.attributionVisible]},()=>this._updateAttributionItems())),"suspension"),t&&t.removed&&t.removed.forEach(n=>{this._pendingAttributions.delete(n),this._fetchedAttributionData.delete(n)}),this._updateAttributionItems()},this.handles.add([xe(()=>{var t;return(t=this.view)==null?void 0:t.allLayerViews},"change",t=>this._allLayerViewsChange(t),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),Qe(()=>{var t;return((t=this.view)==null?void 0:t.stationary)===!0},()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.get("view.ready")?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const e=this.view,t=e==null?void 0:e.allLayerViews;tt.length=0,e&&t?(t.forEach(s=>{var r;if(s.suspended||!((r=s.layer)!=null&&r.attributionVisible))return;const n=s.layer;if(_r(n,"user"))return void ji(tt,s,n.copyright);if(n.hasAttributionData){if(this._fetchedAttributionData.has(s)){const l=this._fetchedAttributionData.get(s);return void(l?ji(tt,s,this._getDynamicAttribution(l,e,n)):_r(n)&&ji(tt,s,n.copyright))}return void this._fetchAttributionData(s)}const o=n.get("portalItem.accessInformation");ji(tt,s,o||n.copyright)}),Lp(this.items,tt)&&(this.items.removeAll(),this.items.addMany(tt)),tt.length=0,this.notifyChange("state")):this._clear()}async _fetchAttributionData(e){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);const t=await Xl(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){const s=t.ok?this._createContributionIndex(t.value,Sp(e.layer)):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,s)}this._updateAttributionItems()}_createContributionIndex(e,t){const s=e.contributors,n={};if(!s)return n;for(let o=0;o<s.length;o++){const r=s[o],l=r.coverageAreas;if(!l)return;for(const d of l){const h=d.bbox,u=d.zoomMin-(t&&d.zoomMin?1:0),p=d.zoomMax-(t&&d.zoomMax?1:0),g={xmin:h[1],ymin:h[0],xmax:h[3],ymax:h[2],spatialReference:$n.WGS84},f={extent:$r(g),attribution:r.attribution||"",score:d.score!=null?d.score:100,id:o};for(let b=u;b<=p;b++)n[b]=n[b]||[],n[b].push(f)}}return n.maxKey=Math.max.apply(null,Object.keys(n)),n}_getDynamicAttribution(e,t,s){var u;const{extent:n,scale:o}=t;let r=((u=s.tileInfo)==null?void 0:u.scaleToZoom(o))??0;if(r=Math.min(e.maxKey??0,Math.round(r)),!n||r==null||r<=-1)return"";const l=e[r],d=Jl(n.center.clone().normalize(),t.spatialReference),h={};return l?l.filter(p=>{const g=p.id,f=!h[g]&&d&&p.extent&&Vr(p.extent,d);return f&&(h[g]=!0),f}).sort((p,g)=>g.score-p.score||p.objectId-g.objectId).map(p=>p.attribution).join(", "):""}};a([c({readOnly:!0,type:W})],Zt.prototype,"items",void 0),a([c({readOnly:!0})],Zt.prototype,"state",null),a([c()],Zt.prototype,"view",void 0),Zt=a([I("esri.widgets.Attribution.AttributionViewModel")],Zt);const Za=Zt,qt="esri-attribution",it={base:`${qt} esri-widget`,poweredBy:`${qt}__powered-by`,sources:`${qt}__sources`,open:`${qt}--open`,sourcesOpen:`${qt}__sources--open`,link:`${qt}__link`,widgetIcon:"esri-icon-description",interactive:"esri-interactive"};let ue=class extends le{constructor(e,t){super(e,t),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver(s=>s.forEach(({target:n})=>this._checkSourceTextOverflow(n))),this.iconClass=it.widgetIcon,this.itemDelimiter=" | ",this.messages=null,this.viewModel=new Za}initialize(){this.addHandles(xe(()=>{var e;return(e=this.viewModel)==null?void 0:e.items},"change",()=>this.scheduleRender()))}destroy(){var e;(e=this._resizeObserver)==null||e.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce((e,t)=>(e.includes(t.text)||e.push(t.text),e),[]).join(this.itemDelimiter)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[it.open]:this._isOpen};return m("div",{bind:this,class:this.classes(it.base,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())}renderPoweredBy(){return m("div",{class:it.poweredBy},"Powered by"," ",m("a",{class:it.link,href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))}renderSourcesNode(){const e=this._isOpen,t=this._isInteractive,s=t?"0":"",{attributionText:n}=this,o={[it.sourcesOpen]:e,[it.interactive]:t};return m("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(it.sources,o),innerHTML:n,tabindex:s})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let t=!1;const{clientHeight:s,clientWidth:n,scrollWidth:o}=e,r=o>n,l=this._attributionTextOverflowed!==r;if(this._attributionTextOverflowed=r,l&&(t=!0),this._isOpen){const d=s<this._prevSourceNodeHeight;this._prevSourceNodeHeight=s,d&&(this._isOpen=!1,t=!0)}t&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};a([c()],ue.prototype,"_isOpen",void 0),a([c()],ue.prototype,"_isInteractive",null),a([c()],ue.prototype,"_attributionTextOverflowed",void 0),a([c()],ue.prototype,"_prevSourceNodeHeight",void 0),a([c({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],ue.prototype,"attributionText",null),a([c()],ue.prototype,"iconClass",void 0),a([c()],ue.prototype,"itemDelimiter",void 0),a([c()],ue.prototype,"label",null),a([c(),ae("esri/widgets/Attribution/t9n/Attribution")],ue.prototype,"messages",void 0),a([c()],ue.prototype,"view",null),a([c({type:Za})],ue.prototype,"viewModel",void 0),a([Me()],ue.prototype,"_toggleState",null),ue=a([I("esri.widgets.Attribution")],ue);const Dp=ue,Op="esri.widgets.CompassViewModel";let Tt=class extends Hr(D){constructor(e){super(e),this._handles=new gt,this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._handles.add(y(()=>this.view,this._updateRotationWatcher,O))}destroy(){Ye(this._handles),this.view=null}get canShowNorth(){const e=this.get("view.spatialReference");return!(!e||!e.isWebMercator&&!e.isGeographic)}get state(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"}reset(){var t;if(!this.get("view.ready"))return;const e={};((t=this.view)==null?void 0:t.type)==="2d"?e.rotation=0:e.heading=0,this.callGoTo({target:e})}_updateForRotation(e){e!=null&&(this.orientation={z:e})}_updateForCamera(e){if(!e)return;const t=-e.heading;this.orientation={x:0,y:0,z:t}}_updateRotationWatcher(e){this._handles.removeAll(),e&&this._handles.add(e.type==="2d"?y(()=>e==null?void 0:e.rotation,this._updateForRotation,O):y(()=>e==null?void 0:e.camera,this._updateForCamera,O))}};a([c({readOnly:!0})],Tt.prototype,"canShowNorth",null),a([c()],Tt.prototype,"orientation",void 0),a([c({readOnly:!0})],Tt.prototype,"state",null),a([c()],Tt.prototype,"view",void 0),Tt=a([I(Op)],Tt);const Ka=Tt,st={base:"esri-compass esri-widget--button esri-widget",text:"esri-icon-font-fallback-text",icon:"esri-compass__icon",rotationIcon:"esri-icon-dial",northIcon:"esri-icon-compass",widgetIcon:"esri-icon-locate-circled",interactive:"esri-interactive",disabled:"esri-disabled"};let Fe=class extends le{constructor(e,t){super(e,t),this.iconClass=st.widgetIcon,this.messages=null,this.viewModel=new Ka}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:t}=this.viewModel,s=t==="disabled",n=(t==="rotation"?"rotation":"compass")=="compass",o=s?-1:0,r={[st.disabled]:s,[st.interactive]:!s},l={[st.northIcon]:n,[st.rotationIcon]:!n},{messages:d}=this;return m("div",{bind:this,class:this.classes(st.base,r),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:o,"aria-label":d.reset,title:d.reset},m("span",{"aria-hidden":"true",class:this.classes(st.icon,l),styles:this._toRotationTransform(e)}),m("span",{class:st.text},d.reset))}_reset(){this.viewModel.reset()}_toRotationTransform(e){return{transform:`rotateZ(${e.z}deg)`}}};a([c()],Fe.prototype,"goToOverride",null),a([c()],Fe.prototype,"iconClass",void 0),a([c()],Fe.prototype,"label",null),a([c(),ae("esri/widgets/Compass/t9n/Compass")],Fe.prototype,"messages",void 0),a([c()],Fe.prototype,"view",null),a([c({type:Ka})],Fe.prototype,"viewModel",void 0),a([Me()],Fe.prototype,"_reset",null),Fe=a([I("esri.widgets.Compass")],Fe);const Vp=Fe,Ut="esri-navigation-toggle",ve={base:`${Ut} esri-widget`,button:`${Ut}__button esri-widget--button`,activeButton:`${Ut}__button--active`,panButton:`${Ut}__button--pan`,rotateButton:`${Ut}__button--rotate`,isLayoutHorizontal:`${Ut}--horizontal`,rotationIcon:"esri-icon-rotate",panIcon:"esri-icon-pan",widgetIcon:"esri-icon-pan2",disabled:"esri-disabled"};let Kt=class extends D{constructor(i){super(i),this.navigationMode="pan",this.view=null}initialize(){this.own(Qe(()=>{var i;return(i=this.view)==null?void 0:i.inputManager},()=>this._setNavigationMode()))}destroy(){this.view=null}get state(){var i;return this.get("view.ready")&&((i=this.view)==null?void 0:i.type)==="3d"?"ready":"disabled"}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate",this._setNavigationMode())}_setNavigationMode(){this.get("view.inputManager").primaryDragAction=this.navigationMode==="pan"?"pan":"rotate"}};a([c({readOnly:!0})],Kt.prototype,"state",null),a([c()],Kt.prototype,"navigationMode",void 0),a([c()],Kt.prototype,"view",void 0),Kt=a([I("esri.widgets.NavigationToggleViewModel")],Kt);const Qa=Kt;let Re=class extends le{constructor(e,t){super(e,t),this.iconClass=ve.widgetIcon,this.messages=null,this.viewModel=new Qa}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}toggle(){return this.viewModel.toggle()}render(){const e=this.get("viewModel.state")==="disabled",t=this.get("viewModel.navigationMode")==="pan",s={[ve.disabled]:e,[ve.isLayoutHorizontal]:this.layout==="horizontal"},n={[ve.activeButton]:t},o={[ve.activeButton]:!t},r=e?-1:0,l=this.messages.toggle;return m("div",{bind:this,class:this.classes(ve.base,s),onclick:this._toggle,onkeydown:this._toggle,tabIndex:r,"aria-label":l,title:l},m("div",{class:this.classes(ve.button,ve.panButton,n)},m("span",{class:ve.panIcon})),m("div",{class:this.classes(ve.button,ve.rotateButton,o)},m("span",{class:ve.rotationIcon})))}_toggle(){this.toggle()}};a([c()],Re.prototype,"iconClass",void 0),a([c()],Re.prototype,"label",null),a([c({value:"vertical"})],Re.prototype,"layout",null),a([c(),ae("esri/widgets/NavigationToggle/t9n/NavigationToggle")],Re.prototype,"messages",void 0),a([c()],Re.prototype,"view",null),a([c({type:Qa})],Re.prototype,"viewModel",void 0),a([Me()],Re.prototype,"_toggle",null),Re=a([I("esri.widgets.NavigationToggle")],Re);const Np=Re,gi={button:"esri-widget--button esri-widget",disabled:"esri-disabled",interactive:"esri-interactive",iconText:"esri-icon-font-fallback-text",icon:"esri-icon"};let dt=class extends le{constructor(){super(...arguments),this.enabled=!0,this.iconClass="",this.title=""}render(){const i=this.enabled?0:-1,e={[gi.disabled]:!this.enabled,[gi.interactive]:this.enabled},t={[this.iconClass]:!!this.iconClass};return m("div",{bind:this,class:this.classes(gi.button,e),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:i,title:this.title},m("span",{"aria-hidden":"true",role:"presentation",class:this.classes(gi.icon,t)}),m("span",{class:gi.iconText},this.title))}_triggerAction(){this.action.call(this)}};a([c()],dt.prototype,"action",void 0),a([c()],dt.prototype,"enabled",void 0),a([c()],dt.prototype,"iconClass",void 0),a([c()],dt.prototype,"title",void 0),a([Me()],dt.prototype,"_triggerAction",null),dt=a([I("esri.widgets.IconButton")],dt);const yr=dt;let Qt=class extends D{get canZoomIn(){if(!this.get("view.ready"))return!1;const i=this.get("view.animation.target.scale")||this.get("view.scale"),e=this.get("view.constraints.effectiveMaxScale");return e===0||i>e}get canZoomOut(){if(!this.get("view.ready"))return!1;const i=this.get("view.animation.target.scale")||this.get("view.scale"),e=this.get("view.constraints.effectiveMinScale");return e===0||i<e}};a([c({readOnly:!0})],Qt.prototype,"canZoomIn",null),a([c({readOnly:!0})],Qt.prototype,"canZoomOut",null),a([c()],Qt.prototype,"view",void 0),Qt=a([I("esri.widgets.Zoom.ZoomConditions2D")],Qt);const zp=Qt;let Yt=class extends D{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};a([c({readOnly:!0})],Yt.prototype,"canZoomIn",null),a([c({readOnly:!0})],Yt.prototype,"canZoomOut",null),a([c()],Yt.prototype,"view",void 0),Yt=a([I("esri.widgets.Zoom.ZoomConditions3D")],Yt);const Bp=Yt;let ht=class extends D{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return M(this._zoomConditions)&&this._zoomConditions.canZoomIn}get canZoomOut(){var e;return M(this._zoomConditions)&&((e=this._zoomConditions)==null?void 0:e.canZoomOut)}get state(){var e;return(e=this.view)!=null&&e.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new zp({view:e}):e.type==="3d"&&(this._zoomConditions=new Bp({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){if(!this.canZoomIn)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomIn():Ti(e.goTo({zoomFactor:2}))}zoomOut(){if(!this.canZoomOut)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomOut():Ti(e.goTo({zoomFactor:.5}))}};a([c()],ht.prototype,"_zoomConditions",void 0),a([c()],ht.prototype,"canZoomIn",null),a([c()],ht.prototype,"canZoomOut",null),a([c({readOnly:!0})],ht.prototype,"state",null),a([c()],ht.prototype,"view",null),ht=a([I("esri.widgets.Zoom.ZoomViewModel")],ht);const Ya=ht,fi={base:"esri-zoom esri-widget",horizontalLayout:"esri-zoom--horizontal",zoomInIcon:"esri-icon-plus",zoomOutIcon:"esri-icon-minus",widgetIcon:"esri-icon-zoom-in-magnifying-glass"};let Ge=class extends le{constructor(e,t){super(e,t),this.iconClass=fi.widgetIcon,this.messages=null,this.viewModel=new Ya}initialize(){this._zoomInButton=new yr({action:this.zoomIn.bind(this),iconClass:fi.zoomInIcon}),this._zoomOutButton=new yr({action:this.zoomOut.bind(this),iconClass:fi.zoomOutIcon})}destroy(){this._zoomInButton=re(this._zoomInButton),this._zoomOutButton=re(this._zoomOutButton)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e=this.viewModel,t={[fi.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:s,canZoomOut:n}=e;this._zoomInButton.enabled=s,this._zoomOutButton.enabled=n;const{zoomIn:o,zoomOut:r}=this.messages;return this._zoomInButton.title=o,this._zoomOutButton.title=r,m("div",{class:this.classes(fi.base,t)},this._zoomInButton.render(),this._zoomOutButton.render())}zoomIn(){return this.viewModel.zoomIn()}zoomOut(){return this.viewModel.zoomOut()}};a([c()],Ge.prototype,"iconClass",void 0),a([c()],Ge.prototype,"label",null),a([c({value:"vertical"})],Ge.prototype,"layout",null),a([c(),ae("esri/widgets/Zoom/t9n/Zoom")],Ge.prototype,"messages",void 0),a([c()],Ge.prototype,"view",null),a([c({type:Ya})],Ge.prototype,"viewModel",void 0),Ge=a([I("esri.widgets.Zoom")],Ge);const qp=Ge;function Up(i){return i&&i.view!==void 0}let ss=class extends Rp{constructor(i){super(i),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[]}initialize(){this.addHandles([y(()=>this.components,this._componentsWatcher.bind(this),O),y(()=>this.view,this._updateViewAwareWidgets.bind(this),O)])}_add(i,e,t,s){let n=i;if(typeof i=="string"&&this._defaultPositionLookup[i]){if(this._find(i))return;n=this._createComponent(i)}super._add(n,e,t,s)}_removeComponents(i){i.forEach(e=>{const t=this._find(e);t&&(this.remove(t),t.destroy())})}_updateViewAwareWidgets(i){this.components.forEach(e=>{const t=this._find(e),s=t&&t.widget;Up(s)&&(s.view=i)})}_componentsWatcher(i,e){this._removeComponents(e),this._addComponents(i),this._adjustPadding(i)}_adjustPadding(i){if(!i.includes("attribution")&&!this._isOverridden("padding")){const{top:e}=this.padding;this.padding=e}}_addComponents(i){this.constructed&&i.forEach(e=>this.add(this._createComponent(e),this._defaultPositionLookup[e]))}_createComponent(i){const e=this._createWidget(i);if(e)return new is({id:i,node:e})}_createWidget(i){return i==="attribution"?this._createAttribution():i==="compass"?this._createCompass():i==="navigation-toggle"?this._createNavigationToggle():i==="zoom"?this._createZoom():void 0}_createAttribution(){return new Dp({view:this.view})}_createCompass(){return new Vp({view:this.view})}_createNavigationToggle(){return new Np({view:this.view})}_createZoom(){return new qp({view:this.view})}};a([c()],ss.prototype,"components",void 0),ss=a([I("esri.views.ui.DefaultUI")],ss);const Hp=ss;let ns=class extends Hp{constructor(i){super(i),this.components=["attribution","zoom"]}};a([c()],ns.prototype,"components",void 0),ns=a([I("esri.views.ui.2d.DefaultUI2D")],ns);const Xa=ns;var In;let os=In=class extends Nr{constructor(i){super(i),this.color=new Pi([0,0,0,1])}clone(){return new In(ec({color:this.color}))}};a([c({type:Pi,json:{write:!0}})],os.prototype,"color",void 0),os=In=a([I("esri.webmap.background.ColorBackground")],os);const jp=os;let Ja,el,tl,il,sl,nl;async function Gp(){const[,{GraphicsView2D:i,GraphicContainer:e,LabelManager:t,MapViewNavigation:s,MagnifierView2D:n,Stage:o}]=await Promise.all([w(()=>import("./webglDeps-e5251b5b.js"),["assets/webglDeps-e5251b5b.js","assets/VertexArrayObject-07c1da56.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/enums-64ab819c.js","assets/ProgramTemplate-9f1c124b.js","assets/programUtils-8e54bcd5.js","assets/NestedMap-1b5db22e.js"]),w(()=>import("./mapViewDeps-6c8c863b.js"),["assets/mapViewDeps-6c8c863b.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/CIMResourceManager-5e539063.js","assets/Rasterizer-7c00bea5.js","assets/_commonjsHelpers-2f3e7994.js","assets/cimAnalyzer-02b56dc2.js","assets/fontUtils-afce1abc.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-5c57438c.js","assets/GeometryUtils-fea59923.js","assets/enums-55085e26.js","assets/utils-bd924f31.js","assets/alignmentUtils-ae955d28.js","assets/definitions-f329b961.js","assets/mat2d-e11be45e.js","assets/vec2-bbd3449a.js","assets/TileStrategy-1967197e.js","assets/TileInfoView-ccee1155.js","assets/quickselect-56c5966e.js","assets/TileKey-b1f5cdb9.js","assets/number-b10bd8f5.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-193e54d0.js","assets/floatRGBA-4f7fa53a.js","assets/rasterizingUtils-74cec9f6.js","assets/imageutils-b0a7b4c6.js","assets/Container-72cba08e.js","assets/EffectView-a1fb6514.js","assets/enums-64ab819c.js","assets/Texture-ca46920b.js","assets/capabilities-57d1a30a.js","assets/BufferPool-34e9b674.js","assets/color-6aec3839.js","assets/VertexElementDescriptor-2925c6af.js","assets/WGLContainer-e2488f5a.js","assets/VertexArrayObject-07c1da56.js","assets/ProgramTemplate-9f1c124b.js","assets/MaterialKey-5b247dd4.js","assets/utils-7263c34f.js","assets/StyleDefinition-fbc907c2.js","assets/config-1337d16e.js","assets/GeometryUtils-dd03fc25.js","assets/earcut-61f7b102.js","assets/vec2f64-22afc56f.js","assets/featureConversionUtils-c00360ef.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/enums-fb086c25.js","assets/programUtils-8e54bcd5.js","assets/NestedMap-1b5db22e.js","assets/MagnifierPrograms-65f59e80.js","assets/pbf-f46def03.js","assets/Matcher-10c827e6.js","assets/visualVariablesUtils-50880e5a.js","assets/visualVariablesUtils-7dbd5d40.js","assets/tileUtils-c2f19f52.js","assets/TurboLine-0c6b5b1e.js","assets/ExpandedCIM-2a6dd26b.js","assets/devEnvironmentUtils-5002a058.js","assets/CircularArray-3a8652cf.js","assets/webgl-debug-b1f7a2c5.js","assets/ComputedAttributeStorage-b555102a.js","assets/arcadeTimeUtils-ef4a84e4.js","assets/executionError-fb3f283a.js","assets/centroid-335ed93e.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/RenderingContext-b944f363.js","assets/OrderIndependentTransparency-e1b3a745.js","assets/basicInterfaces-b7051eb1.js","assets/doublePrecisionUtils-e3c3d0d8.js","assets/mat3-21bcfd83.js","assets/imageUtils-c2d0d1ae.js","assets/GraphicsView2D-734762b1.js","assets/normalizeUtilsSync-f1c7dfdb.js","assets/normalizeUtilsCommon-258cba9f.js","assets/projectionSupport-60e6d2f8.js","assets/json-48e3ea08.js","assets/AttributeStoreView-bcdc844b.js","assets/TiledDisplayObject-accbee08.js","assets/schemaUtils-9a6e7dda.js","assets/createSymbolSchema-21e81f0c.js","assets/util-e5019f71.js","assets/normalizeUtils-703059af.js","assets/utils-3b5f5c5a.js","assets/GraphicContainer-c8c09d12.js","assets/BaseGraphicContainer-862908ea.js","assets/FeatureContainer-86576b95.js","assets/TileContainer-842f76b1.js","assets/vec3f32-ad1dc57f.js","assets/requestImageUtils-4fdc8d80.js","assets/CollectionFlattener-459cb615.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/AttachmentInfo-2f7fbe5e.js","assets/Heading-adb0ad8a.js","assets/symbolUtils-5e5f8d3d.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/colorUtils-c0f43caf.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/executeQueryJSON-ca6c73e1.js","assets/query-d95b3dd5.js","assets/pbfQueryUtils-06c77b54.js","assets/Scheduler-68df8c73.js","assets/layerViewUtils-5da1782e.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js","assets/Map-e64f8eb2.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/TablesMixin-8184194b.js","assets/GraphicsCollection-b80722b0.js","assets/ViewingMode-915d19cb.js","assets/unitBezier-881ac1eb.js"])]);el=i,tl=e,il=t,sl=s,nl=n,Ja=o}const vr=160;function Wp(i){return i&&i.declaredClass==="esri.Viewpoint"}let $=class extends Sc(Fh(Rh(eu))){constructor(i){super(i),this._magnifierView=null,this._stage=null,this._resolveWhenReady=[],this.rootLayerViews=new zr({getCollections:()=>{var e,t;return[(e=this.basemapView)==null?void 0:e.baseLayerViews,this.layerViews,(t=this.basemapView)==null?void 0:t.referenceLayerViews]},getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.fullOpacity=1,this.graphicsView=null,this.labelManager=null,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.rendering=!1,this.supersampleScreenshotsEnabled=!0,this.supportsGround=!1,this._stationaryTimer=null,this._gotoTask=null,this.frameTask=new Tu(this),this._pePromise=null,this.floors=new W,this.highlightOptions=new Ua,this.inputManager=new pp({view:this}),this.map=null,this.resizeAlign="center",this.spatialReferenceLocked=!1,this.timeline=new Ha,this.type="2d",this.ui=new Xa,this._pixelFormat={flipY:!0,premultipliedAlpha:!0},this.constraints=new Na,this.padding={top:0,right:0,bottom:0,left:0},this.handles.add([y(()=>this.viewpoint,()=>{this._lastStationaryEventTimestamp=performance.now(),this._flipStationary(vr)},ki),this.on("resize",e=>this._resizeHandler(e)),y(()=>{var e;return(e=this.animationManager)==null?void 0:e.animation},e=>{this.animation=e})]),tc()}destroy(){this._set("preconditionsReady",!1),this._gotoTask=this.frameTask=null,this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new Pc(this.featuresTilingScheme)}get initialExtentRequired(){var r;const{scale:i,constraints:e,center:t,viewpoint:s,extent:n}=this;let o=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&((r=this.map.initialViewProperties)!=null&&r.viewpoint))&&!n&&(e!=null&&e.effectiveLODs||(o=-1),(!t||i===0&&o===-1)&&(!s||!M(s.targetGeometry)||s.targetGeometry.type!=="extent"&&!s.scale))}get resourceManager(){return this._stage.resourceManager}get textureManager(){return this._stage.painter.textureManager}get _defaultsFromMapSettings(){return{required:{tileInfo:!0,heightModelInfo:!1,extent:!1},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get _projectionEngineLoaded(){return!!$i()||(this._pePromise||(this._pePromise=_s().finally(()=>{this._pePromise=null})),!1)}get typeSpecificPreconditionsReady(){const i=this._getDefaultViewpoint();if(!i)return!1;const e=this.spatialReference,t=be(i.targetGeometry);return!!fs(t.spatialReference,e)||this._projectionEngineLoaded}set animation(i){const e=this._get("animation");if(i===e)return;if(e&&e.stop(),!i||i.isFulfilled())return void this._set("animation",null);this._set("animation",i),this.frameTask.animationInProgress=!0;const t=()=>{var s;i===this._get("animation")&&(this._set("animation",null),(s=this.frameTask)==null||s.requestFrame()),this.frameTask&&(this.frameTask.animationInProgress=!1)};i.when(t,t)}get background(){return Kp(this.map)?this.map.initialViewProperties.background:null}set background(i){this._override("background",i)}get center(){if(!this.ready)return this._get("center");const{center:i,spatialReference:e}=this.state.paddedViewState;return new se({x:i[0],y:i[1],spatialReference:e})}set center(i){if(i==null)return;if(!this.ready)return this._set("center",i),void this.notifyChange("initialExtentRequired");let e;try{e=this._project(i,this.spatialReference)}catch(s){return void V.getLogger(this.declaredClass).error(new k("mapview:invalid-center","could not project the value in the view's spatial reference",{input:i,error:s}))}const t=this.viewpoint;fn(t,t,e),this.viewpoint=t}set constraints(i){const e=this._get("constraints");e&&(this.handles.remove("map-view-constraints"),e.destroy()),this._set("constraints",i),i&&(i.view=this,this.ready&&(this.state.viewpoint=i.fit(this.state.paddedViewState.viewpoint)),this.handles.add(y(()=>i.version,()=>{this.ready&&this.state&&(this.state.viewpoint=i.fit(this.state.paddedViewState.viewpoint))},ki),"map-view-constraints"))}get extent(){return this.ready?this.state.paddedViewState.extent.clone():this._get("extent")}set extent(i){if(i==null)return;if(!i.width||!i.height)return void V.getLogger(this.declaredClass).error(new k("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",i),this._set("center",null),this._set("viewpoint",null),this._set("scale",0),this._set("zoom",-1),void this.notifyChange("initialExtentRequired");let e;try{e=this._project(i,this.spatialReference)}catch(s){return void V.getLogger(this.declaredClass).error(new k("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:s}))}const t=this.viewpoint;cu(t,t,e,this.size,{constraints:this.constraints}),this.viewpoint=t}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(i){this.ready?(this.state.padding=i,this._set("padding",this.state.padding)):this._set("padding",i)}get resolution(){return this.state?this.state.resolution:0}get rotation(){return this.ready?this.state.rotation:this._get("rotation")}set rotation(i){if(isNaN(i))return;if(!this.ready)return void this._set("rotation",i);const e=this.viewpoint;bu(e,e,i),this.viewpoint=e}get scale(){return this.ready?this.state.scale:this._get("scale")}set scale(i){if(!i||isNaN(i))return;if(!this.ready){this._set("scale",i),this._set("zoom",-1);const t=this._get("extent");return t&&(this._set("extent",null),this._set("center",t.center)),void this.notifyChange("initialExtentRequired")}const e=this.viewpoint;rr(e,e,i),this.viewpoint=e}get stationary(){return!(this.animation||this.navigating||this.resizing||this._stationaryTimer)}get updating(){var e,t,s;const i=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(n=>!n.destroyed&&!("layerViews"in n)&&n.updating===!0));if(Se("esri-2d-log-updating")){const n=this.allLayerViews.reduce((o,r)=>({...o,[r.layer.id]:!r.destroyed&&!("layerViews"in r)&&r.updating}),{});console.log(`Updating MapView: ${i}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${(e=this.layerViewManager)==null?void 0:e.updating}
-> labelManager.updating: ${(t=this.labelManager)==null?void 0:t.updating}
-> graphicsView.updating: ${(s=this.graphicsView)==null?void 0:s.updating}
-> allLayerViews: ${JSON.stringify(n)}
`)}return i}get viewpoint(){if(!this.ready)return this._get("viewpoint");const i=this.state.paddedViewState;return i&&i.viewpoint.clone()}set viewpoint(i){if(i==null)return;if(!this.ready)return this._set("viewpoint",i),this._set("extent",null),this._set("center",null),this._set("zoom",-1),this._set("scale",0),void this.notifyChange("initialExtentRequired");let e,t;try{e=this._project(i,this.spatialReference),!i.scale||isNaN(i.scale)?t=new k("mapview:invalid-viewpoint",`invalid scale value of ${i.scale}`):F(i.targetGeometry)&&(t=new k("mapview:invalid-viewpoint","geometry not defined"))}catch(n){t=new k("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:n})}if(t)return void V.getLogger(this.declaredClass).error(t);this._scaleBeforeChangingSpatialReference=null;const s=new Oe({targetGeometry:new se,scale:0,rotation:0});Ee(s,e),this.constraints.constrain(s,this.state.paddedViewState.viewpoint),this.state.viewpoint=s,this.frameTask.requestFrame(),this._set("viewpoint",s)}get zoom(){return this.ready?this.constraints.scaleToZoom(this.scale):this._get("zoom")}set zoom(i){if(i==null)return;if(!this.ready){this._set("zoom",i),this._set("scale",0);const t=this._get("extent");return t&&(this._set("extent",null),this._set("center",t.center)),void this.notifyChange("initialExtentRequired")}if(!this.constraints.effectiveLODs)return void this._set("zoom",-1);const e=this.viewpoint;rr(e,e,this.constraints.zoomToScale(i)),this.viewpoint=e,this._set("zoom",this.constraints.scaleToZoom(this.scale))}get navigating(){return!(!this.mapViewNavigation||!this.mapViewNavigation.interacting)}goTo(i,e){if(i)return this.animation&&(this.animation=null),this._createAnimation(),En(()=>this.ready,e).then(()=>{var n;const t={animate:!0,...e},s=ru(i,this);return(n=this.animation)==null||n.update(s),this._gotoTask={},t.animate?this._gotoAnimated(s,t):this._gotoImmediate(s,t)});V.getLogger(this.declaredClass).error("#goTo()","target cannot be null or undefined")}async hitTest(i,e){const t=tr(i)?er(this,i):i;if(!this.ready||isNaN(t.x)||isNaN(t.y))return{screenPoint:t,results:[]};let s=new Set,n=!1,o=null,r=null;e!=null&&e.include?br(e.include,wr(this,u=>s.add(u),u=>{o||(o=new Set),o.add(u)},u=>s.add(u),()=>n=!0)):(n=!0,s=new Set(this.allLayerViews)),e!=null&&e.exclude&&br(e.exclude,wr(this,u=>s.delete(u),u=>{r||(r=new Set),r.add(u)}));const l=this.allLayerViews.filter(u=>!u.suspended&&s.has(u)).reverse(),d=this.toMap(t);let h=[...n?this.graphicsView.hitTest(d).map(u=>({type:"graphic",graphic:u,layer:null,mapPoint:d})):[],...await Promise.all(l.map(u=>u.hitTest(d,t)).toArray())].filter(M).flat().filter(M);return o&&(h=h.filter(u=>!("graphic"in u)||!u.graphic||(o==null?void 0:o.has(Cn(u.graphic))))),r&&(h=h.filter(u=>!("graphic"in u)||!u.graphic||(r==null?void 0:r.has(Cn(u.graphic))))),{screenPoint:t,results:h}}async takeScreenshot(i){const e=this._createScreenshotPlan(i),t=await this._stage.takeScreenshot(e);return fp(t,{format:e.format,quality:e.quality,rotation:0,disableDecorations:!1},this._pixelFormat)}async _takeScreenshot(i){const e=this._createScreenshotPlan(i),t=await this._stage.takeScreenshot(e);return _p(t,this._pixelFormat)}_createScreenshotPlan(i){i=i??{};const e=this.supersampleScreenshotsEnabled?Math.min(4,bp(this.size,Math.min(4096,this._stage.context.parameters.maxTextureSize))):1;let t;i.layers?(t=[],i.layers.forEach(o=>{const r=this.allLayerViews.find(l=>l.layer.id===o.id);r&&"container"in r&&r.container&&t.push(r.container)})):t=this._stage.children;const{format:s,quality:n}=wp(i.format,i.quality);return gp(i,e,this.size,this.padding,s,n,t,i.rotation)}get test(){return{takeScreenshot:i=>this._takeScreenshot(i)}}toMap(i){if(!this.ready)return null;const e=tr(i)?er(this,i):i,t=[0,0],[s,n]=this.state.toMap(t,[e.x,e.y]),o=this.spatialReference;return new se({x:s,y:n,spatialReference:o})}toScreen(i){if(!this.ready)return null;const e=this._project(i,this.spatialReference),t=[e.x,e.y];return this.state.toScreen(t,t),pe(t[0],t[1])}on(i,e,t,s){return this.inputManager&&this.viewEvents.on(i,e,t,s)||super.on(i,e)}hasEventListener(i){return super.hasEventListener(i)||this.viewEvents.hasHandler(i)}whenLayerView(i){return super.whenLayerView(i)}graphicChanged(i){this.graphicsView&&this.graphicsView.graphicUpdateHandler(i)}whenReady(){return new Promise(i=>{this.ready?i(this):this._resolveWhenReady.push(i)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){var i,e,t;return this.map&&"initialViewProperties"in this.map&&((e=(i=this.map)==null?void 0:i.initialViewProperties)==null?void 0:e.spatialReference)||((t=this.defaultsFromMap)==null?void 0:t.spatialReference)||null}hasLayerViewModule(i){return lr.hasLayerViewModule(i)}importLayerView(i){return lr.importLayerView(i)}pixelSizeAt(){return this.ready?this.state.resolution:(V.getLogger(this.declaredClass).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}popupHitTest(i){return this.hitTest(i).then(e=>({...e,mapPoint:this.toMap(i)}))}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}validate(){let i=kp(this.type);return Se("safari")&&Se("safari")<9&&(i=new k("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:Se("safari")})),M(i)?(V.getLogger(this.declaredClass).warn("#validate()",i.message),Promise.reject(i)):Gp()}_createAnimation(){return this.animation&&!this.animation.done||(this.animation=new gn),this.animation}_cancellableGoTo(i,e,t){const s=()=>i===this._gotoTask,n=t.then(()=>{s()&&(this.animation=null)}).catch(r=>{throw s()&&(e&&!e.done&&(e.stop(),this.frameTask.animationInProgress=!1),this.animation=null),r}),o=new Promise(r=>r(n));return e.when().catch(()=>{s()&&o.cancel&&o.cancel()}),o}_gotoImmediate(i,e){const t=this._gotoTask,s=this.animation,n=i.then(o=>{if(ti(e),t!==this._gotoTask)throw new k("view:goto-interrupted","Goto was interrupted");this.viewpoint=s.target=o,s.finish()});return this._cancellableGoTo(t,s,n)}_flipStationary(i){return this._stationaryTimer!==null||(this._stationaryTimer=setTimeout(()=>{this._stationaryTimer=null;const e=performance.now()-this._lastStationaryEventTimestamp;e<vr&&(this._stationaryTimer=this._flipStationary(e))},i)),this._stationaryTimer}_getDefaultViewpoint(){var P,A,N,L;const{constraints:i,initialExtent:e,map:t,padding:s,size:n}=this;if(!i)return null;const o=t&&"initialViewProperties"in t?t.initialViewProperties:void 0,r={zoom:this._get("zoom"),scale:this._get("scale"),center:this._get("center"),extent:this._get("extent"),rotation:this._get("rotation"),viewpoint:this._get("viewpoint"),spatialReference:this._userSpatialReference};i.effectiveLODs?r.zoom!==-1&&(r.scale=i.zoomToScale(r.zoom)):r.zoom=-1;let l=null,d=null,h=0;const u=r.viewpoint&&r.viewpoint.rotation,p=r.viewpoint&&r.viewpoint.targetGeometry;M(p)&&(p.type==="extent"?l=p:p.type==="point"&&(d=p,h=r.viewpoint.scale));const g=r.extent||l||((A=be((P=o==null?void 0:o.viewpoint)==null?void 0:P.targetGeometry))==null?void 0:A.extent)||e,f=r.center||d||(g==null?void 0:g.center),b=r.scale||h||((N=o==null?void 0:o.viewpoint)==null?void 0:N.scale)||g&&Ei(g,[n[0]-s.left-s.right,n[1]-s.top-s.bottom]),C=r.rotation||u||((L=o==null?void 0:o.viewpoint)==null?void 0:L.rotation)||0;return f&&b?new Oe({targetGeometry:f,scale:b,rotation:C}):null}_gotoAnimated(i,e){const t=this._gotoTask,s=this.animation;if(!s)return Promise.resolve();const n=i.then(o=>{if(ti(e),t!==this._gotoTask)throw new k("view:goto-interrupted","Goto was interrupted");return s.update(o),this.animationManager.animate(s,this.viewpoint,e),s.when().then(()=>{},()=>{})});return this._cancellableGoTo(t,s,n)}_project(i,e){var n;const t=i&&i.targetGeometry||i;if(!e)return i;if(!t)return null;if(e.imageCoordinateSystem||(n=t.spatialReference)!=null&&n.imageCoordinateSystem||ys(e,t.spatialReference))return i;const s=Li(t,e);if(!s)throw new k("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:t,spatialReference:e});return Wp(i)?(i.targetGeometry=s,i):s}_resizeHandler(i){if(!this.ready)return;const e=this.state;let t=this.state.paddedViewState.viewpoint;const s=this.state.paddedViewState.size.concat();e.size=[i.width,i.height],wu(t,t,s,this.state.paddedViewState.size,this.resizeAlign),t=this.constraints.constrain(t,void 0),this.state.viewpoint=t}_startup(){var l,d;this.timeline.begin("MapView Startup");const i=this._getDefaultViewpoint(),e=i.targetGeometry;try{this._project(i,this.spatialReference)}catch(h){V.getLogger(this.declaredClass).warn(new so("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:e.toJSON(),spatialReference:this.spatialReference,error:h})),i.targetGeometry=((l=this.defaultsFromMap.extent)==null?void 0:l.center)||new se({x:0,y:0,spatialReference:this.spatialReference})}(d=this.constraints)==null||d.fit(i),this._set("state",new Lu({padding:this._get("padding"),size:this.size,viewpoint:i})),this.graphics.owner=this;const t=new Ja(this.surface,{canvas:this.renderCanvas,supersampleScreenshots:this.supersampleScreenshotsEnabled,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this._stage=t,this._magnifierView=new nl,this._magnifierView.magnifier=this.magnifier;const s=new il({view:this});this._set("labelManager",s);const n=new Cu({view:this});this._set("animationManager",n);const o=new sl({view:this,animationManager:n});this._set("mapViewNavigation",o),this._setupSpatialReferenceDependentProperties(),this.handles.add([this.rootLayerViews.on("change",()=>this._updateStageChildren()),t.on("post-render",()=>this._set("rendering",t.renderRequested)),t.on("will-render",()=>this._set("rendering",t.renderRequested)),t.on("webgl-error",h=>this.fatalError=h.error),y(()=>this.stationary,h=>t.stationary=h,yt),y(()=>this.background,h=>{t.background=h,this._magnifierView.background=h},yt),y(()=>this.magnifier,h=>this._magnifierView.magnifier=h,yt),y(()=>this.renderingOptions,h=>t.renderingOptions=h,yt),y(()=>this.highlightOptions,h=>t.highlightOptions=h,yt),y(()=>this.state.id,()=>t.state=this.state,yt)],"map-view"),this._updateStageChildren();const r=this._resolveWhenReady;this._resolveWhenReady=[],r.forEach(h=>h(this)),this.timeline.end("MapView Startup"),this.frameTask&&this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.handles.remove("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._stage.destroy(),this._stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask&&this.frameTask.stop(),this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null),this._set("ready",!1);const{center:[i,e],spatialReference:t,rotation:s,scale:n}=this.state.paddedViewState,o=new se({x:i,y:e,spatialReference:t});this._set("viewpoint",null),this._set("extent",null),this._set("center",o),this._set("zoom",-1),this._set("rotation",s),this._set("scale",n),this._set("spatialReference",t),this._set("state",null),this.animation=null}_updateStageChildren(){this._stage.removeAllChildren(),this.rootLayerViews.forEach(e=>{this._stage.addChild(e.container)});const i=this.graphicsView;this._stage.addChild(i.container),this._stage.addChild(this._magnifierView)}_setupSpatialReferenceDependentProperties(){const i=new Ac(sc.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",i);const e=new el({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new tl(i)});this.frameTask.graphicsView=e,this._set("graphicsView",e)}_destroySpatialReferenceDependentProperties(){const i=this.graphicsView;this._set("graphicsView",null),this.frameTask.graphicsView=null,i.destroy(),this._set("featuresTilingScheme",null)}_spatialReferenceChanged(i){if(!this.ready)return;this.frameTask.stop();for(const l of this.allLayerViews)l.processDetach();this._destroySpatialReferenceDependentProperties();const e=this.state.paddedViewState.clone();if(F(this._scaleBeforeChangingSpatialReference))this._scaleBeforeChangingSpatialReference=e.scale;else{const l=e.viewpoint.clone();l.scale=this._scaleBeforeChangingSpatialReference,e.viewpoint=l}const t=e.clone(),[s,n]=e.center;let o=null;try{o=this._project(new se({x:s,y:n,spatialReference:e.spatialReference}),i)}catch(l){$i()||V.getLogger(this.declaredClass).warn(new so("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:o==null?void 0:o.toJSON(),spatialReference:i,error:l}))}o||(o=new se({x:0,y:0,spatialReference:i}));const r=fn(new Oe({targetGeometry:new se,scale:0,rotation:0}),e.viewpoint,o);t.viewpoint=r;try{const d=[e.size[0]/2,e.size[1]/2],h=[d[0]+20,d[1]],u=e.toMap([0,0],h),{x:p,y:g}=this._project(new se({x:u[0],y:u[1],spatialReference:e.spatialReference}),i);u[0]=p,u[1]=g,t.toScreen(u,u);const f=yu(d,u,h),b=Math.hypot(u[0]-d[0],u[1]-d[1])/20;!Number.isFinite(b)||Math.abs(b)>4?(r.rotation=0,r.targetGeometry=new se({x:0,y:0,spatialReference:i})):(r.scale*=b,r.scale>Se("mapview-srswitch-adjust-rotation-scale-threshold")?r.rotation=0:r.rotation+=Number.isFinite(f)?f:0)}catch{}this._get("constraints").constrain(r,void 0),this._get("state").viewpoint=r,this._stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const l of this.allLayerViews)l.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}};$.type="2d",a([c({readOnly:!0})],$.prototype,"animationManager",void 0),a([c({constructOnly:!0})],$.prototype,"deactivatedWebGLExtensions",void 0),a([c({constructOnly:!0})],$.prototype,"debugWebGLExtensions",void 0),a([c({readOnly:!0})],$.prototype,"featuresTilingScheme",void 0),a([c({readOnly:!0})],$.prototype,"fullOpacity",void 0),a([c({readOnly:!0})],$.prototype,"graphicsTileStore",null),a([c()],$.prototype,"graphicsView",void 0),a([c({readOnly:!0})],$.prototype,"state",void 0),a([c()],$.prototype,"initialExtentRequired",null),a([c()],$.prototype,"labelManager",void 0),a([c({readOnly:!0})],$.prototype,"resourceManager",null),a([c({readOnly:!0})],$.prototype,"textureManager",null),a([c({readOnly:!0})],$.prototype,"mapViewNavigation",void 0),a([c({constructOnly:!0})],$.prototype,"renderCanvas",void 0),a([c()],$.prototype,"renderingOptions",void 0),a([c({readOnly:!0})],$.prototype,"rendering",void 0),a([c({constructOnly:!0})],$.prototype,"supersampleScreenshotsEnabled",void 0),a([c({readOnly:!0})],$.prototype,"supportsGround",void 0),a([c()],$.prototype,"_stationaryTimer",void 0),a([c()],$.prototype,"_defaultsFromMapSettings",null),a([c()],$.prototype,"_pePromise",void 0),a([c({readOnly:!0})],$.prototype,"typeSpecificPreconditionsReady",null),a([c()],$.prototype,"animation",null),a([c({type:jp})],$.prototype,"background",null),a([c({value:null,type:se,dependsOn:["state.id","ready"]})],$.prototype,"center",null),a([c({type:Na})],$.prototype,"constraints",null),a([c({value:null,type:oi,dependsOn:["state.id","ready"]})],$.prototype,"extent",null),a([c()],$.prototype,"floors",void 0),a([c({type:Ua})],$.prototype,"highlightOptions",void 0),a([c({readOnly:!0})],$.prototype,"inputManager",void 0),a([c()],$.prototype,"map",void 0),a([c({value:{top:0,right:0,bottom:0,left:0},cast:i=>({top:0,right:0,bottom:0,left:0,...i})})],$.prototype,"padding",null),a([c()],$.prototype,"resizeAlign",void 0),a([c({readOnly:!0,dependsOn:["state.id"]})],$.prototype,"resolution",null),a([c({value:0,type:Number,dependsOn:["state.id","ready"]})],$.prototype,"rotation",null),a([c({value:0,type:Number,dependsOn:["state.id","ready"]})],$.prototype,"scale",null),a([c({constructOnly:!0})],$.prototype,"spatialReferenceLocked",void 0),a([c()],$.prototype,"stationary",null),a([c({type:Ha,readOnly:!0})],$.prototype,"timeline",void 0),a([c({readOnly:!0})],$.prototype,"type",void 0),a([c({readOnly:!0})],$.prototype,"updating",null),a([c({value:null,type:Oe,dependsOn:["state.id","ready"]})],$.prototype,"viewpoint",null),a([c({value:-1,dependsOn:["state.id","ready"]})],$.prototype,"zoom",null),a([c({readOnly:!0})],$.prototype,"navigating",null),a([c({type:Xa})],$.prototype,"ui",void 0),$=a([I("esri.views.MapView")],$);const Zp=$;function Cn(i){var t,s;const e=i.getObjectId();return e?`${((t=i.layer)==null?void 0:t.uid)??((s=i.sourceLayer)==null?void 0:s.uid)??"MapView"}/${e}`:`"MapView/${i.uid}`}function wr(i,e,t,s,n){return o=>{if(o instanceof Lt){if(o.layer===i)n==null||n();else{const r=i.allLayerViews.find(l=>l.layer===o.layer);r&&(s==null||s(r))}t(Cn(o))}else{const r=i.allLayerViews.find(l=>l.layer===o);r&&e(r)}}}function br(i,e){if(i)if(no(i))for(const t of i)if(no(t))for(const s of t)e(s);else e(t);else e(i)}function Kp(i){return(i==null?void 0:i.declaredClass)==="esri.WebMap"}const nf=Object.freeze(Object.defineProperty({__proto__:null,default:Zp},Symbol.toStringTag,{value:"Module"}));export{au as $,La as G,nf as M,pt as P,bg as R,Ts as S,Ha as a,ii as b,wg as c,Ua as d,es as e,fu as f,Wg as m,Ra as n,yu as p,$u as r,Pu as t};
