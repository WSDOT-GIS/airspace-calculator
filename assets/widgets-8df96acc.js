import{e as a,y as i,a as k,v as P,t as M,C as S,a4 as L,bq as N,_ as x,br as O,bs as V}from"./index-c754ff65.js";import{e as T,W as D,a as $,n as h,t as R}from"./widget-7352089c.js";import{t as H}from"./accessibleHandler-b82b4bb4.js";import"./uuid-73213768.js";let g=class extends P{constructor(e){super(e),this._viewpointHandle=null,this._handles=new M,this.group=null}initialize(){this._handles.add(S(()=>{var e;return(e=this.view)==null?void 0:e.ui},"expand",e=>{const{target:t}=e;t&&t!==this&&t.expanded&&t.group&&t.group===this.group&&this._collapse()}))}destroy(){this._viewpointHandle=null,this.view=null,this._handles.destroy(),this._handles=null}set autoCollapse(e){this._set("autoCollapse",e),this._watchViewpoint()}set expanded(e){const t=!!e;this._set("expanded",t);const n=this.get("view.ui");n&&n.emit("expand",{target:this}),this._viewpointHandleChange(t)}get state(){return this.get("view.ready")?"ready":"disabled"}set view(e){this._get("view")!==e&&(this._set("view",e),e&&L(()=>e.ready,()=>{this.view===e&&this._watchViewpoint()},{once:!0,initial:!0}))}_viewpointHandleChange(e){this._viewpointHandle&&(e?L(()=>this.view.stationary,()=>this._viewpointHandle.resume(),{once:!0,initial:!0}):this._viewpointHandle.pause())}_watchViewpoint(){const e="viewpoint";this._handles.remove(e),this._viewpointHandle=null;const{autoCollapse:t,view:n}=this;if(n&&t){const o=N(()=>n.type==="3d"?n.camera:n.viewpoint,()=>this._collapse());this._handles.add(o,e),this._viewpointHandle=o}}_collapse(){this.expanded=!1}};a([i({value:!1})],g.prototype,"autoCollapse",null),a([i({value:!1})],g.prototype,"expanded",null),a([i()],g.prototype,"group",void 0),a([i({readOnly:!0})],g.prototype,"state",null),a([i({value:null})],g.prototype,"view",null),g=a([k("esri.widgets.Expand.ExpandViewModel")],g);const A=g,p="esri-expand",l={base:`${p} esri-widget`,modeAuto:`${p}--auto`,modeDrawer:`${p}--drawer`,modeFloating:`${p}--floating`,container:`${p}__container`,containerExpanded:`${p}__container--expanded`,panel:`${p}__panel`,button:"esri-widget--button",text:"esri-icon-font-fallback-text",icon:"esri-collapse__icon",iconExpanded:`${p}__icon--expanded`,iconNumber:`${p}__icon-number`,iconNumberExpanded:`${p}__icon-number--expanded`,expandIcon:"esri-icon-expand",collapseIcon:"esri-icon-collapse",content:`${p}__content`,contentExpanded:`${p}__content--expanded`,expandMask:`${p}__mask`,expandMaskExpanded:`${p}__mask--expanded`};let r=class extends D{constructor(e,t){super(e,t),this.closeOnEsc=!0,this.collapseTooltip="",this.content="",this.expandTooltip="",this.iconNumber=0,this.messages=null,this.messagesCommon=null,this.mode="auto",this.viewModel=new A,this._handleKeyDown=n=>{const{closeOnEsc:o,_toggleButtonEl:s,expanded:y}=this;!y||!o||n.target===s||n.key!=="Escape"||(typeof o=="function"?o(n):o)&&(this.expanded=!1,s==null||s.focus())}}get contentId(){return`${this.id}_controls_content`}get expandTitle(){const{expanded:e,messagesCommon:t,collapseTooltip:n,expandTooltip:o}=this;return e?n||t.collapse:o||t.expand}get autoCollapse(){return this.viewModel.autoCollapse}set autoCollapse(e){this.viewModel.autoCollapse=e}get collapseIconClass(){return l.collapseIcon}set collapseIconClass(e){this._overrideIfSome("collapseIconClass",e)}get expanded(){return this.viewModel.expanded}set expanded(e){this.viewModel.expanded=e}get expandIconClass(){return $(this.content)?this.content.iconClass:l.expandIcon}set expandIconClass(e){this._overrideIfSome("expandIconClass",e)}get group(){return this.viewModel.group}set group(e){this.viewModel.group=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}expand(){this.viewModel.expanded=!0}collapse(){this.viewModel.expanded=!1}toggle(){this.viewModel.expanded=!this.viewModel.expanded}render(){const{mode:e}=this,t={[l.modeAuto]:e==="auto",[l.modeDrawer]:e==="drawer",[l.modeFloating]:e==="floating"};return h("div",{class:this.classes(l.base,t),onkeydown:this._handleKeyDown},this.renderMask(),this.renderContainer())}renderContainer(){const{expanded:e}=this,t={[l.containerExpanded]:e};return h("div",{class:this.classes(l.container,t)},this.renderPanel(),this.renderContent())}renderMask(){const{expanded:e}=this,t={[l.expandMaskExpanded]:e};return h("div",{bind:this,onclick:this._toggle,class:this.classes(l.expandMask,t)})}renderBadgeNumber(){const{expanded:e,iconNumber:t}=this;return t&&!e?h("span",{key:"expand__icon-number",class:l.iconNumber},t):null}renderPanelNumber(){const{iconNumber:e,expanded:t}=this;return e&&t?h("span",{key:"expand__expand-icon-number",class:this.classes(l.iconNumber,l.iconNumberExpanded)},e):null}renderIcon(){const{collapseIconClass:e,expandIconClass:t,expanded:n}=this,o={[l.iconExpanded]:n,[e]:n,[t]:!n};return e===t&&(o[e]=!0),h("span",{"aria-hidden":"true",class:this.classes(l.icon,o)})}renderTitle(){return h("span",{class:l.text},this.expandTitle)}renderExpandButton(){const{expanded:e,expandTitle:t,contentId:n}=this;return h("div",{afterCreate:this._storeToggleButtonEl,"aria-controls":n,"aria-expanded":e?"true":"false",bind:this,class:l.button,onclick:this._toggle,onkeydown:this._toggle,role:"button",tabindex:"0",title:t},this.renderBadgeNumber(),this.renderIcon(),this.renderTitle())}renderPanel(){return h("div",{class:l.panel},this.renderExpandButton(),this.renderPanelNumber())}renderContent(){const{expanded:e,contentId:t,content:n}=this,o={[l.contentExpanded]:e},s={id:t,role:"region",class:this.classes(l.content,o)};return typeof n=="string"?h("div",{key:"content__string",innerHTML:n,...s}):$(n)?h("div",{key:"content__widget",...s},n.render()):n instanceof HTMLElement?h("div",{key:"content__html-element",bind:n,afterCreate:this._attachToNode,...s}):R(n)?h("div",{key:"content__node",bind:n.domNode,afterCreate:this._attachToNode,...s}):null}_toggle(){this.toggle()}_attachToNode(e){const t=this;e.appendChild(t)}_storeToggleButtonEl(e){this._toggleButtonEl=e}};a([i({readOnly:!0})],r.prototype,"contentId",null),a([i({readOnly:!0})],r.prototype,"expandTitle",null),a([i()],r.prototype,"autoCollapse",null),a([i()],r.prototype,"closeOnEsc",void 0),a([i()],r.prototype,"collapseIconClass",null),a([i()],r.prototype,"collapseTooltip",void 0),a([i()],r.prototype,"content",void 0),a([i()],r.prototype,"expanded",null),a([i()],r.prototype,"expandIconClass",null),a([i()],r.prototype,"expandTooltip",void 0),a([i()],r.prototype,"group",null),a([i()],r.prototype,"iconNumber",void 0),a([i()],r.prototype,"label",null),a([i(),T("esri/widgets/Expand/t9n/Expand")],r.prototype,"messages",void 0),a([i(),T("esri/t9n/common")],r.prototype,"messagesCommon",void 0),a([i()],r.prototype,"mode",void 0),a([i()],r.prototype,"view",null),a([i({type:A})],r.prototype,"viewModel",void 0),a([H()],r.prototype,"_toggle",null),r=a([k("esri.widgets.Expand")],r);const E=r,B="https://data.wsdot.wa.gov/arcgis/rest/services/AirportMapApplication/AirspaceCalculatorSurface/ImageServer";function W(e){if(!(e instanceof CustomEvent))return!1;const{detail:t}=e,n=["surfacePenetration","terrainInfo","xy"];for(const o of n)if(!Object.hasOwn(t,o))return!1;return!0}function G(e){return e instanceof CustomEvent&&e.detail instanceof Error}function F(e){const n=["Pick coordinates by clicking a location on the map","Clears graphics from the map created by this control"].map(s=>`button[title='${s}']`).join(",");let o=e.querySelectorAll(n);o.forEach(s=>{s.remove()}),o=e.querySelectorAll("button"),o.forEach(s=>{s.classList.add("esri-button"),s.type==="submit"?s.classList.add("esri-widget-button","esri-button--primary"):s.classList.add("esri-widget-button","esri-button--secondary")}),e.querySelectorAll("input,label").forEach(s=>{const y=`esri-${s.tagName.toLowerCase()}`;s.classList.add(y)})}async function j(e,t){const{default:n}=await x(()=>import("./ImageryLayer-d591b4f6.js"),["assets/ImageryLayer-d591b4f6.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/fetchRasterInfo-4a795922.js","assets/multidimensionalUtils-8b85fc0a.js","assets/dataUtils-911b749e.js","assets/pixelRangeUtils-03719dd8.js","assets/RasterSymbolizer-f2093dbe.js","assets/colorUtils-c0f43caf.js","assets/normalizeUtils-703059af.js","assets/normalizeUtilsCommon-258cba9f.js","assets/utils-3b5f5c5a.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/utils-bd924f31.js","assets/generateRendererUtils-d368e258.js","assets/imageBitmapUtils-d10149ad.js","assets/executeQueryJSON-ca6c73e1.js","assets/query-d95b3dd5.js","assets/pbfQueryUtils-06c77b54.js","assets/pbf-f46def03.js","assets/OptimizedGeometry-9aa8664b.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/featureConversionUtils-c00360ef.js","assets/aaBoundingRect-5c57438c.js","assets/AttachmentInfo-2f7fbe5e.js","assets/executeForIds-d6107ba0.js"]),o=new n(t);e.layers.add(o)}async function q(e,t=B){const n=x(()=>import("./index-a0f399b4.js"),["assets/index-a0f399b4.js","assets/index-c754ff65.js","assets/index-252dcfb5.css"]).then(({default:d})=>d),o=x(()=>import("./index-c754ff65.js").then(d=>d.jH),["assets/index-c754ff65.js","assets/index-252dcfb5.css"]).then(({xyToLngLat:d})=>d);j(e.map,{url:t,title:"Airspace Calculator Surface",visible:!1});const[s,y]=await Promise.all([n,o]),f=new s(t),{form:_}=f;F(_);function b(d){console.debug("map clicked",{event:d});const{mapPoint:c}=d;let{x:u,y:m}=c;[u,m]=y(u,m),_.x.value=`${u}`,_.y.value=`${m}`,v.expanded||v.expand()}_.classList.add("esri-widget"),_.addEventListener("calculation-error",function(d){const c=G(d),u=c?d.detail.message:JSON.stringify(d);console.error(c?u:"calculation error",d),alert(u)});function C(d){const u=e.layerViews.find(w=>w.layer.title===O).layer;if(!W(d)){const w=`Was expecting event to be a ${CustomEvent.name}`;console.error(w),alert(`An unexpected error was encountered: ${w}`);return}const{detail:m}=d,I=m.surfacePenetration.toString();console.log(I,m),V(u,m)}_.addEventListener("calculation-complete",C),e.on("click",b);const v=new E({content:f.form,expanded:!0});return v}function z(e){x(()=>import("./Legend-92980614.js"),["assets/Legend-92980614.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/EffectView-a1fb6514.js","assets/ExportImageParameters-07dc0717.js","assets/floorFilterUtils-080a7cd2.js","assets/sublayerUtils-08cbbcae.js","assets/pixelRangeUtils-03719dd8.js","assets/utils-7a1e2b28.js","assets/ItemCache-096925bc.js","assets/utils-bd924f31.js","assets/symbolUtils-5e5f8d3d.js","assets/colorUtils-c0f43caf.js","assets/mat2d-e11be45e.js","assets/webStyleSymbolUtils-5cb46bea.js","assets/devEnvironmentUtils-5002a058.js","assets/Heading-adb0ad8a.js","assets/accessibleHandler-b82b4bb4.js"]).then(({default:t})=>{const n=new t({view:e}),o=new E({content:n});e.ui.add(o,"bottom-leading")})}function K(){const e=document.createElement("h1");return e.textContent="🚧 Work-in-progress 🚧: WSDOT Airspace Calculator",e.classList.add("esri-widget","esri-header"),e}async function Q(e){z(e),e.ui.add(K(),{index:0,position:"top-leading"});async function t(){const{default:o}=await x(()=>import("./Search-49c35f03.js"),["assets/Search-49c35f03.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/layerViewUtils-5da1782e.js","assets/scaleUtils-33b708da.js","assets/utils-3b5f5c5a.js","assets/commonProperties-da958896.js","assets/project-f9f3947a.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js"]);return new o({view:e,includeDefaultSources:!1,sources:[{url:"https://utility.arcgis.com/usrsvcs/servers/a86fa8aeabdd470792022a8ef959afb6/rest/services/World/GeocodeServer",name:"ArcGIS World Geocode Service",locationType:"street",countryCode:"US",suggestionsEnabled:!0,popupEnabled:!0,autoNavigate:!0,resultGraphicEnabled:!0,placeholder:"Find address or place",singleLineFieldName:"SingleLine"}]})}async function n(){const o=t(),s="top-trailing",y=x(()=>import("./BasemapGallery-433f6420.js"),["assets/BasemapGallery-433f6420.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/Basemap-11f6c81d.js","assets/loadAll-026b7227.js","assets/writeUtils-a7e8e976.js","assets/basemapUtils-abd7da37.js","assets/ViewingMode-915d19cb.js","assets/Util-f53b4bf3.js","assets/vec2f64-22afc56f.js","assets/Scheduler-68df8c73.js","assets/aaBoundingRect-5c57438c.js","assets/TileInfo-2589d4ff.js","assets/TileKey-b87e0dc5.js","assets/Heading-adb0ad8a.js","assets/accessibleHandler-b82b4bb4.js"]).then(({default:c})=>{const u=new c({view:e,activeBasemap:e.map.basemap});return new E({content:u,view:e,group:s})}),f=x(()=>import("./LayerList-0928070b.js"),["assets/LayerList-0928070b.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js"]).then(({default:c})=>{const u=new c({view:e,selectionEnabled:!0,multipleSelectionEnabled:!0,visibleElements:{errors:!0,statusIndicators:!0},listItemCreatedFunction:function(I){const w=I.item;w.panel={content:["legend"]}}});return new E({content:u,group:s})}),_=x(()=>import("./Home-877e80b7.js"),["assets/Home-877e80b7.js","assets/index-c754ff65.js","assets/index-252dcfb5.css","assets/widget-7352089c.js","assets/uuid-73213768.js","assets/Viewpoint-eb6ec031.js","assets/Cyclical-5c5da130.js","assets/GoTo-9b5cecfc.js","assets/accessibleHandler-b82b4bb4.js","assets/vmEvent-d773b6c5.js"]).then(({default:c})=>new c({view:e})),b=[o,_,y,f,q(e)],C=await Promise.allSettled(b),v=new Array,d=new Array;for(const c of C)c.status==="rejected"?(console.error("promise failed",c.reason),d.push(c)):v.push(c.value);e.ui.add(v,s)}n()}export{Q as setupWidgets};
